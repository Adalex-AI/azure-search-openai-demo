diff --git a/app/backend/app.py b/app/backend/app.py
index 1b4563b..0577642 100644
--- a/app/backend/app.py
+++ b/app/backend/app.py
@@ -135,45 +135,88 @@ async def assets(path):
 @authenticated_path
 async def content_file(path: str, auth_claims: dict[str, Any]):
     """
-    Serve content files from blob storage from within the app to keep the example self-contained.
-    *** NOTE *** if you are using app services authentication, this route will return unauthorized to all users that are not logged in
-    if AZURE_ENFORCE_ACCESS_CONTROL is not set or false, logged in users can access all files regardless of access control
-    if AZURE_ENFORCE_ACCESS_CONTROL is set to true, logged in users can only access files they have access to
-    This is also slow and memory hungry.
+    Redirect to storageUrl for content files instead of serving from blob container.
+    This ensures all file access goes through the proper storageUrl mechanism.
+    Now supports highlighting via query parameter.
     """
-    # Remove page number from path, filename-1.txt -> filename.txt
-    # This shouldn't typically be necessary as browsers don't send hash fragments to servers
+    from quart import redirect, request as quart_request
+    
+    # Get highlight search terms from query parameter
+    highlight_terms = quart_request.args.get('highlight', '')
+    
+    # Remove page number from path if present
     if path.find("#page=") > 0:
         path_parts = path.rsplit("#page=", 1)
         path = path_parts[0]
-    current_app.logger.info("Opening file %s", path)
-    blob_container_client: ContainerClient = current_app.config[CONFIG_BLOB_CONTAINER_CLIENT]
-    blob: Union[BlobDownloader, DatalakeDownloader]
+    
+    # Handle citation format "sourcepage, sourcefile" by extracting sourcepage
+    if ", " in path:
+        path = path.split(", ")[0]
+
+    # If the path is already a URL, redirect to it with highlight parameter
+    if path.startswith("http://") or path.startswith("https://"):
+        if highlight_terms:
+            # Add highlight parameter to external URL
+            separator = "&" if "?" in path else "?"
+            return redirect(f"{path}{separator}search={highlight_terms}")
+        return redirect(path)
+
+    # Search for the document in the index to get its storageUrl
+    search_client: SearchClient = current_app.config[CONFIG_SEARCH_CLIENT]
     try:
-        blob = await blob_container_client.get_blob_client(path).download_blob()
-    except ResourceNotFoundError:
-        current_app.logger.info("Path not found in general Blob container: %s", path)
-        if current_app.config[CONFIG_USER_UPLOAD_ENABLED]:
-            try:
-                user_oid = auth_claims["oid"]
-                user_blob_container_client = current_app.config[CONFIG_USER_BLOB_CONTAINER_CLIENT]
-                user_directory_client: FileSystemClient = user_blob_container_client.get_directory_client(user_oid)
-                file_client = user_directory_client.get_file_client(path)
-                blob = await file_client.download_file()
-            except ResourceNotFoundError:
-                current_app.logger.exception("Path not found in DataLake: %s", path)
-                abort(404)
-        else:
-            abort(404)
-    if not blob.properties or not blob.properties.has_key("content_settings"):
-        abort(404)
-    mime_type = blob.properties["content_settings"]["content_type"]
-    if mime_type == "application/octet-stream":
-        mime_type = mimetypes.guess_type(path)[0] or "application/octet-stream"
-    blob_file = io.BytesIO()
-    await blob.readinto(blob_file)
-    blob_file.seek(0)
-    return await send_file(blob_file, mimetype=mime_type, as_attachment=False, attachment_filename=path)
+        # Search for document by sourcepage or sourcefile with proper escaping
+        escaped_path = path.replace("'", "''")
+        filter_query = f"sourcepage eq '{escaped_path}' or sourcefile eq '{escaped_path}'"
+        
+        results = await search_client.search(
+            search_text="", 
+            filter=filter_query, 
+            select=["storageUrl"], 
+            top=1
+        )
+        
+        async for document in results:
+            storage_url = document.get("storageUrl")
+            if storage_url and str(storage_url).strip():
+                current_app.logger.info("Found storageUrl for path %s: %s", path, storage_url)
+                
+                # Add highlight parameter to storage URL if provided
+                if highlight_terms:
+                    separator = "&" if "?" in str(storage_url) else "?"
+                    storage_url_with_highlight = f"{storage_url}{separator}search={highlight_terms}"
+                    return redirect(storage_url_with_highlight)
+                
+                return redirect(str(storage_url))
+            break
+            
+        # If no results found, try a broader text search
+        current_app.logger.info("No exact match found for %s, trying text search", path)
+        results = await search_client.search(
+            search_text=path,
+            select=["storageUrl", "sourcepage", "sourcefile"],
+            top=5
+        )
+        
+        async for document in results:
+            storage_url = document.get("storageUrl")
+            if storage_url and str(storage_url).strip():
+                current_app.logger.info("Found storageUrl via text search for path %s: %s", path, storage_url)
+                
+                # Add highlight parameter to storage URL if provided
+                if highlight_terms:
+                    separator = "&" if "?" in str(storage_url) else "?"
+                    storage_url_with_highlight = f"{storage_url}{separator}search={highlight_terms}"
+                    return redirect(storage_url_with_highlight)
+                
+                return redirect(str(storage_url))
+            break
+            
+    except Exception as e:
+        current_app.logger.exception("Error searching for document storageUrl: %s", e)
+    
+    # If no storageUrl found, return 404
+    current_app.logger.warning("No storageUrl found for path: %s", path)
+    abort(404)
 
 
 @bp.route("/ask", methods=["POST"])
@@ -182,8 +225,18 @@ async def ask(auth_claims: dict[str, Any]):
     if not request.is_json:
         return jsonify({"error": "request must be json"}), 415
     request_json = await request.get_json()
+    
+    # Enhanced logging to trace the data flow
+    current_app.logger.info("Ask endpoint received request")
+    current_app.logger.info(f"Question: {request_json.get('messages', [{}])[-1].get('content', 'No question')}")
+    
     context = request_json.get("context", {})
     context["auth_claims"] = auth_claims
+    
+    # Log overrides to understand what's being requested
+    overrides = context.get("overrides", {})
+    current_app.logger.info(f"Overrides: top={overrides.get('top')}, semantic_captions={overrides.get('semantic_captions')}")
+    
     try:
         use_gpt4v = context.get("overrides", {}).get("use_gpt4v", False)
         approach: Approach
@@ -191,18 +244,46 @@ async def ask(auth_claims: dict[str, Any]):
             approach = cast(Approach, current_app.config[CONFIG_ASK_VISION_APPROACH])
         else:
             approach = cast(Approach, current_app.config[CONFIG_ASK_APPROACH])
+        
+        current_app.logger.info("Using approach: %s", type(approach).__name__)
+        
         r = await approach.run(
             request_json["messages"], context=context, session_state=request_json.get("session_state")
         )
+        
+        # Enhanced logging to trace response structure
+        if isinstance(r, dict) and "context" in r:
+            context_data = r["context"]
+            if hasattr(context_data, "data_points") and context_data.data_points:
+                data_points = context_data.data_points
+                if hasattr(data_points, "text") and data_points.text:
+                    current_app.logger.info(f"Response has {len(data_points.text)} text data points")
+                    for i, dp in enumerate(data_points.text[:2]):  # Log first 2
+                        if isinstance(dp, dict):
+                            content_length = len(dp.get("content", ""))
+                            current_app.logger.info(f"Data point {i}: content_length={content_length}")
+                            if content_length < 100:
+                                current_app.logger.warning(f"Data point {i} has short content: {dp.get('content', '')}")
+        
         return jsonify(r)
     except Exception as error:
+        current_app.logger.exception("Error in ask endpoint: %s", error)
         return error_response(error, "/ask")
 
 
 class JSONEncoder(json.JSONEncoder):
     def default(self, o):
         if dataclasses.is_dataclass(o) and not isinstance(o, type):
-            return dataclasses.asdict(o)
+            # Convert dataclass to dict
+            result = dataclasses.asdict(o)
+            
+            # Special handling for ExtraInfo to ensure all fields are included
+            if hasattr(o, 'enhanced_citations'):
+                result['enhanced_citations'] = getattr(o, 'enhanced_citations', [])
+            if hasattr(o, 'citation_map'):
+                result['citation_map'] = getattr(o, 'citation_map', {})
+                
+            return result
         return super().default(o)
 
 
@@ -221,8 +302,12 @@ async def chat(auth_claims: dict[str, Any]):
     if not request.is_json:
         return jsonify({"error": "request must be json"}), 415
     request_json = await request.get_json()
+    current_app.logger.info("Chat endpoint received request: %s", request_json)
+    
     context = request_json.get("context", {})
     context["auth_claims"] = auth_claims
+    current_app.logger.info("Chat endpoint context: %s", context)
+    
     try:
         use_gpt4v = context.get("overrides", {}).get("use_gpt4v", False)
         approach: Approach
@@ -231,6 +316,8 @@ async def chat(auth_claims: dict[str, Any]):
         else:
             approach = cast(Approach, current_app.config[CONFIG_CHAT_APPROACH])
 
+        current_app.logger.info("Chat endpoint using approach: %s", type(approach).__name__)
+
         # If session state is provided, persists the session state,
         # else creates a new session_id depending on the chat history options enabled.
         session_state = request_json.get("session_state")
@@ -244,8 +331,39 @@ async def chat(auth_claims: dict[str, Any]):
             context=context,
             session_state=session_state,
         )
+        
+        current_app.logger.info("Chat endpoint response structure:")
+        current_app.logger.info("- Response type: %s", type(result))
+        current_app.logger.info("- Response keys: %s", list(result.keys()) if hasattr(result, 'keys') else 'No keys')
+        
+        if hasattr(result, 'get') and result.get('context'):
+            context_data = result.get('context')
+            current_app.logger.info("- Context structure: %s", type(context_data))
+            current_app.logger.info("- Context keys: %s", list(context_data.keys()) if hasattr(context_data, 'keys') else 'No keys')
+            
+            if hasattr(context_data, 'get') and context_data.get('data_points'):
+                data_points = context_data.get('data_points')
+                current_app.logger.info("- Data points type: %s", type(data_points))
+                current_app.logger.info("- Data points is array: %s", isinstance(data_points, list))
+                if isinstance(data_points, list):
+                    current_app.logger.info("- Data points length: %s", len(data_points))
+                    for i, dp in enumerate(data_points[:3]):  # Log first 3 items
+                        current_app.logger.info("- Data point %d: %s", i, dp)
+                        if hasattr(dp, 'get'):
+                            current_app.logger.info("  - Has sourcepage: %s", dp.get('sourcepage'))
+                            current_app.logger.info("  - Has sourcefile: %s", dp.get('sourcefile'))
+                            current_app.logger.info("  - Has storageUrl: %s", dp.get('storageUrl'))
+                else:
+                    current_app.logger.warning("- Data points is not a list: %s", data_points)
+            else:
+                current_app.logger.warning("- No data_points found in context")
+        else:
+            current_app.logger.warning("- No context found in response")
+        
+        current_app.logger.info("Chat endpoint returning response")
         return jsonify(result)
     except Exception as error:
+        current_app.logger.exception("Error in chat endpoint: %s", error)
         return error_response(error, "/chat")
 
 
@@ -255,8 +373,12 @@ async def chat_stream(auth_claims: dict[str, Any]):
     if not request.is_json:
         return jsonify({"error": "request must be json"}), 415
     request_json = await request.get_json()
+    current_app.logger.info("Chat stream endpoint received request: %s", request_json)
+    
     context = request_json.get("context", {})
     context["auth_claims"] = auth_claims
+    current_app.logger.info("Chat stream endpoint context: %s", context)
+    
     try:
         use_gpt4v = context.get("overrides", {}).get("use_gpt4v", False)
         approach: Approach
@@ -265,6 +387,8 @@ async def chat_stream(auth_claims: dict[str, Any]):
         else:
             approach = cast(Approach, current_app.config[CONFIG_CHAT_APPROACH])
 
+        current_app.logger.info("Chat stream endpoint using approach: %s", type(approach).__name__)
+
         # If session state is provided, persists the session state,
         # else creates a new session_id depending on the chat history options enabled.
         session_state = request_json.get("session_state")
@@ -278,11 +402,15 @@ async def chat_stream(auth_claims: dict[str, Any]):
             context=context,
             session_state=session_state,
         )
+        
+        current_app.logger.info("Chat stream endpoint created result generator")
+        
         response = await make_response(format_as_ndjson(result))
         response.timeout = None  # type: ignore
         response.mimetype = "application/json-lines"
         return response
     except Exception as error:
+        current_app.logger.exception("Error in chat stream endpoint: %s", error)
         return error_response(error, "/chat")
 
 
@@ -312,6 +440,7 @@ def config():
             "showChatHistoryBrowser": current_app.config[CONFIG_CHAT_HISTORY_BROWSER_ENABLED],
             "showChatHistoryCosmos": current_app.config[CONFIG_CHAT_HISTORY_COSMOS_ENABLED],
             "showAgenticRetrievalOption": current_app.config[CONFIG_AGENTIC_RETRIEVAL_ENABLED],
+            "useStorageUrlForCitations": True,  # Enable storageUrl usage for citations
         }
     )
 
@@ -436,8 +565,8 @@ async def setup_clients():
     OPENAI_CHATGPT_MODEL = os.environ["AZURE_OPENAI_CHATGPT_MODEL"]
     AZURE_OPENAI_SEARCHAGENT_MODEL = os.getenv("AZURE_OPENAI_SEARCHAGENT_MODEL")
     AZURE_OPENAI_SEARCHAGENT_DEPLOYMENT = os.getenv("AZURE_OPENAI_SEARCHAGENT_DEPLOYMENT")
-    OPENAI_EMB_MODEL = os.getenv("AZURE_OPENAI_EMB_MODEL_NAME", "text-embedding-ada-002")
-    OPENAI_EMB_DIMENSIONS = int(os.getenv("AZURE_OPENAI_EMB_DIMENSIONS") or 1536)
+    OPENAI_EMB_MODEL = os.getenv("AZURE_OPENAI_EMB_MODEL_NAME", "text-embedding-3-large")  # Updated default model
+    OPENAI_EMB_DIMENSIONS = int(os.getenv("AZURE_OPENAI_EMB_DIMENSIONS") or 3072)  # Updated default dimensions
     OPENAI_REASONING_EFFORT = os.getenv("AZURE_OPENAI_REASONING_EFFORT")
     # Used with Azure OpenAI deployments
     AZURE_OPENAI_SERVICE = os.getenv("AZURE_OPENAI_SERVICE")
@@ -834,3 +963,12 @@ def create_app():
             cors(app, allow_origin=allowed_origins, allow_methods=["GET", "POST"])
 
     return app
+    logging.getLogger("scripts").setLevel(app_level)
+
+    if allowed_origin := os.getenv("ALLOWED_ORIGIN"):
+        allowed_origins = allowed_origin.split(";")
+        if len(allowed_origins) > 0:
+            app.logger.info("CORS enabled for %s", allowed_origins)
+            cors(app, allow_origin=allowed_origins, allow_methods=["GET", "POST"])
+
+    return app
diff --git a/app/backend/approaches/approach.py b/app/backend/approaches/approach.py
index 7172210..88b7994 100644
--- a/app/backend/approaches/approach.py
+++ b/app/backend/approaches/approach.py
@@ -4,6 +4,7 @@ from collections.abc import AsyncGenerator, Awaitable
 from dataclasses import dataclass
 from typing import Any, Callable, Optional, TypedDict, Union, cast
 from urllib.parse import urljoin
+import re
 
 import aiohttp
 from azure.search.documents.agent.aio import KnowledgeAgentRetrievalClient
@@ -36,6 +37,18 @@ from openai.types.chat import (
 from approaches.promptmanager import PromptManager
 from core.authentication import AuthenticationHelper
 
+from dataclasses import dataclass
+from typing import Optional, Any
+
+@dataclass
+class Citation:
+    content: str
+    id: str
+    title: str
+    filepath: str
+    url: Optional[str] = None
+    metadata: Optional[dict[str, Any]] = None
+
 
 @dataclass
 class Document:
@@ -44,37 +57,41 @@ class Document:
     category: Optional[str] = None
     sourcepage: Optional[str] = None
     sourcefile: Optional[str] = None
+    storage_url: Optional[str] = None
     oids: Optional[list[str]] = None
     groups: Optional[list[str]] = None
     captions: Optional[list[QueryCaptionResult]] = None
     score: Optional[float] = None
     reranker_score: Optional[float] = None
     search_agent_query: Optional[str] = None
+    updated: Optional[str] = None  # Add updated field
 
     def serialize_for_results(self) -> dict[str, Any]:
         result_dict = {
-            "id": self.id,
-            "content": self.content,
-            "category": self.category,
-            "sourcepage": self.sourcepage,
-            "sourcefile": self.sourcefile,
-            "oids": self.oids,
-            "groups": self.groups,
+            "id": str(self.id) if self.id is not None else "",
+            "content": str(self.content) if self.content is not None else "",
+            "category": str(self.category) if self.category is not None else "",
+            "sourcepage": str(self.sourcepage) if self.sourcepage is not None else "",
+            "sourcefile": str(self.sourcefile) if self.sourcefile is not None else "",
+            "storageUrl": str(self.storage_url) if self.storage_url is not None else "",
+            "oids": self.oids if self.oids is not None else [],
+            "groups": self.groups if self.groups is not None else [],
             "captions": (
                 [
                     {
-                        "additional_properties": caption.additional_properties,
-                        "text": caption.text,
-                        "highlights": caption.highlights,
+                        "additional_properties": caption.additional_properties if caption.additional_properties is not None else {},
+                        "text": str(caption.text) if caption.text is not None else "",
+                        "highlights": str(caption.highlights) if caption.highlights is not None else "",
                     }
                     for caption in self.captions
                 ]
                 if self.captions
                 else []
             ),
-            "score": self.score,
-            "reranker_score": self.reranker_score,
-            "search_agent_query": self.search_agent_query,
+            "score": float(self.score) if self.score is not None else 0.0,
+            "reranker_score": float(self.reranker_score) if self.reranker_score is not None else 0.0,
+            "search_agent_query": str(self.search_agent_query) if self.search_agent_query is not None else "",
+            "updated": str(self.updated) if self.updated is not None else "",  # Include updated field
         }
         return result_dict
 
@@ -101,6 +118,8 @@ class ExtraInfo:
     data_points: DataPoints
     thoughts: Optional[list[ThoughtStep]] = None
     followup_questions: Optional[list[Any]] = None
+    enhanced_citations: Optional[list[str]] = None  # Add enhanced citations
+    citation_map: Optional[dict[str, str]] = None   # Add citation mapping
 
 
 @dataclass
@@ -206,56 +225,77 @@ class Approach(ABC):
     ) -> list[Document]:
         search_text = query_text if use_text_search else ""
         search_vectors = vectors if use_vector_search else []
+        
+        # Explicitly request all fields including full content without truncation
+        # Azure Cognitive Search should return full field values when explicitly selected
+        select_fields = ["id", "content", "category", "sourcepage", "sourcefile", "storageUrl", "oids", "groups", "updated"]
+        
+        # Add search_mode to ensure we get comprehensive results
+        search_kwargs = {
+            "search_text": search_text,
+            "filter": filter,
+            "top": top * 3,  # Request more results initially to account for filtering
+            "select": select_fields,
+            "search_mode": "all",  # Use "all" mode for more comprehensive matching
+            "include_total_count": True,  # Include total count for debugging
+        }
+        
         if use_semantic_ranker:
-            results = await self.search_client.search(
-                search_text=search_text,
-                filter=filter,
-                top=top,
-                query_caption="extractive|highlight-false" if use_semantic_captions else None,
-                query_rewrites="generative" if use_query_rewriting else None,
-                vector_queries=search_vectors,
-                query_type=QueryType.SEMANTIC,
-                query_language=self.query_language,
-                query_speller=self.query_speller,
-                semantic_configuration_name="default",
-                semantic_query=query_text,
-            )
+            search_kwargs.update({
+                "query_caption": "extractive|highlight-false" if use_semantic_captions else None,
+                "query_rewrites": "generative" if use_query_rewriting else None,
+                "vector_queries": search_vectors,
+                "query_type": QueryType.SEMANTIC,
+                "query_language": self.query_language,
+                "query_speller": self.query_speller,
+                "semantic_configuration_name": "default",
+                "semantic_query": query_text,
+            })
         else:
-            results = await self.search_client.search(
-                search_text=search_text,
-                filter=filter,
-                top=top,
-                vector_queries=search_vectors,
-            )
+            search_kwargs["vector_queries"] = search_vectors
+            
+        results = await self.search_client.search(**search_kwargs)
 
         documents = []
         async for page in results.by_page():
             async for document in page:
+                # Get the full content from the document
+                full_content = document.get("content", "")
+                
+                # Log if content appears truncated
+                if full_content and len(full_content) < 100 and full_content.endswith("..."):
+                    import logging
+                    logging.warning(f"Potentially truncated content for document {document.get('id')}: {full_content}")
+                
                 documents.append(
                     Document(
                         id=document.get("id"),
-                        content=document.get("content"),
+                        content=full_content,  # Use the full content
                         category=document.get("category"),
                         sourcepage=document.get("sourcepage"),
                         sourcefile=document.get("sourcefile"),
+                        storage_url=document.get("storageUrl"),
                         oids=document.get("oids"),
                         groups=document.get("groups"),
                         captions=cast(list[QueryCaptionResult], document.get("@search.captions")),
                         score=document.get("@search.score"),
                         reranker_score=document.get("@search.reranker_score"),
+                        updated=document.get("updated"),
                     )
                 )
 
-            qualified_documents = [
-                doc
-                for doc in documents
-                if (
-                    (doc.score or 0) >= (minimum_search_score or 0)
-                    and (doc.reranker_score or 0) >= (minimum_reranker_score or 0)
-                )
-            ]
-
-        return qualified_documents
+        # Apply filtering and return only requested number of results
+        qualified_documents = [
+            doc
+            for doc in documents
+            if (
+                (doc.score or 0) >= (minimum_search_score or 0)
+                and (doc.reranker_score or 0) >= (minimum_reranker_score or 0)
+            )
+        ]
+        
+        # Return only the top N results as requested
+        return qualified_documents[:top]
 
     async def run_agentic_retrieval(
         self,
@@ -328,171 +368,114 @@ class Approach(ABC):
     def get_sources_content(
         self, results: list[Document], use_semantic_captions: bool, use_image_citation: bool
     ) -> list[str]:
-
-        def nonewlines(s: str) -> str:
-            return s.replace("\n", " ").replace("\r", " ")
-
-        if use_semantic_captions:
-            return [
-                (self.get_citation((doc.sourcepage or ""), use_image_citation))
-                + ": "
-                + nonewlines(" . ".join([cast(str, c.text) for c in (doc.captions or [])]))
-                for doc in results
-            ]
-        else:
-            return [
-                (self.get_citation((doc.sourcepage or ""), use_image_citation)) + ": " + nonewlines(doc.content or "")
-                for doc in results
-            ]
-
-    def get_citation(self, sourcepage: str, use_image_citation: bool) -> str:
-        if use_image_citation:
-            return sourcepage
-        else:
-            path, ext = os.path.splitext(sourcepage)
-            if ext.lower() == ".png":
-                page_idx = path.rfind("-")
-                page_number = int(path[page_idx + 1 :])
-                return f"{path[:page_idx]}.pdf#page={page_number}"
-
-            return sourcepage
-
-    async def compute_text_embedding(self, q: str):
-        SUPPORTED_DIMENSIONS_MODEL = {
-            "text-embedding-ada-002": False,
-            "text-embedding-3-small": True,
-            "text-embedding-3-large": True,
-        }
-
-        class ExtraArgs(TypedDict, total=False):
-            dimensions: int
-
-        dimensions_args: ExtraArgs = (
-            {"dimensions": self.embedding_dimensions} if SUPPORTED_DIMENSIONS_MODEL[self.embedding_model] else {}
-        )
-        embedding = await self.openai_client.embeddings.create(
-            # Azure OpenAI takes the deployment name as the model name
-            model=self.embedding_deployment if self.embedding_deployment else self.embedding_model,
-            input=q,
-            **dimensions_args,
-        )
-        query_vector = embedding.data[0].embedding
-        # This performs an oversampling due to how the search index was setup,
-        # so we do not need to explicitly pass in an oversampling parameter here
-        return VectorizedQuery(vector=query_vector, k_nearest_neighbors=50, fields=self.embedding_field)
-
-    async def compute_image_embedding(self, q: str):
-        endpoint = urljoin(self.vision_endpoint, "computervision/retrieval:vectorizeText")
-        headers = {"Content-Type": "application/json"}
-        params = {"api-version": "2024-02-01", "model-version": "2023-04-15"}
-        data = {"text": q}
-
-        headers["Authorization"] = "Bearer " + await self.vision_token_provider()
-
-        async with aiohttp.ClientSession() as session:
-            async with session.post(
-                url=endpoint, params=params, headers=headers, json=data, raise_for_status=True
-            ) as response:
-                json = await response.json()
-                image_query_vector = json["vector"]
-        return VectorizedQuery(vector=image_query_vector, k_nearest_neighbors=50, fields="imageEmbedding")
-
-    def get_system_prompt_variables(self, override_prompt: Optional[str]) -> dict[str, str]:
-        # Allows client to replace the entire prompt, or to inject into the existing prompt using >>>
-        if override_prompt is None:
-            return {}
-        elif override_prompt.startswith(">>>"):
-            return {"injected_prompt": override_prompt[3:]}
-        else:
-            return {"override_prompt": override_prompt}
-
-    def get_response_token_limit(self, model: str, default_limit: int) -> int:
-        if model in self.GPT_REASONING_MODELS:
-            return self.RESPONSE_REASONING_DEFAULT_TOKEN_LIMIT
-
-        return default_limit
-
-    def create_chat_completion(
-        self,
-        chatgpt_deployment: Optional[str],
-        chatgpt_model: str,
-        messages: list[ChatCompletionMessageParam],
-        overrides: dict[str, Any],
-        response_token_limit: int,
-        should_stream: bool = False,
-        tools: Optional[list[ChatCompletionToolParam]] = None,
-        temperature: Optional[float] = None,
-        n: Optional[int] = None,
-        reasoning_effort: Optional[ChatCompletionReasoningEffort] = None,
-    ) -> Union[Awaitable[ChatCompletion], Awaitable[AsyncStream[ChatCompletionChunk]]]:
-        if chatgpt_model in self.GPT_REASONING_MODELS:
-            params: dict[str, Any] = {
-                # max_tokens is not supported
-                "max_completion_tokens": response_token_limit
-            }
-
-            # Adjust parameters for reasoning models
-            supported_features = self.GPT_REASONING_MODELS[chatgpt_model]
-            if supported_features.streaming and should_stream:
-                params["stream"] = True
-                params["stream_options"] = {"include_usage": True}
-            params["reasoning_effort"] = reasoning_effort or overrides.get("reasoning_effort") or self.reasoning_effort
-
-        else:
-            # Include parameters that may not be supported for reasoning models
-            params = {
-                "max_tokens": response_token_limit,
-                "temperature": temperature or overrides.get("temperature", 0.3),
-            }
-        if should_stream:
-            params["stream"] = True
-            params["stream_options"] = {"include_usage": True}
-
-        params["tools"] = tools
-
-        # Azure OpenAI takes the deployment name as the model name
-        return self.openai_client.chat.completions.create(
-            model=chatgpt_deployment if chatgpt_deployment else chatgpt_model,
-            messages=messages,
-            seed=overrides.get("seed", None),
-            n=n or 1,
-            **params,
-        )
-
-    def format_thought_step_for_chatcompletion(
-        self,
-        title: str,
-        messages: list[ChatCompletionMessageParam],
-        overrides: dict[str, Any],
-        model: str,
-        deployment: Optional[str],
-        usage: Optional[CompletionUsage] = None,
-        reasoning_effort: Optional[ChatCompletionReasoningEffort] = None,
-    ) -> ThoughtStep:
-        properties: dict[str, Any] = {"model": model}
-        if deployment:
-            properties["deployment"] = deployment
-        # Only add reasoning_effort setting if the model supports it
-        if model in self.GPT_REASONING_MODELS:
-            properties["reasoning_effort"] = reasoning_effort or overrides.get(
-                "reasoning_effort", self.reasoning_effort
-            )
-        if usage:
-            properties["token_usage"] = TokenUsageProps.from_completion_usage(usage)
-        return ThoughtStep(title, messages, properties)
-
-    async def run(
-        self,
-        messages: list[ChatCompletionMessageParam],
-        session_state: Any = None,
-        context: dict[str, Any] = {},
-    ) -> dict[str, Any]:
-        raise NotImplementedError
-
-    async def run_stream(
-        self,
-        messages: list[ChatCompletionMessageParam],
-        session_state: Any = None,
-        context: dict[str, Any] = {},
-    ) -> AsyncGenerator[dict[str, Any], None]:
-        raise NotImplementedError
+        """Return formatted strings with enhanced subsection support for three-part citation format"""
+
+        import logging
+        logging.info(f"ðŸ” DEBUG: Processing {len(results)} documents for sources content")
+        
+        formatted_results = []
+        
+        # First pass: process each document and collect subsections
+        document_groups = []  # List of (original_doc, [subsections]) tuples
+        
+        for i, doc in enumerate(results):
+            logging.info(f"ðŸ” DEBUG: Processing document {i+1}/{len(results)}: {doc.id}")
+            
+            # Check if document contains multiple subsections
+            subsections = self._extract_multiple_subsections_from_document(doc)
+            
+            if len(subsections) > 1:
+                logging.info(f"ðŸŽ¯ DEBUG: Document {doc.id} will be split into {len(subsections)} sources")
+                # Group this document with its subsections
+                document_groups.append((doc, subsections))
+            else:
+                logging.info(f"âŒ DEBUG: Document {doc.id} not split - using original logic")
+                # Single subsection or no subsections - treat as single group
+                document_groups.append((doc, []))
+        
+        # Second pass: process groups to create formatted results
+        # This ensures subsections from the same document appear together
+        for doc, subsections in document_groups:
+            if len(subsections) > 1:
+                # Sort subsections by their natural order
+                subsections.sort(key=lambda x: self._get_subsection_sort_key(x['subsection']))
+                
+                # Split document into multiple sources, one for each subsection
+                for j, subsection_info in enumerate(subsections):
+                    subsection_id = subsection_info['subsection']
+                    subsection_content = subsection_info['content']
+                    
+                    # Build three-part citation for this specific subsection
+                    sourcepage = doc.sourcepage or "Unknown Page"
+                    sourcefile = doc.sourcefile or "Unknown Document"
+                    base_citation = f"{subsection_id}, {sourcepage}, {sourcefile}"
+                    
+                    # Format the source with the subsection-specific content
+                    formatted_source = f"[{base_citation}]: {subsection_content}"
+                    formatted_results.append(formatted_source)
+                    logging.info(f"ðŸŽ¯ DEBUG: Added subsection source {j+1}: {subsection_id}")
+            else:
+                logging.info(f"âŒ DEBUG: Document {doc.id} not split - using original logic")
+                # Single subsection or no subsections - use existing logic
+                subsection = self._extract_subsection_from_document(doc)
+                
+                # Build three-part citation
+                sourcepage = doc.sourcepage or "Unknown Page"
+                sourcefile = doc.sourcefile or "Unknown Document"
+                
+                if subsection:
+                    base_citation = f"{subsection}, {sourcepage}, {sourcefile}"
+                else:
+                    base_citation = f"{sourcepage}, {sourcefile}"
+                
+                # Get FULL content without any truncation
+                content = doc.content or ""
+                
+                # If using semantic captions, APPEND them to the full content
+                if use_semantic_captions and doc.captions:
+                    caption_text = " . ".join([str(c.text) for c in doc.captions])
+                    if caption_text:
+                        content = f"{content}\n\nSemantic Captions: {caption_text}"
+                
+                # Format the source with the three-part citation followed by full content
+                formatted_source = f"[{base_citation}]: {content}"
+                formatted_results.append(formatted_source)
+
+        logging.info(f"ðŸ DEBUG: Returning {len(formatted_results)} total formatted sources")
+        return formatted_results
+
+    def _get_subsection_sort_key(self, subsection_id: str) -> tuple:
+        """Generate sort key for subsection ordering (e.g., D5.1 < D5.2 < D5.10)"""
+        import re
+        
+        # Extract components for natural sorting
+        # Handle patterns like: D5.1, A4.2, 1.1, Rule 31.1, Para 5.2
+        pattern = r'^([A-Z]*)(\d*)\.?(\d+)(?:\.(\d+))?'
+        match = re.match(pattern, subsection_id)
+        
+        if match:
+            prefix = match.group(1) or ""  # D, A, Rule, Para, etc.
+            major = int(match.group(2)) if match.group(2) else 0  # 5, 4, 31, etc.
+            minor = int(match.group(3)) if match.group(3) else 0  # 1, 2, etc.
+            patch = int(match.group(4)) if match.group(4) else 0  # For x.y.z format
+            
+            return (prefix, major, minor, patch)
+        
+        # Fallback: alphabetical sort
+        return (subsection_id, 0, 0, 0)
+
+async def run(
+    self,
+    messages: list[ChatCompletionMessageParam],
+    session_state: Any = None,
+    context: dict[str, Any] = {},
+) -> dict[str, Any]:
+    raise NotImplementedError
+
+async def run_stream(
+    self,
+    messages: list[ChatCompletionMessageParam],
+    session_state: Any = None,
+    context: dict[str, Any] = {},
+) -> AsyncGenerator[dict[str, Any], None]:
+    raise NotImplementedError
\ No newline at end of file
diff --git a/app/backend/approaches/chatapproach.py b/app/backend/approaches/chatapproach.py
index 346c9f3..8540397 100644
--- a/app/backend/approaches/chatapproach.py
+++ b/app/backend/approaches/chatapproach.py
@@ -149,3 +149,39 @@ class ChatApproach(Approach, ABC):
         overrides = context.get("overrides", {})
         auth_claims = context.get("auth_claims", {})
         return self.run_with_streaming(messages, overrides, auth_claims, session_state)
+
+    def build_filter(self, overrides: dict[str, Any], auth_claims: dict[str, Any]) -> Optional[str]:
+        """Build search filter based on overrides and auth claims"""
+        filters = []
+        
+        # Handle exclude_category
+        exclude_category = overrides.get("exclude_category", None)
+        if exclude_category:
+            filters.append(f"category ne '{exclude_category}'")
+        
+        # Handle include_category
+        include_category = overrides.get("include_category", None) 
+        if include_category and include_category != "All":
+            filters.append(f"category eq '{include_category}'")
+        
+        # Add security filters
+        if overrides.get("use_oid_security_filter"):
+            oid = auth_claims.get("oid")
+            if oid:
+                filters.append(f"oids/any(g:search.in(g, '{oid}'))")
+        
+        if overrides.get("use_groups_security_filter"):
+            groups = auth_claims.get("groups", [])
+            if groups:
+                group_str = ", ".join([f"'{g}'" for g in groups])
+                filters.append(f"groups/any(g:search.in(g, '{group_str}'))")
+        
+        return " and ".join(filters) if filters else None
+
+    # NEW: Provide prompt variables for PromptManager
+    def get_system_prompt_variables(self, prompt_template: Optional[str]) -> dict[str, Any]:
+        """
+        Minimal system prompt variables helper used by approaches when rendering prompty files.
+        Returns a dict with the prompt_template if provided; otherwise an empty dict.
+        """
+        return {"prompt_template": prompt_template} if prompt_template else {}
diff --git a/app/backend/approaches/chatreadretrieveread.py b/app/backend/approaches/chatreadretrieveread.py
index ed87976..b1abc35 100644
--- a/app/backend/approaches/chatreadretrieveread.py
+++ b/app/backend/approaches/chatreadretrieveread.py
@@ -1,10 +1,14 @@
 from collections.abc import Awaitable
 from typing import Any, Optional, Union, cast
+import re
+import logging
 
 from azure.search.documents.agent.aio import KnowledgeAgentRetrievalClient
 from azure.search.documents.aio import SearchClient
-from azure.search.documents.models import VectorQuery
+from azure.search.documents.models import VectorQuery, VectorizedQuery
+from approaches.approach import DataPoints, ExtraInfo, ThoughtStep, Document, TokenUsageProps
 from openai import AsyncOpenAI, AsyncStream
+from openai.types import CompletionUsage
 from openai.types.chat import (
     ChatCompletion,
     ChatCompletionChunk,
@@ -17,6 +21,9 @@ from approaches.chatapproach import ChatApproach
 from approaches.promptmanager import PromptManager
 from core.authentication import AuthenticationHelper
 
+def nonewlines(s: str) -> str:
+    return s.replace("\n", " ").replace("\r", " ")
+
 
 class ChatReadRetrieveReadApproach(ChatApproach):
     """
@@ -71,6 +78,197 @@ class ChatReadRetrieveReadApproach(ChatApproach):
         self.answer_prompt = self.prompt_manager.load_prompt("chat_answer_question.prompty")
         self.reasoning_effort = reasoning_effort
         self.include_token_usage = True
+        # Add citation mapping storage
+        self.citation_map = {}
+
+    def build_enhanced_citation_from_document(self, doc: Document, source_index: int) -> str:
+        """Build enhanced citation from document with improved logic for proper formatting"""
+        sourcepage = doc.sourcepage or ""
+        sourcefile = doc.sourcefile or ""
+        
+        # Clean up sourcepage and sourcefile
+        sourcepage = sourcepage.strip()
+        sourcefile = sourcefile.strip()
+        
+        # Extract subsection from content with enhanced logic
+        subsection = self._extract_subsection_from_document(doc)
+        
+        # Special handling to avoid duplication and encoded formats
+        final_sourcepage = sourcepage
+        
+        if subsection and sourcepage:
+            # Check if sourcepage is just the subsection (avoid duplication)
+            if sourcepage == subsection:
+                final_sourcepage = ""
+            # Check if sourcepage contains encoded format like "PD3E-1.1" where we extracted "1.1"
+            elif re.search(r'[A-Z]+\d*[A-Z]*-' + re.escape(subsection), sourcepage):
+                # Skip encoded sourcepage - use two-part citation instead
+                final_sourcepage = ""
+            # If subsection is a simple number like "1.1" but sourcepage is descriptive, keep both
+            elif re.match(r'^[A-Z]?\d+(?:\.\d+)?$', subsection) and len(sourcepage) > len(subsection):
+                # Keep both - this creates the desired three-part format
+                pass
+        
+        # Build citation based on what we have
+        if subsection and final_sourcepage and sourcefile:
+            # Full three-part format: subsection, sourcepage, sourcefile
+            citation = f"{subsection}, {final_sourcepage}, {sourcefile}"
+        elif subsection and sourcefile:
+            # Subsection + document (no sourcepage or sourcepage was duplicate)
+            citation = f"{subsection}, {sourcefile}"
+        elif final_sourcepage and sourcefile:
+            # Traditional two-part: sourcepage, sourcefile
+            citation = f"{final_sourcepage}, {sourcefile}"
+        elif sourcefile:
+            # Just document
+            citation = sourcefile
+        else:
+            # Fallback
+            citation = f"Source {source_index}"
+        
+        logging.info(f"Built citation: {citation} from doc with sourcepage='{doc.sourcepage}', sourcefile='{doc.sourcefile}', subsection='{subsection}'")
+        return citation
+
+    def _extract_subsection_from_document(self, doc: Document) -> str:
+        """Extract subsection from document content with improved logic"""
+        if not doc:
+            return ""
+        
+        # Priority 1: Check content first for specific subsection numbers (like 1.1, A4.1)
+        if doc.content:
+            lines = doc.content.split('\n')[:20]  # Check first 20 lines
+            
+            for line in lines:
+                line = line.strip()
+                if not line or line == "---":  # Skip empty lines and dividers
+                    continue
+                
+                # Look for specific subsection patterns at start of line OR standalone on line
+                subsection_patterns = [
+                    r'^([A-Z]\d+\.\d+)\b',           # A4.1, B2.3, etc.
+                    r'^(\d+\.\d+)\b',                # 1.1, 2.3, etc.
+                    r'^([A-Z]\d+)\b',                # A1, B2, etc.
+                    r'^(Rule \d+(?:\.\d+)?)\b',      # Rule 1, Rule 1.1
+                    r'^(Para \d+(?:\.\d+)?)\b',      # Para 1.1
+                    r'^(\d+\.\d+)$',                 # Standalone subsection number (exact match)
+                ]
+                
+                for pattern in subsection_patterns:
+                    match = re.match(pattern, line, re.IGNORECASE)
+                    if match:
+                        return match.group(1)
+                        
+                # Special case: check if this line is JUST a subsection number (like "1.1" on its own line)
+                if re.match(r'^\d+\.\d+$', line):
+                    return line
+                    
+        # Priority 2: Check sourcepage for encoded subsections (like PD3E-1.1)
+        if doc.sourcepage:
+            # Handle encoded formats like "PD3E-1.1" -> extract "1.1"
+            encoded_patterns = [
+                r'[A-Z]+\d*[A-Z]*-([A-Z]\d+\.\d+)',  # PD3E-A4.1 -> A4.1
+                r'[A-Z]+\d*[A-Z]*-(\d+\.\d+)',       # PD3E-1.1 -> 1.1
+                r'[A-Z]+\d*[A-Z]*-([A-Z]\d+)',       # PD3E-A4 -> A4
+            ]
+            
+            for pattern in encoded_patterns:
+                match = re.search(pattern, doc.sourcepage)
+                if match:
+                    return match.group(1)
+        
+        # Priority 3: Check sourcepage for direct subsection patterns
+        if doc.sourcepage:
+            direct_patterns = [
+                r'^([A-Z]\d+\.\d+)\b',           # A4.1, B2.3, etc.
+                r'^(\d+\.\d+)\b',                # 1.1, 2.3, etc.
+                r'^([A-Z]\d+)\b',                # A1, B2, etc.
+                r'^(Rule \d+(?:\.\d+)?)\b',      # Rule 1, Rule 1.1
+                r'^(Part \d+)\b',                # Part 1, Part 2, etc.
+            ]
+            
+            for pattern in direct_patterns:
+                match = re.match(pattern, doc.sourcepage, re.IGNORECASE)
+                if match:
+                    return match.group(1)
+        
+        return ""
+
+    # NEW: split a document into multiple subsection chunks with identifiers
+    def _extract_multiple_subsections_from_document(self, doc: Document) -> list[dict[str, str]]:
+        """
+        Scan document content and split into multiple subsections when clear subsection
+        markers are found (e.g., '1.1', 'A4.1', 'Rule 31.1', 'Para 5.2'). Returns a list
+        of dicts with keys: 'subsection' and 'content'. Returns [] if no reliable split.
+        """
+        if not doc or not doc.content:
+            return []
+
+        lines = doc.content.splitlines()
+        # Pattern covers: Rule 1.1, CPR 1.1, Para/Paragraph 1.1, A4.1, 1.1, A4
+        pattern = re.compile(
+            r'^(?:'
+            r'(?P<rule>Rule\s+\d+(?:\.\d+)?)|'
+            r'(?P<cpr>CPR\s+\d+(?:\.\d+)?)|'
+            r'(?P<para>Para(?:graph)?\s+\d+(?:\.\d+)?)|'
+            r'(?P<alpha_num_dotted>[A-Z]\d+\.\d+)|'
+            r'(?P<num_dotted>\d+\.\d+)|'
+            r'(?P<alpha_num>[A-Z]\d+)'
+            r')\b',
+            re.IGNORECASE,
+        )
+
+        # Collect candidate subsection headings with their start line index
+        headings: list[tuple[str, int]] = []
+        for i, raw in enumerate(lines):
+            line = raw.strip()
+            if not line or line == "---":
+                continue
+            m = pattern.match(line)
+            if not m:
+                continue
+            label = m.group(0)
+            # Normalize common prefixes for consistency
+            if m.lastgroup == "rule":
+                label = "Rule " + re.search(r'\d+(?:\.\d+)?', label).group(0)
+            elif m.lastgroup == "cpr":
+                label = "CPR " + re.search(r'\d+(?:\.\d+)?', label, re.IGNORECASE).group(0)
+            elif m.lastgroup and m.lastgroup.startswith("para"):
+                label = "Para " + re.search(r'\d+(?:\.\d+)?', label, re.IGNORECASE).group(0)
+            else:
+                # Ensure uppercase for alpha prefix like 'a4.1' -> 'A4.1'
+                label = label.upper()
+            headings.append((label, i))
+
+        # If we canâ€™t confidently detect multiple subsections, donâ€™t split
+        if len(headings) <= 1:
+            return []
+
+        # Build subsection chunks
+        subsections: list[dict[str, str]] = []
+        for idx, (label, start_line) in enumerate(headings):
+            end_line = headings[idx + 1][1] if idx + 1 < len(headings) else len(lines)
+            chunk_lines = lines[start_line:end_line]
+            content = "\n".join(chunk_lines).strip()
+            # Skip pathological tiny chunks
+            if not content or len(content) < 10:
+                continue
+            subsections.append({"subsection": label, "content": content})
+
+        return subsections
+
+    # NEW: lightweight wrapper to keep existing callsites working
+    def get_citation_from_document(self, doc: Document) -> str:
+        """
+        Backwards-compatible citation helper that leverages enhanced citation logic.
+        """
+        try:
+            return self.build_enhanced_citation_from_document(doc, 1)
+        except Exception:
+            sourcepage = (doc.sourcepage or "").strip()
+            sourcefile = (doc.sourcefile or "").strip()
+            if sourcepage and sourcefile:
+                return f"{sourcepage}, {sourcefile}"
+            return sourcefile or sourcepage or "Source"
 
     async def run_until_final_call(
         self,
@@ -92,6 +290,47 @@ class ChatReadRetrieveReadApproach(ChatApproach):
         else:
             extra_info = await self.run_search_approach(messages, overrides, auth_claims)
 
+        # Pre-build enhanced citations from search results
+        self.citation_map = {}
+        enhanced_citations = []
+        
+        for i, source in enumerate(extra_info.data_points.text, 1):
+            if isinstance(source, dict):
+                # Create Document object from dict for consistent processing
+                doc = Document(
+                    id=source.get("id"),
+                    content=source.get("content"),
+                    sourcepage=source.get("sourcepage"),
+                    sourcefile=source.get("sourcefile"),
+                    category=source.get("category"),
+                    storage_url=source.get("storageUrl"),
+                    updated=source.get("updated")
+                )
+                enhanced_citation = self.build_enhanced_citation_from_document(doc, i)
+            else:
+                # Handle legacy string format
+                enhanced_citation = f"Source {i}"
+            
+            # Store mapping - ensure uniqueness
+            citation_key = str(i)
+            self.citation_map[citation_key] = enhanced_citation
+            enhanced_citations.append(enhanced_citation)
+            
+            logging.info(f"Citation mapping [{citation_key}] = '{enhanced_citation}'")
+
+        # Format sources for prompt with simple numbering
+        text_sources_for_prompt = []
+        for i, source in enumerate(extra_info.data_points.text, 1):
+            if isinstance(source, dict):
+                content = source.get('content', '')
+            else:
+                # Handle string format (legacy)
+                content = str(source)
+            
+            # Format source with simple numbering for AI
+            source_text = f"[{i}]: {content}"
+            text_sources_for_prompt.append(source_text)
+
         messages = self.prompt_manager.render_prompt(
             self.answer_prompt,
             self.get_system_prompt_variables(overrides.get("prompt_template"))
@@ -99,10 +338,13 @@ class ChatReadRetrieveReadApproach(ChatApproach):
                 "include_follow_up_questions": bool(overrides.get("suggest_followup_questions")),
                 "past_messages": messages[:-1],
                 "user_query": original_user_query,
-                "text_sources": extra_info.data_points.text,
+                "text_sources": text_sources_for_prompt,
             },
         )
 
+        # Increase token limit to accommodate full content
+        response_token_limit = self.get_response_token_limit(self.chatgpt_model, 8192)  # Increased from 4096
+        
         chat_coroutine = cast(
             Union[Awaitable[ChatCompletion], Awaitable[AsyncStream[ChatCompletionChunk]]],
             self.create_chat_completion(
@@ -110,22 +352,157 @@ class ChatReadRetrieveReadApproach(ChatApproach):
                 self.chatgpt_model,
                 messages,
                 overrides,
-                self.get_response_token_limit(self.chatgpt_model, 1024),
+                response_token_limit,
                 should_stream,
             ),
         )
-        extra_info.thoughts.append(
-            self.format_thought_step_for_chatcompletion(
-                title="Prompt to generate answer",
-                messages=messages,
-                overrides=overrides,
-                model=self.chatgpt_model,
-                deployment=self.chatgpt_deployment,
-                usage=None,
-            )
-        )
+        
+        # Store enhanced citations in extra_info for frontend access
+        extra_info.enhanced_citations = enhanced_citations
+        extra_info.citation_map = self.citation_map
+        
+        # Ensure data_points.text contains properly structured data
+        if hasattr(extra_info.data_points, 'text') and extra_info.data_points.text:
+            # Make sure each item has required fields
+            for i, item in enumerate(extra_info.data_points.text):
+                if isinstance(item, dict):
+                    # Ensure all required fields exist
+                    item.setdefault('id', str(i))
+                    item.setdefault('sourcepage', '')
+                    item.setdefault('sourcefile', '')
+                    item.setdefault('content', '')
+                    item.setdefault('storageUrl', '')
+        
         return (extra_info, chat_coroutine)
 
+    def detect_court_in_query(self, query: str) -> Optional[str]:
+        """
+        Detect if a specific court is mentioned in the user query.
+        Returns the court name if found, None otherwise.
+        """
+        # Common court patterns to look for
+        court_patterns = [
+            r'\b(?:county\s+court|high\s+court|crown\s+court|magistrates?\s+court|circuit\s+commercial\s+court|commercial\s+court|family\s+court|employment\s+tribunal|court\s+of\s+appeal|supreme\s+court)\b',
+            r'\b(?:CC|HC|QBD|ChD|FD|CCC)\b',  # Common abbreviations
+        ]
+        
+        query_lower = query.lower()
+        for pattern in court_patterns:
+            match = re.search(pattern, query_lower, re.IGNORECASE)
+            if match:
+                return match.group(0)
+        
+        return None
+
+    def normalize_court_to_category(self, court_name: str) -> Optional[str]:
+        """
+        Normalize court name to match category format.
+        Returns the normalized category name if the court should be treated as a category.
+        """
+        if not court_name:
+            return None
+            
+        # Map of court names to their category format
+        court_category_map = {
+            'circuit commercial court': 'Circuit Commercial Court',
+            'commercial court': 'Commercial Court',
+            'high court': 'High Court',
+            'county court': 'County Court',
+            'crown court': 'Crown Court',
+            'magistrates court': 'Magistrates Court',
+            'family court': 'Family Court',
+            'employment tribunal': 'Employment Tribunal',
+            'court of appeal': 'Court of Appeal',
+            'supreme court': 'Supreme Court',
+            'ccc': 'Circuit Commercial Court',
+            'hc': 'High Court',
+            'qbd': "Queen's Bench Division",
+            'chd': 'Chancery Division',
+            'fd': 'Family Division'
+        }
+        
+        court_lower = court_name.lower().strip()
+        return court_category_map.get(court_lower)
+
+    async def check_if_court_is_category(self, court_name: str) -> bool:
+        """
+        Check if the detected court name exists as a category in the search index.
+        """
+        if not court_name:
+            return False
+            
+        normalized_court = self.normalize_court_to_category(court_name)
+        if not normalized_court:
+            return False
+            
+        try:
+            # Search for documents with this category
+            filter_query = f"category eq '{normalized_court}'"
+            results = await self.search_client.search(
+                search_text="",
+                filter=filter_query,
+                top=1,
+                select=["category"]
+            )
+            
+            # If we get any results, the court exists as a category
+            async for _ in results:
+                return True
+                
+        except Exception as e:
+            import logging
+            logging.warning(f"Error checking if court is category: {e}")
+            
+        return False
+
+    def build_filter(self, overrides: dict[str, Any], auth_claims: dict[str, Any]) -> Optional[str]:
+        """Build search filter with enhanced court/category detection"""
+        filters = []
+        
+        # First, check if exclude_category is specified
+        exclude_category = overrides.get("exclude_category", None)
+        if exclude_category:
+            filters.append(f"category ne '{exclude_category}'")
+        
+        # Check if include_category is specified
+        include_category = overrides.get("include_category", None)
+        if include_category and include_category != "All":
+            filters.append(f"category eq '{include_category}'")
+        else:
+            # If no specific category is included, check if court is mentioned in the query
+            original_user_query = overrides.get("original_user_query", "")
+            detected_court = self.detect_court_in_query(original_user_query)
+            
+            if detected_court:
+                # Check if this court is actually a category
+                normalized_court = self.normalize_court_to_category(detected_court)
+                if normalized_court:
+                    # Store this for async check later
+                    overrides["detected_court_category"] = normalized_court
+                    # For now, we'll build the filter assuming it is a category
+                    # The actual check will be done in run_search_approach
+                    filters.append(f"(category eq '{normalized_court}' or category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+                else:
+                    # Court detected but not a category, use default
+                    filters.append("(category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+            elif not include_category:
+                # No court detected and no category specified, use default
+                filters.append("(category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+        
+        # Add security filters if needed
+        if overrides.get("use_oid_security_filter"):
+            oid = auth_claims.get("oid")
+            if oid:
+                filters.append(f"oids/any(g:search.in(g, '{oid}'))")
+        
+        if overrides.get("use_groups_security_filter"):
+            groups = auth_claims.get("groups", [])
+            if groups:
+                group_str = ", ".join([f"'{g}'" for g in groups])
+                filters.append(f"groups/any(g:search.in(g, '{group_str}'))")
+        
+        return " and ".join(filters) if filters else None
+
     async def run_search_approach(
         self, messages: list[ChatCompletionMessageParam], overrides: dict[str, Any], auth_claims: dict[str, Any]
     ):
@@ -137,11 +514,28 @@ class ChatReadRetrieveReadApproach(ChatApproach):
         top = overrides.get("top", 3)
         minimum_search_score = overrides.get("minimum_search_score", 0.0)
         minimum_reranker_score = overrides.get("minimum_reranker_score", 0.0)
-        search_index_filter = self.build_filter(overrides, auth_claims)
-
+        
         original_user_query = messages[-1]["content"]
         if not isinstance(original_user_query, str):
             raise ValueError("The most recent message content must be a string.")
+        
+        # Store the original query in overrides for the filter building
+        overrides["original_user_query"] = original_user_query
+        
+        # Build filter with category logic
+        search_index_filter = self.build_filter(overrides, auth_claims)
+        
+        # Check if we need to verify court-as-category
+        if overrides.get("detected_court_category"):
+            court_category = overrides["detected_court_category"]
+            is_category = await self.check_if_court_is_category(court_category)
+            
+            if not is_category:
+                # Court is not a category, rebuild filter with default
+                import logging
+                logging.info(f"Court '{court_category}' is not a category, using default filter")
+                overrides.pop("detected_court_category", None)
+                search_index_filter = self.build_filter(overrides, auth_claims)
 
         query_messages = self.prompt_manager.render_prompt(
             self.query_rewrite_prompt, {"user_query": original_user_query, "past_messages": messages[:-1]}
@@ -175,6 +569,11 @@ class ChatReadRetrieveReadApproach(ChatApproach):
         if use_vector_search:
             vectors.append(await self.compute_text_embedding(query_text))
 
+        # Log the search parameters for debugging
+        import logging
+        logging.info(f"Searching with query: {query_text}, top: {top}, filter: {search_index_filter}")
+        logging.info(f"Detected court in query: {self.detect_court_in_query(original_user_query)}")
+
         results = await self.search(
             top,
             query_text,
@@ -189,11 +588,57 @@ class ChatReadRetrieveReadApproach(ChatApproach):
             use_query_rewriting,
         )
 
+        # Log the search results for debugging
+        logging.info(f"Search returned {len(results)} results")
+        for i, result in enumerate(results[:3]):  # Log first 3 results
+            content_preview = result.content[:200] if result.content else "No content"
+            logging.info(f"Result {i}: id={result.id}, content_length={len(result.content or '')}, preview={content_preview}")
+
         # STEP 3: Generate a contextual and content specific answer using the search results and chat history
-        text_sources = self.get_sources_content(results, use_semantic_captions, use_image_citation=False)
+        structured_sources = self.get_sources_content(results, use_semantic_captions, use_image_citation=False)
+
+        # Ensure each source has all required fields with proper field mapping
+        for source in structured_sources:
+            if isinstance(source, dict):
+                # Map common field variations and ensure all required fields are present
+                source.setdefault("sourcepage", source.get("source_page", ""))
+                source.setdefault("sourcefile", source.get("source_file", ""))
+                source.setdefault("category", "")
+                source.setdefault("updated", source.get("last_updated", source.get("date_updated", "")))
+                source.setdefault("storageurl", source.get("storage_url", source.get("url", "")))
+                source.setdefault("url", source.get("storageurl", source.get("storage_url", "")))
+                
+                # Extract fields from the actual search result if available
+                result_idx = structured_sources.index(source)
+                if result_idx < len(results):
+                    search_result = results[result_idx]
+                    
+                    # Get fields directly from search result
+                    if hasattr(search_result, 'get'):
+                        source["sourcepage"] = search_result.get("sourcepage", source.get("sourcepage", ""))
+                        source["sourcefile"] = search_result.get("sourcefile", source.get("sourcefile", ""))
+                        source["category"] = search_result.get("category", source.get("category", ""))
+                        source["updated"] = search_result.get("updated", search_result.get("last_updated", source.get("updated", "")))
+                        source["storageurl"] = search_result.get("storageurl", search_result.get("storage_url", source.get("storageurl", "")))
+                    else:
+                        # Handle Document object attributes
+                        source["sourcepage"] = getattr(search_result, "sourcepage", source.get("sourcepage", ""))
+                        source["sourcefile"] = getattr(search_result, "sourcefile", source.get("sourcefile", ""))
+                        source["category"] = getattr(search_result, "category", source.get("category", ""))
+                        source["updated"] = getattr(search_result, "updated", getattr(search_result, "last_updated", source.get("updated", "")))
+                        source["storageurl"] = getattr(search_result, "storageurl", getattr(search_result, "storage_url", source.get("storageurl", "")))
+                
+                # Ensure url field matches storageurl
+                if source.get("storageurl") and not source.get("url"):
+                    source["url"] = source["storageurl"]
+                
+                # Log for debugging
+                import logging
+                logging.info(f"Final structured source fields: {list(source.keys())}")
+                logging.info(f"Final source data: sourcepage='{source.get('sourcepage')}', sourcefile='{source.get('sourcefile')}', category='{source.get('category')}', updated='{source.get('updated')}', storageurl='{source.get('storageurl')}'")
 
         extra_info = ExtraInfo(
-            DataPoints(text=text_sources),
+            DataPoints(text=structured_sources),  # Pass structured data to frontend
             thoughts=[
                 self.format_thought_step_for_chatcompletion(
                     title="Prompt to generate search query",
@@ -250,10 +695,10 @@ class ChatReadRetrieveReadApproach(ChatApproach):
             results_merge_strategy=results_merge_strategy,
         )
 
-        text_sources = self.get_sources_content(results, use_semantic_captions=False, use_image_citation=False)
+        structured_sources = self.get_sources_content(results, use_semantic_captions=False, use_image_citation=False)
 
         extra_info = ExtraInfo(
-            DataPoints(text=text_sources),
+            DataPoints(text=structured_sources),  # Pass structured data to frontend
             thoughts=[
                 ThoughtStep(
                     "Use agentic retrieval",
@@ -279,3 +724,430 @@ class ChatReadRetrieveReadApproach(ChatApproach):
             ],
         )
         return extra_info
+
+    def get_citation_from_document_dict(self, doc_dict: dict[str, Any]) -> str:
+        """Get citation string from document dict in three-part format"""
+        sourcepage = doc_dict.get("sourcepage", "")
+        sourcefile = doc_dict.get("sourcefile", "")
+        
+        # Extract subsection from content if available
+        content = doc_dict.get("content", "")
+        subsection = self._extract_subsection_from_content(content)
+        
+        if not subsection:
+            # Fallback to simple subsection extraction from sourcepage
+            subsection = self._extract_simple_subsection(sourcepage)
+        
+        # Format page reference
+        page_ref = sourcepage if sourcepage else "Unknown Page"
+        
+        # Ensure we have a document name
+        document = sourcefile if sourcefile else "Unknown Document"
+        
+        # Return three-part citation format
+        if subsection:
+            return f"{subsection}, {page_ref}, {document}"
+        else:
+            return f"{page_ref}, {document}"
+    
+    def _extract_subsection_from_content(self, content: str) -> str:
+        """Extract subsection identifier from content"""
+        if not content:
+            return ""
+        
+        # Patterns to match subsection identifiers
+        patterns = [
+            r'^(\d+\.\d+(?:\.\d+)?)',           # 1.1, 1.2.3, etc.
+            r'^([A-Z]\d+\.\d+)',                # A4.1, D2.1, etc.
+            r'^(Rule\s+\d+\.\d+)',              # Rule 1.1, etc.
+            r'^(CPR\s+\d+\.\d+)',               # CPR 1.1, etc.
+            r'^(Para(?:graph)?\s+\d+\.\d+)',    # Para 1.1, Paragraph 1.1
+        ]
+        
+        # Check first few lines for subsection patterns
+        lines = content.split('\n')[:5]
+        for line in lines:
+            line = line.strip()
+            for pattern in patterns:
+                match = re.search(pattern, line, re.IGNORECASE)
+                if match:
+                    return match.group(1)
+        
+        return ""
+    
+    def _extract_simple_subsection(self, sourcepage: str) -> str:
+        """Extract simple subsection from sourcepage"""
+        if not sourcepage:
+            return ""
+        
+        # Look for patterns like "1.1" in sourcepage
+        patterns = [
+            r'(\d+\.\d+)',
+            r'([A-Z]\d+\.\d+)',
+            r'(Rule\s+\d+\.\d+)',
+            r'(Para\s+\d+\.\d+)',
+        ]
+        
+        for pattern in patterns:
+            match = re.search(pattern, sourcepage, re.IGNORECASE)
+            if match:
+                return match.group(1)
+        
+        return ""
+
+    def create_chat_completion(
+        self,
+        chatgpt_deployment: Optional[str],
+        chatgpt_model: str,
+        messages: list[ChatCompletionMessageParam],
+        overrides: dict[str, Any],
+        response_token_limit: int,
+        should_stream: bool = False,
+        tools: Optional[list[ChatCompletionToolParam]] = None,
+        temperature: Optional[float] = None,
+        n: Optional[int] = None,
+        reasoning_effort: Optional[str] = None,
+    ) -> Union[Awaitable[ChatCompletion], Awaitable[AsyncStream[ChatCompletionChunk]]]:
+        if chatgpt_model in self.GPT_REASONING_MODELS:
+            params: dict[str, Any] = {
+                # Increase max_completion_tokens to handle full content
+                "max_completion_tokens": max(response_token_limit, 16384)  # Increased from 8192
+            }
+
+            # Adjust parameters for reasoning models
+            supported_features = self.GPT_REASONING_MODELS[chatgpt_model]
+            if supported_features.streaming and should_stream:
+                params["stream"] = True
+                params["stream_options"] = {"include_usage": True}
+            params["reasoning_effort"] = reasoning_effort or overrides.get("reasoning_effort") or self.reasoning_effort
+
+        else:
+            # Include parameters that may not be supported for reasoning models
+            params = {
+                "max_tokens": max(response_token_limit, 8192),  # Increased from 4096
+                "temperature": temperature or overrides.get("temperature", 0.3),
+            }
+            if should_stream:
+                params["stream"] = True
+                params["stream_options"] = {"include_usage": True}
+
+        params["tools"] = tools
+        # Azure OpenAI takes the deployment name as the model name
+
+        return self.openai_client.chat.completions.create(
+            model=chatgpt_deployment if chatgpt_deployment else chatgpt_model,
+            messages=messages,
+            seed=overrides.get("seed", None),
+            n=n or 1,
+            **params,
+        )
+
+    def format_thought_step_for_chatcompletion(
+        self,
+        title: str,
+        messages: list[ChatCompletionMessageParam],
+        overrides: dict[str, Any],
+        model: str,
+        deployment: Optional[str],
+        usage: Optional[CompletionUsage] = None,
+        reasoning_effort: Optional[str] = None,
+    ) -> ThoughtStep:
+        from openai.types import CompletionUsage
+        properties: dict[str, Any] = {"model": model}
+        if deployment:
+            properties["deployment"] = deployment
+        # Only add reasoning_effort setting if the model supports it
+        if model in self.GPT_REASONING_MODELS:
+            properties["reasoning_effort"] = reasoning_effort or overrides.get(
+                "reasoning_effort", self.reasoning_effort
+            )
+        if usage:
+            properties["token_usage"] = TokenUsageProps.from_completion_usage(usage)
+        return ThoughtStep(title, messages, properties)
+
+    def format_search_results_for_prompt(self, search_results):
+        """Format search results to include all key fields in the prompt"""
+        formatted_sources = []
+        
+        for result in search_results:
+            # Include all key fields from the index
+            source_info = []
+            
+            # Add category if available
+            if result.get("category"):
+                source_info.append(f"Category: {result['category']}")
+            
+            # Add source page
+            if result.get("sourcepage"):
+                source_info.append(f"Source Page: {result['sourcepage']}")
+            
+            # Add source file
+            if result.get("sourcefile"):
+                source_info.append(f"Source File: {result['sourcefile']}")
+            
+            # Add updated date if available
+            if result.get("updated"):
+                source_info.append(f"Updated: {result['updated']}")
+            
+            # Add storage URL
+            if result.get("storageUrl"):
+                source_info.append(f"URL: {result['storageUrl']}")
+            
+            # Format the complete source entry
+            formatted_source = "\n".join(source_info)
+            formatted_source += f"\nContent: {result.get('content', '')}"
+            
+            formatted_sources.append(formatted_source)
+        
+        return "\n\n---\n\n".join(formatted_sources)
+
+    async def format_response_with_citations(self, response_text, search_results):
+        """Format the response with enhanced citations including all fields"""
+        # Store search results for citation generation
+        self._current_search_results = search_results
+        
+        # Extract citations from response
+        citations = []
+        citation_lookup = {}
+        
+        for idx, result in enumerate(search_results):
+            citation_key = f"[{idx + 1}]"
+            citation = {
+                "id": result.get("id", f"doc_{idx}"),
+                "content": result.get("content", ""),
+                "category": result.get("category", ""),
+                "sourcepage": result.get("sourcepage", ""),
+                "sourcefile": result.get("sourcefile", ""),
+                "url": result.get("storageUrl", ""),
+                "updated": result.get("updated", ""),
+                "title": f"{result.get('sourcefile', '')} - {result.get('sourcepage', '')}",
+                "filepath": result.get("sourcepage", ""),
+                "metadata": {
+                    "category": result.get("category", ""),
+                    "sourcefile": result.get("sourcefile", ""),
+                    "updated": result.get("updated", "")
+                }
+            }
+            citations.append(citation)
+            citation_lookup[citation_key] = citation
+        
+        return {
+            "answer": response_text,
+            "citations": citations,
+            "thoughts": f"Searched {len(search_results)} sources with all metadata fields included."
+        }
+
+    def get_sources_content(self, results: list[Document], use_semantic_captions: bool, use_image_citation: bool) -> list[dict[str, Any]]:
+        """Return structured data for consistent processing with full content preserved and multiple subsections support"""
+        
+        import logging
+        logging.info(f"ðŸ” DEBUG: ChatReadRetrieveRead processing {len(results)} documents for sources content")
+        
+        structured_results = []
+        
+        # First pass: process each document and collect subsections
+        document_groups = []  # List of (original_doc, [subsections]) tuples
+        
+        for i, doc in enumerate(results):
+            logging.info(f"ðŸ” DEBUG: Processing document {i+1}/{len(results)}: {doc.id}")
+            
+            # Check if document contains multiple subsections
+            subsections = self._extract_multiple_subsections_from_document(doc)
+            
+            if len(subsections) > 1:
+                logging.info(f"ðŸŽ¯ DEBUG: Document {doc.id} will be split into {len(subsections)} sources")
+                # Group this document with its subsections
+                document_groups.append((doc, subsections))
+            else:
+                logging.info(f"âŒ DEBUG: Document {doc.id} not split - using original logic")
+                # Single subsection or no subsections - treat as single group
+                document_groups.append((doc, []))
+        
+        # Second pass: process groups to create structured results
+        # This ensures subsections from the same document appear together
+        for doc, subsections in document_groups:
+            if len(subsections) > 1:
+                # Split document into multiple sources, one for each subsection
+                # Sort subsections by their natural order (e.g., D5.1, D5.2, D5.3)
+                subsections.sort(key=lambda x: self._get_subsection_sort_key(x['subsection']))
+                
+                for j, subsection_info in enumerate(subsections):
+                    subsection_id = subsection_info['subsection']
+                    subsection_content = subsection_info['content']
+                    
+                    # Build three-part citation for this specific subsection
+                    sourcepage = doc.sourcepage or "Unknown Page"
+                    sourcefile = doc.sourcefile or "Unknown Document"
+                    base_citation = f"{subsection_id}, {sourcepage}, {sourcefile}"
+                    
+                    # Create structured object for this subsection
+                    result_obj = {
+                        "id": f"{doc.id}_subsection_{j}",  # Unique ID for each subsection
+                        "content": subsection_content,  # Subsection-specific content
+                        "sourcepage": sourcepage,
+                        "sourcefile": sourcefile,
+                        "category": str(doc.category) if doc.category is not None else "",
+                        "storageUrl": str(doc.storage_url) if doc.storage_url is not None else "",
+                        "oids": doc.oids if doc.oids is not None else [],
+                        "groups": doc.groups if doc.groups is not None else [],
+                        "score": doc.score if doc.score is not None else 0.0,
+                        "reranker_score": doc.reranker_score if doc.reranker_score is not None else 0.0,
+                        "updated": str(doc.updated) if doc.updated is not None else "",
+                        # Add citation information for frontend compatibility
+                        "citation": base_citation,
+                        "filepath": sourcepage,
+                        "url": str(doc.storage_url) if doc.storage_url is not None else "",
+                        # Add metadata to help frontend group related subsections
+                        "original_doc_id": str(doc.id),
+                        "subsection_index": j,
+                        "total_subsections": len(subsections),
+                        "is_subsection": True,
+                        "subsection_id": subsection_id,  # Add for easier identification
+                    }
+                    
+                    structured_results.append(result_obj)
+                    logging.info(f"ðŸŽ¯ DEBUG: Added subsection source {j+1}: {subsection_id}")
+            else:
+                # Single subsection or no subsections - use existing logic
+                result_obj = {
+                    "id": str(doc.id) if doc.id is not None else "",
+                    "content": str(doc.content) if doc.content is not None else "",  # Full content, no truncation
+                    "sourcepage": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                    "sourcefile": str(doc.sourcefile) if doc.sourcefile is not None else "",
+                    "category": str(doc.category) if doc.category is not None else "",
+                    "storageUrl": str(doc.storage_url) if doc.storage_url is not None else "",
+                    "oids": doc.oids if doc.oids is not None else [],
+                    "groups": doc.groups if doc.groups is not None else [],
+                    "score": doc.score if doc.score is not None else 0.0,
+                    "reranker_score": doc.reranker_score if doc.reranker_score is not None else 0.0,
+                    "updated": str(doc.updated) if doc.updated is not None else "",
+                    # Add citation information for frontend compatibility
+                    "citation": self.get_citation_from_document(doc),
+                    "filepath": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                    "url": str(doc.storage_url) if doc.storage_url is not None else "",
+                    # Add metadata for consistency
+                    "original_doc_id": str(doc.id),
+                    "is_subsection": False,
+                }
+
+                # Add captions as supplementary information if using semantic captions
+                if use_semantic_captions and doc.captions:
+                    result_obj["captions"] = [
+                        {
+                            "text": str(caption.text) if caption.text is not None else "",
+                            "highlights": caption.highlights if caption.highlights is not None else "",
+                            "additional_properties": caption.additional_properties if caption.additional_properties is not None else {},
+                        }
+                        for caption in doc.captions
+                    ]
+                    # Store caption summary separately - don't replace content
+                    caption_texts = [str(c.text) for c in doc.captions if c.text is not None]
+                    if caption_texts:
+                        result_obj["caption_summary"] = " . ".join(caption_texts)
+
+                structured_results.append(result_obj)
+
+        logging.info(f"ðŸ” DEBUG: Returning {len(structured_results)} structured sources (original: {len(results)})")
+        logging.info(f"ðŸ” DEBUG: Subsection grouping - documents processed: {len(document_groups)}")
+        
+        # Log the structure for debugging
+        for i, result in enumerate(structured_results):
+            if result.get("is_subsection"):
+                logging.info(f"ðŸ” DEBUG: Result {i}: subsection {result.get('subsection_id', 'Unknown')} ({result.get('subsection_index', 0)+1}/{result.get('total_subsections', 1)}) of {result.get('original_doc_id')}")
+            else:
+                logging.info(f"ðŸ” DEBUG: Result {i}: single document {result.get('original_doc_id')}")
+        
+        return structured_results
+
+    def _get_subsection_sort_key(self, subsection_id: str) -> tuple:
+        """Generate sort key for subsection ordering (e.g., D5.1 < D5.2 < D5.10)"""
+        import re
+        
+        # Extract components for natural sorting
+        # Handle patterns like: D5.1, A4.2, 1.1, Rule 31.1, Para 5.2
+        pattern = r'^([A-Z]*)(\d*)\.?(\d+)(?:\.(\d+))?'
+        match = re.match(pattern, subsection_id)
+        
+        if match:
+            prefix = match.group(1) or ""  # D, A, Rule, Para, etc.
+            major = int(match.group(2)) if match.group(2) else 0  # 5, 4, 31, etc.
+            minor = int(match.group(3)) if match.group(3) else 0  # 1, 2, etc.
+            patch = int(match.group(4)) if match.group(4) else 0  # For x.y.z format
+            
+            return (prefix, major, minor, patch)
+        
+        # Fallback: alphabetical sort
+        return (subsection_id, 0, 0, 0)
+
+    def get_response_token_limit(self, model_name: str = None, default_limit: int = None) -> int:
+        """
+        Get the response token limit for the current model.
+        
+        Args:
+            model_name: The model name to get limits for (defaults to self.chatgpt_model)
+            default_limit: Default limit to use if provided (overrides model-based calculation)
+        
+        Returns:
+            Token limit for the model
+        """
+        if default_limit is not None:
+            return default_limit
+            
+        if model_name is None:
+            model_name = self.chatgpt_model
+        
+        # Token limits for different models
+        model_limits = {
+            "gpt-4": 8192,
+            "gpt-4-32k": 32768,
+            "gpt-4-turbo": 128000,
+            "gpt-4o": 128000,
+            "gpt-4o-mini": 16384,
+            "gpt-3.5-turbo": 4096,
+            "gpt-3.5-turbo-16k": 16384,
+            "o1": 100000,
+            "o1-mini": 65536,
+            "o3-mini": 65536,
+        }
+        
+        # Check if it's a reasoning model first
+        if model_name in self.GPT_REASONING_MODELS:
+            return self.RESPONSE_REASONING_DEFAULT_TOKEN_LIMIT
+        
+        # Extract base model name (handle versioned models like gpt-4-0613)
+        base_model = model_name.lower()
+        for model_key in model_limits.keys():
+            if model_key in base_model:
+                return model_limits[model_key]
+        
+        # Default to conservative limit if model not found
+        return self.RESPONSE_DEFAULT_TOKEN_LIMIT
+
+    async def compute_text_embedding(self, query_text: str) -> VectorizedQuery:
+        """
+        Compute text embedding for vector search.
+        
+        Args:
+            query_text: The text to compute embedding for
+            
+        Returns:
+            VectorizedQuery object for use in search
+        """
+        if not query_text:
+            raise ValueError("Query text cannot be empty")
+        
+        # Create embedding using OpenAI client
+        embedding_response = await self.openai_client.embeddings.create(
+            model=self.embedding_deployment if self.embedding_deployment else self.embedding_model,
+            input=query_text
+        )
+        
+        # Extract the embedding vector
+        embedding_vector = embedding_response.data[0].embedding
+        
+        # Create and return VectorizedQuery
+        return VectorizedQuery(
+            vector=embedding_vector,
+            k_nearest_neighbors=50,  # Default number of nearest neighbors
+            fields=self.embedding_field
+        )
diff --git a/app/backend/approaches/chatreadretrievereadvision.py b/app/backend/approaches/chatreadretrievereadvision.py
index f8aaf3c..217833b 100644
--- a/app/backend/approaches/chatreadretrievereadvision.py
+++ b/app/backend/approaches/chatreadretrievereadvision.py
@@ -147,7 +147,8 @@ class ChatReadRetrieveReadVisionApproach(ChatApproach):
         text_sources = []
         image_sources = []
         if send_text_to_gptvision:
-            text_sources = self.get_sources_content(results, use_semantic_captions, use_image_citation=True)
+            # Get structured content with all fields preserved
+            text_sources = self.get_sources_content_structured(results, use_semantic_captions, use_image_citation=True)
         if send_images_to_gptvision:
             for result in results:
                 url = await fetch_image(self.blob_container_client, result)
@@ -213,7 +214,7 @@ class ChatReadRetrieveReadVisionApproach(ChatApproach):
                 model=self.gpt4v_deployment if self.gpt4v_deployment else self.gpt4v_model,
                 messages=messages,
                 temperature=overrides.get("temperature", 0.3),
-                max_tokens=1024,
+                max_tokens=4096,  # Increased from 1024 to accommodate full content
                 n=1,
                 stream=should_stream,
                 seed=seed,
diff --git a/app/backend/approaches/prompts/ask_answer_question.prompty b/app/backend/approaches/prompts/ask_answer_question.prompty
index 7ff73d2..b45351a 100644
--- a/app/backend/approaches/prompts/ask_answer_question.prompty
+++ b/app/backend/approaches/prompts/ask_answer_question.prompty
@@ -4,39 +4,97 @@ description: Answer a single question (with no chat history) using solely text s
 model:
     api: chat
 sample:
-    user_query: What does a product manager do?
+    user_query: What are the disclosure obligations in fast track cases?
     text_sources:
-        - "role_library.pdf#page=29:  The Manager of Product Management will collaborate with internal teams, such as engineering, sales, marketing, and finance, as well as external partners, suppliers, and customers to ensure successful product execution. Responsibilities: Â· Lead the product management team and provide guidance on product strategy, design, development, and launch. Â· Develop and implement product life-cycle management processes. Â· Monitor and analyze industry trends to identify opportunities for new products. Â· Develop product marketing plans and go-to-market strategies. Â· Research customer needs and develop customer-centric product roadmaps. Â· Collaborate with internal teams to ensure product execution and successful launch. Â· Develop pricing strategies and cost models. Â· Oversee product portfolio and performance metrics. Â· Manage product development budget. Â· Analyze product performance and customer feedback to identify areas for improvement. Qualifications: Â· Bachelor's degree in business, engineering, or a related field. Â· At least 5 years of experience in product management. Â· Proven track record of successful product launches."
-        - "role_library.pdf#page=23: Company: Contoso Electronics Location: Anywhere Job Type: Full-Time Salary: Competitive, commensurate with experience Job Summary: The Senior Manager of Product Management will be responsible for leading the product management team at Contoso Electronics. This role includes developing strategies, plans and objectives for the product management team and managing the day-to-day operations. The Senior Manager of Product Management will be responsible for the successful launch of new products and the optimization of existing products. Responsibilities: Â· Develop and implement product management strategies, plans and objectives to maximize team performance. Â· Analyze competitive landscape and market trends to develop product strategies. Â· Lead the product management team in the development of product plans, roadmaps and launch plans. Â· Monitor the performance of product management team, analyze results and implement corrective action as needed. Â· Manage the product lifecycle, including product development, launch, and end of life. Â· Ensure product features and benefits meet customer requirements. Â· Establish and maintain relationships with key customers, partners, and vendors."
-        - "role_library.pdf#page=28:  Â· 7+ years of experience in research and development in the electronics sector. Â· Proven track record of successfully designing, testing, and optimizing products. Â· Experience leading a team of researchers and engineers. Â· Excellent problem-solving and analytical skills. Â· Ability to work in a fast-paced environment and meet tight deadlines.Â· Knowledge of industry trends, technologies, and regulations. Â· Excellent communication and presentation skills. Manager of Product Management Job Title: Manager of Product Management, Contoso Electronics Job Summary: The Manager of Product Management is responsible for overseeing the product management team, driving product development and marketing strategy for Contoso Electronics. This individual will be accountable for the successful launch of new products and the implementation of product life-cycle management processes. The Manager of Product Management will collaborate with internal teams, such as engineering, sales, marketing, and finance, as well as external partners, suppliers, and customers to ensure successful product execution."
+        - "[1]: Standard disclosure requires a party to disclose documents on which they rely, documents which adversely affect their own case, another party's case, or support another party's case, and documents which they are required to disclose by a relevant practice direction."
+        - "[2]: In fast track cases, the court will give directions for the management of the case and set a timetable. Standard disclosure is the usual order unless the court directs otherwise."
 ---
 system:
 {% if override_prompt %}
 {{ override_prompt }}
 {% else %}
-You are an intelligent assistant helping Contoso Inc employees with their healthcare plan questions and employee handbook questions.
-Use 'you' to refer to the individual asking the questions even if they ask with 'I'.
-Answer the following question using only the data provided in the sources below.
-Each source has a name followed by colon and the actual information, always include the source name for each fact you use in the response.
-If you cannot answer using the sources below, say you don't know. Use below example to answer
+You are an expert legal assistant helping lawyers and legal professionals in England and Wales with questions about the Civil Procedure Rules (CPR), Practice Directions, and Court Guides.
+
+IMPORTANT CONTEXT AWARENESS:
+- If the user asks about a specific court (e.g., Circuit Commercial Court, High Court), prioritize information specific to that court.
+- If no specific court is mentioned, focus on general Civil Procedure Rules and Practice Directions.
+- Always note when rules or procedures are court-specific versus generally applicable.
+
+LEGAL TERMINOLOGY REFERENCE:
+When interpreting legal terms in your responses, refer to these standard definitions:
+- **Affidavit**: A written, sworn statement of evidence
+- **Alternative dispute resolution**: Collective description of methods of resolving disputes otherwise than through the normal trial process
+- **Base rate**: The interest rate set by the Bank of England which is used as the basis for other banks' rates
+- **Budget**: An estimate of the reasonable and proportionate costs (including disbursements) which a party intends to incur in the proceedings
+- **Contribution**: A right of someone to recover from a third person all or part of the amount which he himself is liable to pay
+- **Counterclaim**: A claim brought by a defendant in response to the claimant's claim, which is included in the same proceedings as the claimant's claim
+- **Cross-examination**: (and see 'Evidence in chief') Questioning of a witness by a party other than the party who called the witness
+- **Damages**: A sum of money awarded by the court as compensation to the claimant
+- **Aggravated damages**: Additional damages which the court may award as compensation for the defendant's objectionable behaviour
+- **Exemplary damages**: Damages which go beyond compensating for actual loss and are awarded to show the court's disapproval of the defendant's behaviour
+- **Damages-based agreement**: A damages-based agreement is an agreement which complies with the provisions of the Damages-Based Agreements Regulations 2013
+- **Defence of tender before claim**: A defence that, before the claimant started proceedings, the defendant unconditionally offered to the claimant the amount due or, if no specified amount is claimed, an amount sufficient to satisfy the claim
+- **Divisional Court**: With or without capital letters, means a divisional court constituted under section 66 of the Senior Courts Act 1981
+- **Evidence in chief**: (and see 'Cross-examination') The evidence given by a witness for the party who called him
+- **Indemnity**: A right of someone to recover from a third party the whole amount which he himself is liable to pay
+- **Injunction**: A court order prohibiting a person from doing something or requiring a person to do something
+- **Joint liability**: (and see 'Several liability') Parties who are jointly liable share a single liability and each party can be held liable for the whole of it
+- **Limitation period**: The period within which a person who has a right to claim against another person must start court proceedings to establish that right. The expiry of the period may be a defence to the claim
+- **List**: Cases are allocated to different lists depending on the subject matter of the case. The lists are used for administrative purposes and may also have their own procedures and judges
+- **Official copy**: A copy of an official document, supplied and marked as such by the office which issued the original
+- **Practice form**: Form to be used for a particular purpose in proceedings, the form and purpose being specified by a practice direction
+- **Pre-action protocol**: Statements of best practice about pre-action conduct which have been approved by the Head of Civil Justice and are listed in Practice Direction (Pre-Action Conduct)
+- **Privilege**: The right of a party to refuse to disclose a document or produce a document or to refuse to answer questions on the ground of some special interest recognised by law
+- **Seal**: A seal is a mark which the court puts on a document to indicate that the document has been issued by the court
+- **Service**: Steps required by rules of court to bring documents used in court proceedings to a person's attention
+- **Set aside**: Cancelling a judgment or order or a step taken by a party in the proceedings
+- **Several liability**: (and see 'Joint liability') A person who is severally liable with others may remain liable for the whole claim even where judgment has been obtained against the others
+- **Stay**: A stay imposes a halt on proceedings, apart from taking any steps allowed by the Rules or the terms of the stay. Proceedings can be continued if a stay is lifted
+- **Strike out**: Striking out means the court ordering written material to be deleted so that it may no longer be relied upon
+- **Without prejudice**: Negotiations with a view to a settlement are usually conducted 'without prejudice', which means that the circumstances in which the content of those negotiations may be revealed to the court are very restricted
+
+OUTPUT FORMAT REQUIREMENTS:
+- **SENTENCE-LEVEL ATTRIBUTION**: Each sentence in your response must be directly attributable to content from the search results.
+- **MANDATORY SIMPLE CITATIONS**: Every sentence must end with a simple numbered citation in square brackets [1], [2], [3], etc.
+- **CONTENT FIELD TRACEABILITY**: Each sentence must be traceable to the specific content field in the numbered sources provided.
+- **NO SYNTHESIS**: Do not create sentences by combining information from multiple sources or by paraphrasing.
+- **CONCISE RESPONSES**: Keep responses focused and concise. Extract only the most relevant information from sources.
+
+MANDATORY CITATION REQUIREMENTS:
+- **EVERY SINGLE SENTENCE must end with a simple numbered citation in square brackets [1], [2], [3], etc.**
+- **USE ONLY THE SOURCE NUMBERS**: Reference sources using only the numbers provided at the start of each source (e.g., [1], [2], [3]).
+- **ONE REFERENCE PER CITATION**: Each citation must reference only ONE source number.
+- **NO EXCEPTIONS**: If you cannot cite a sentence, do not include it in your response.
+- **EXACT TEXT MATCHING**: You must copy key phrases word-for-word from the source content.
+- **SUMMARIZE WHEN APPROPRIATE**: Instead of copying entire paragraphs, extract the key points and summarize them while maintaining exact terminology.
+
+CITATION FORMAT EXAMPLES:
+- For referencing the first source: [1]
+- For referencing the second source: [2]
+- For referencing the third source: [3]
+
+**CRITICAL**: Use only the simple numbered format [1], [2], [3] etc. Do NOT create complex citations. The source numbers are provided at the beginning of each source below.
+
+Answer ONLY with the most relevant information from the numbered sources below. Keep responses concise and focused. Each sentence in your response must be directly taken from and attributable to the content field of the search results. If there isn't enough information below, say you don't know. Do not generate answers that don't use the exact text from the sources below. If asking a clarifying question to the user would help, ask the question.
+
+{% if injected_prompt %}
 {{ injected_prompt }}
 {% endif %}
+{% endif %}
 
 user:
-What is the deductible for the employee plan for a visit to Overlake in Bellevue?
+{{ user_query }}
 
 Sources:
-info1.txt: deductibles depend on whether you are in-network or out-of-network. In-network deductibles are $500 for employee and $1000 for family. Out-of-network deductibles are $1000 for employee and $2000 for family.
-info2.pdf: Overlake is in-network for the employee plan.
-info3.pdf: Overlake is the name of the area that includes a park and ride near Bellevue.
-info4.pdf: In-network institutions include Overlake, Swedish and others in the region.
-
-assistant:
-In-network deductibles are $500 for employee and $1000 for family [info1.txt] and Overlake is in-network for the employee plan [info2.pdf][info4.pdf].
-
-user:
+{% for text_source in text_sources %}
+{{ text_source }}
+{% endfor %}
 {{ user_query }}
+
 Sources:
 {% for text_source in text_sources %}
 {{ text_source }}
 {% endfor %}
+{% for text_source in text_sources %}
+{{ text_source }}
+{% endfor %}
diff --git a/app/backend/approaches/prompts/chat_answer_question.prompty b/app/backend/approaches/prompts/chat_answer_question.prompty
index 3dcb05a..7e954cf 100644
--- a/app/backend/approaches/prompts/chat_answer_question.prompty
+++ b/app/backend/approaches/prompts/chat_answer_question.prompty
@@ -3,49 +3,122 @@ name: Chat
 description: Answer a question (with chat history) using solely text sources.
 model:
     api: chat
+    parameters:
+        temperature: 0.2
 sample:
-    user_query: What does a product manager do that a CEO doesn't?
+    user_query: What are the disclosure obligations in fast track cases?
     include_follow_up_questions: true
     past_messages:
         - role: user
-          content: "What does a CEO do?"
+          content: "What is the fast track?"
         - role: assistant
-          content: "A CEO, or Chief Executive Officer, is responsible for providing strategic direction and oversight to a company to ensure its long-term success and profitability. They develop and implement strategies and objectives for financial success and growth, provide guidance to the executive team, manage day-to-day operations, ensure compliance with laws and regulations, develop and maintain relationships with stakeholders, monitor industry trends, and represent the company in public events 12. [role_library.pdf#page=1][role_library.pdf#page=3]"
+          content: "The fast track is for claims with a value between Â£10,000 and Â£25,000 under CPR Part 28. [1]"
     text_sources:
-        - "role_library.pdf#page=29:  The Manager of Product Management will collaborate with internal teams, such as engineering, sales, marketing, and finance, as well as external partners, suppliers, and customers to ensure successful product execution. Responsibilities: Â· Lead the product management team and provide guidance on product strategy, design, development, and launch. Â· Develop and implement product life-cycle management processes. Â· Monitor and analyze industry trends to identify opportunities for new products. Â· Develop product marketing plans and go-to-market strategies. Â· Research customer needs and develop customer-centric product roadmaps. Â· Collaborate with internal teams to ensure product execution and successful launch. Â· Develop pricing strategies and cost models. Â· Oversee product portfolio and performance metrics. Â· Manage product development budget. Â· Analyze product performance and customer feedback to identify areas for improvement. Qualifications: Â· Bachelor's degree in business, engineering, or a related field. Â· At least 5 years of experience in product management. Â· Proven track record of successful product launches."
-        - "role_library.pdf#page=23: Company: Contoso Electronics Location: Anywhere Job Type: Full-Time Salary: Competitive, commensurate with experience Job Summary: The Senior Manager of Product Management will be responsible for leading the product management team at Contoso Electronics. This role includes developing strategies, plans and objectives for the product management team and managing the day-to-day operations. The Senior Manager of Product Management will be responsible for the successful launch of new products and the optimization of existing products. Responsibilities: Â· Develop and implement product management strategies, plans and objectives to maximize team performance. Â· Analyze competitive landscape and market trends to develop product strategies. Â· Lead the product management team in the development of product plans, roadmaps and launch plans. Â· Monitor the performance of product management team, analyze results and implement corrective action as needed. Â· Manage the product lifecycle, including product development, launch, and end of life. Â· Ensure product features and benefits meet customer requirements. Â· Establish and maintain relationships with key customers, partners, and vendors."
-        - "role_library.pdf#page=28:  Â· 7+ years of experience in research and development in the electronics sector. Â· Proven track record of successfully designing, testing, and optimizing products. Â· Experience leading a team of researchers and engineers. Â· Excellent problem-solving and analytical skills. Â· Ability to work in a fast-paced environment and meet tight deadlines.Â· Knowledge of industry trends, technologies, and regulations. Â· Excellent communication and presentation skills. Manager of Product Management Job Title: Manager of Product Management, Contoso Electronics Job Summary: The Manager of Product Management is responsible for overseeing the product management team, driving product development and marketing strategy for Contoso Electronics. This individual will be accountable for the successful launch of new products and the implementation of product life-cycle management processes. The Manager of Product Management will collaborate with internal teams, such as engineering, sales, marketing, and finance, as well as external partners, suppliers, and customers to ensure successful product execution."
+        - "[1]: Standard disclosure requires a party to disclose documents on which they rely, documents which adversely affect their own case, another party's case, or support another party's case, and documents which they are required to disclose by a relevant practice direction."
+        - "[2]: In fast track cases, the court will give directions for the management of the case and set a timetable. Standard disclosure is the usual order unless the court directs otherwise."
 ---
 system:
 {% if override_prompt %}
 {{ override_prompt }}
 {% else %}
-Assistant helps the company employees with their healthcare plan questions, and questions about the employee handbook. Be brief in your answers.
-Answer ONLY with the facts listed in the list of sources below. If there isn't enough information below, say you don't know. Do not generate answers that don't use the sources below. If asking a clarifying question to the user would help, ask the question.
-If the question is not in English, answer in the language used in the question.
-Each source has a name followed by colon and the actual information, always include the source name for each fact you use in the response. Use square brackets to reference the source, for example [info1.txt]. Don't combine sources, list each source separately, for example [info1.txt][info2.pdf].
+You are an expert legal assistant helping lawyers and legal professionals in England and Wales with questions about the Civil Procedure Rules (CPR), Practice Directions, and Court Guides.
+
+IMPORTANT CONTEXT AWARENESS:
+- If the user asks about a specific court (e.g., Circuit Commercial Court, High Court), prioritize information specific to that court.
+- If no specific court is mentioned, focus on general Civil Procedure Rules and Practice Directions.
+- Always note when rules or procedures are court-specific versus generally applicable.
+
+LEGAL TERMINOLOGY REFERENCE:
+When interpreting legal terms in your responses, refer to these standard definitions:
+- **Affidavit**: A written, sworn statement of evidence
+- **Alternative dispute resolution**: Collective description of methods of resolving disputes otherwise than through the normal trial process
+- **Base rate**: The interest rate set by the Bank of England which is used as the basis for other banks' rates
+- **Budget**: An estimate of the reasonable and proportionate costs (including disbursements) which a party intends to incur in the proceedings
+- **Contribution**: A right of someone to recover from a third person all or part of the amount which he himself is liable to pay
+- **Counterclaim**: A claim brought by a defendant in response to the claimant's claim, which is included in the same proceedings as the claimant's claim
+- **Cross-examination**: (and see 'Evidence in chief') Questioning of a witness by a party other than the party who called the witness
+- **Damages**: A sum of money awarded by the court as compensation to the claimant
+- **Aggravated damages**: Additional damages which the court may award as compensation for the defendant's objectionable behaviour
+- **Exemplary damages**: Damages which go beyond compensating for actual loss and are awarded to show the court's disapproval of the defendant's behaviour
+- **Damages-based agreement**: A damages-based agreement is an agreement which complies with the provisions of the Damages-Based Agreements Regulations 2013
+- **Defence of tender before claim**: A defence that, before the claimant started proceedings, the defendant unconditionally offered to the claimant the amount due or, if no specified amount is claimed, an amount sufficient to satisfy the claim
+- **Divisional Court**: With or without capital letters, means a divisional court constituted under section 66 of the Senior Courts Act 1981
+- **Evidence in chief**: (and see 'Cross-examination') The evidence given by a witness for the party who called him
+- **Indemnity**: A right of someone to recover from a third party the whole amount which he himself is liable to pay
+- **Injunction**: A court order prohibiting a person from doing something or requiring a person to do something
+- **Joint liability**: (and see 'Several liability') Parties who are jointly liable share a single liability and each party can be held liable for the whole of it
+- **Limitation period**: The period within which a person who has a right to claim against another person must start court proceedings to establish that right. The expiry of the period may be a defence to the claim
+- **List**: Cases are allocated to different lists depending on the subject matter of the case. The lists are used for administrative purposes and may also have their own procedures and judges
+- **Official copy**: A copy of an official document, supplied and marked as such by the office which issued the original
+- **Practice form**: Form to be used for a particular purpose in proceedings, the form and purpose being specified by a practice direction
+- **Pre-action protocol**: Statements of best practice about pre-action conduct which have been approved by the Head of Civil Justice and are listed in Practice Direction (Pre-Action Conduct)
+- **Privilege**: The right of a party to refuse to disclose a document or produce a document or to refuse to answer questions on the ground of some special interest recognised by law
+- **Seal**: A seal is a mark which the court puts on a document to indicate that the document has been issued by the court
+- **Service**: Steps required by rules of court to bring documents used in court proceedings to a person's attention
+- **Set aside**: Cancelling a judgment or order or a step taken by a party in the proceedings
+- **Several liability**: (and see 'Joint liability') A person who is severally liable with others may remain liable for the whole claim even where judgment has been obtained against the others
+- **Stay**: A stay imposes a halt on proceedings, apart from taking any steps allowed by the Rules or the terms of the stay. Proceedings can be continued if a stay is lifted
+- **Strike out**: Striking out means the court ordering written material to be deleted so that it may no longer be relied upon
+- **Without prejudice**: Negotiations with a view to a settlement are usually conducted 'without prejudice', which means that the circumstances in which the content of those negotiations may be revealed to the court are very restricted
+
+OUTPUT FORMAT REQUIREMENTS:
+- **SENTENCE-LEVEL ATTRIBUTION**: Each sentence in your response must be directly attributable to content from the search results.
+- **MANDATORY SIMPLE CITATIONS**: Every sentence must end with a simple numbered citation in square brackets [1], [2], [3], etc.
+- **CONTENT FIELD TRACEABILITY**: Each sentence must be traceable to the specific content field in the numbered sources provided.
+- **NO SYNTHESIS**: Do not create sentences by combining information from multiple sources or by paraphrasing.
+- **CONCISE RESPONSES**: Keep responses focused and concise. Extract only the most relevant information from sources.
+
+MANDATORY CITATION REQUIREMENTS:
+- **EVERY SINGLE SENTENCE must end with a simple numbered citation in square brackets [1], [2], [3], etc.**
+- **USE ONLY THE SOURCE NUMBERS**: Reference sources using only the numbers provided at the start of each source (e.g., [1], [2], [3]).
+- **ONE REFERENCE PER CITATION**: Each citation must reference only ONE source number.
+- **NO EXCEPTIONS**: If you cannot cite a sentence, do not include it in your response.
+- **EXACT TEXT MATCHING**: You must copy key phrases word-for-word from the source content.
+- **SUMMARIZE WHEN APPROPRIATE**: Instead of copying entire paragraphs, extract the key points and summarize them while maintaining exact terminology.
+
+CITATION FORMAT EXAMPLES:
+- For referencing the first source: [1]
+- For referencing the second source: [2]
+- For referencing the third source: [3]
+
+**CRITICAL**: Use only the simple numbered format [1], [2], [3] etc. Do NOT create complex citations. The source numbers are provided at the beginning of each source below.
+
+{% if injected_prompt %}
 {{ injected_prompt }}
 {% endif %}
 
 {% if include_follow_up_questions %}
-Generate 3 very brief follow-up questions that the user would likely ask next.
+Generate 3 very brief follow-up questions that the user would likely ask next about legal procedures.
 Enclose the follow-up questions in double angle brackets. Example:
-<<Are there exclusions for prescriptions?>>
-<<Which pharmacies can be ordered from?>>
-<<What is the limit for over-the-counter medication?>>
+<<What are the time limits for disclosure?>>
+<<Can disclosure be limited in fast track cases?>>
+<<What happens if disclosure obligations are not met?>>
 Do not repeat questions that have already been asked.
 Make sure the last question ends with ">>".
 {% endif %}
+{% endif %}
 
+{% if past_messages %}
 {% for message in past_messages %}
 {{ message["role"] }}:
 {{ message["content"] }}
 {% endfor %}
+{% endif %}
 
 user:
 {{ user_query }}
 
 Sources:
-{% for text_source in text_sources %}
-{{ text_source }}
+{% for doc in text_sources %}
+{{ doc }}
+{% endfor %}
+user:
+{{ user_query }}
+
+Sources:
+{% for doc in text_sources %}
+{{ doc }}
+{% endfor %}
+{% for doc in text_sources %}
+{{ doc }}
 {% endfor %}
diff --git a/app/backend/approaches/prompts/chat_query_rewrite.prompty b/app/backend/approaches/prompts/chat_query_rewrite.prompty
index 545b3f5..72c14ef 100644
--- a/app/backend/approaches/prompts/chat_query_rewrite.prompty
+++ b/app/backend/approaches/prompts/chat_query_rewrite.prompty
@@ -5,40 +5,99 @@ model:
     api: chat
     parameters:
         tools: ${file:chat_query_rewrite_tools.json}
+        temperature: 0.3
 sample:
     user_query: Does it include hearing?
     past_messages:
         - role: user
-          content: "What is included in my Northwind Health Plus plan that is not in standard?"
+          content: "What are the time limits for filing a defence?"
         - role: assistant
-          content: "The Northwind Health Plus plan includes coverage for emergency services, mental health and substance abuse coverage, and out-of-network services, which are not included in the Northwind Standard plan. [Benefit_Options.pdf#page=3]"
+          content: "The time limit for filing a defence is 14 days after service of the particulars of claim under CPR Part 15.4, or 28 days if the defendant files an acknowledgment of service. [CPR.15.4, CPR Part 15 (p. 2), Civil Procedure Rules]"
 ---
 system:
-Below is a history of the conversation so far, and a new question asked by the user that needs to be answered by searching in a knowledge base.
-You have access to Azure AI Search index with 100's of documents.
-Generate a search query based on the conversation and the new question.
+You are an AI assistant helping lawyers and legal professionals in England and Wales find relevant information from Civil Procedure Rules (CPR), Practice Directions, and Court Guides.
+
+Your task is to rewrite user questions into effective search queries for legal documents and generate appropriate subsection identifiers for precise citation purposes.
+
+LEGAL TERMINOLOGY REFERENCE:
+When interpreting user queries, consider these standard legal definitions:
+- **Affidavit**: A written, sworn statement of evidence
+- **Alternative dispute resolution**: Collective description of methods of resolving disputes otherwise than through the normal trial process
+- **Base rate**: The interest rate set by the Bank of England which is used as the basis for other banks' rates
+- **Budget**: An estimate of the reasonable and proportionate costs (including disbursements) which a party intends to incur in the proceedings
+- **Contribution**: A right of someone to recover from a third person all or part of the amount which he himself is liable to pay
+- **Counterclaim**: A claim brought by a defendant in response to the claimant's claim, which is included in the same proceedings as the claimant's claim
+- **Cross-examination**: (and see 'Evidence in chief') Questioning of a witness by a party other than the party who called the witness
+- **Damages**: A sum of money awarded by the court as compensation to the claimant
+- **Aggravated damages**: Additional damages which the court may award as compensation for the defendant's objectionable behaviour
+- **Exemplary damages**: Damages which go beyond compensating for actual loss and are awarded to show the court's disapproval of the defendant's behaviour
+- **Damages-based agreement**: A damages-based agreement is an agreement which complies with the provisions of the Damages-Based Agreements Regulations 2013
+- **Defence of tender before claim**: A defence that, before the claimant started proceedings, the defendant unconditionally offered to the claimant the amount due or, if no specified amount is claimed, an amount sufficient to satisfy the claim
+- **Divisional Court**: With or without capital letters, means a divisional court constituted under section 66 of the Senior Courts Act 1981
+- **Evidence in chief**: (and see 'Cross-examination') The evidence given by a witness for the party who called him
+- **Indemnity**: A right of someone to recover from a third party the whole amount which he himself is liable to pay
+- **Injunction**: A court order prohibiting a person from doing something or requiring a person to do something
+- **Joint liability**: (and see 'Several liability') Parties who are jointly liable share a single liability and each party can be held liable for the whole of it
+- **Limitation period**: The period within which a person who has a right to claim against another person must start court proceedings to establish that right. The expiry of the period may be a defence to the claim
+- **List**: Cases are allocated to different lists depending on the subject matter of the case. The lists are used for administrative purposes and may also have their own procedures and judges
+- **Official copy**: A copy of an official document, supplied and marked as such by the office which issued the original
+- **Practice form**: Form to be used for a particular purpose in proceedings, the form and purpose being specified by a practice direction
+- **Pre-action protocol**: Statements of best practice about pre-action conduct which have been approved by the Head of Civil Justice and are listed in Practice Direction (Pre-Action Conduct)
+- **Privilege**: The right of a party to refuse to disclose a document or produce a document or to refuse to answer questions on the ground of some special interest recognised by law
+- **Seal**: A seal is a mark which the court puts on a document to indicate that the document has been issued by the court
+- **Service**: Steps required by rules of court to bring documents used in court proceedings to a person's attention
+- **Set aside**: Cancelling a judgment or order or a step taken by a party in the proceedings
+- **Several liability**: (and see 'Joint liability') A person who is severally liable with others may remain liable for the whole claim even where judgment has been obtained against the others
+- **Stay**: A stay imposes a halt on proceedings, apart from taking any steps allowed by the Rules or the terms of the stay. Proceedings can be continued if a stay is lifted
+- **Strike out**: Striking out means the court ordering written material to be deleted so that it may no longer be relied upon
+- **Without prejudice**: Negotiations with a view to a settlement are usually conducted 'without prejudice', which means that the circumstances in which the content of those negotiations may be revealed to the court are very restricted
+
+For SEARCH QUERIES, focus on:
+- Legal terminology and concepts that appear in official documents
+- Specific rule numbers (e.g., CPR 1.1, Part 36)
+- Practice Direction references
+- Court procedures and deadlines
+- Case management concepts
+- Keywords that will match exact wording in legal texts
+- Include specific court names if mentioned (e.g., "Circuit Commercial Court", "Commercial Court")
+
+IMPORTANT COURT CATEGORY HANDLING:
+- When a specific court is mentioned that represents a category (e.g., "Commercial Court", "Circuit Commercial Court", "Technology and Construction Court"), the search should include:
+  1. Documents specifically categorized under that court
+  2. Documents categorized under "Civil Procedure Rules and Practice Directions"
+- This ensures comprehensive coverage of both court-specific rules AND general procedural rules that apply
+
+For SUBSECTION IDENTIFIERS, generate structured references:
+- For CPR rules: Use format "CPR.X.Y" (e.g., "CPR.31.6" for Part 31 rule 6)
+- For Practice Directions: Use format "PD.X.Y" (e.g., "PD.25A.1")
+- For Court Guide sections: Use format "A.X.Y", "B.X.Y", etc. based on section
+
+Generate queries that will find documents containing precise legal language suitable for exact text highlighting and citation verification.
 Do not include cited source filenames and document names e.g. info.txt or doc.pdf in the search query terms.
 Do not include any text inside [] or <<>> in the search query terms.
 Do not include any special characters like '+'.
 If the question is not in English, translate the question to English before generating the search query.
-If you cannot generate a search query, return just the number 0.
+
+Use the search_sources function to provide both the search query and subsection identifier.
 
 user:
-How did crypto do last year?
+How long do I have to file a defence?
 
-assistant:
-Summarize Cryptocurrency Market Dynamics from last year
+A:
+time limit filing defence acknowledgment service CPR Part 15
 
 user:
-What are my health plans?
+What are the rules for expert witnesses in the Circuit Commercial Court?
 
-assistant:
-Show available health plans
+A:
+expert witness Circuit Commercial Court CPR Part 35 duties court permission
 
+{% if past_messages %}
 {% for message in past_messages %}
 {{ message["role"] }}:
 {{ message["content"] }}
 {% endfor %}
+{% endif %}
 
 user:
-Generate search query for: {{ user_query }}
+{{ user_query }}
diff --git a/app/backend/approaches/prompts/chat_query_rewrite_tools.json b/app/backend/approaches/prompts/chat_query_rewrite_tools.json
index cf17434..cfd6c43 100644
--- a/app/backend/approaches/prompts/chat_query_rewrite_tools.json
+++ b/app/backend/approaches/prompts/chat_query_rewrite_tools.json
@@ -8,10 +8,15 @@
             "properties": {
                 "search_query": {
                     "type": "string",
-                    "description": "Query string to retrieve documents from azure search eg: 'Health care plan'"
+                    "description": "Query string to retrieve documents from azure search eg: 'Part 1, Overriding Objective'"
+                },
+                "subsection_hint": {
+                    "type": "string",
+                    "description": "Specific subsection identifier for precise citation (e.g., '1.1' for rule 1.1, 'A4.1' for court guide section A4.1, 'Para 1.1' for practice direction paragraph 1.1)"
                 }
             },
-            "required": ["search_query"]
+            "required": ["search_query", "subsection_hint"]
         }
     }
 }]
+
diff --git a/app/backend/approaches/retrievethenread.py b/app/backend/approaches/retrievethenread.py
index d59f903..084682d 100644
--- a/app/backend/approaches/retrievethenread.py
+++ b/app/backend/approaches/retrievethenread.py
@@ -1,172 +1,371 @@
-from typing import Any, Optional, cast
+# This file likely contains the retrieve-then-read approach
+
+from typing import Any, Optional, Union
+import re
 
-from azure.search.documents.agent.aio import KnowledgeAgentRetrievalClient
 from azure.search.documents.aio import SearchClient
 from azure.search.documents.models import VectorQuery
+from azure.search.documents.agent.aio import KnowledgeAgentRetrievalClient
 from openai import AsyncOpenAI
-from openai.types.chat import ChatCompletion, ChatCompletionMessageParam
+from openai.types.chat import ChatCompletionMessageParam
 
-from approaches.approach import Approach, DataPoints, ExtraInfo, ThoughtStep
-from approaches.promptmanager import PromptManager
+from approaches.approach import Approach, Document, ExtraInfo, DataPoints, ThoughtStep
 from core.authentication import AuthenticationHelper
 
 
 class RetrieveThenReadApproach(Approach):
     """
-    Simple retrieve-then-read implementation, using the AI Search and OpenAI APIs directly. It first retrieves
-    top documents from search, then constructs a prompt with them, and then uses OpenAI to generate an completion
-    (answer) with that prompt.
+    Simple retrieve-then-read implementation, using the AI Search and OpenAI APIs directly.
     """
 
     def __init__(
         self,
         *,
         search_client: SearchClient,
-        search_index_name: str,
-        agent_model: Optional[str],
-        agent_deployment: Optional[str],
-        agent_client: KnowledgeAgentRetrievalClient,
-        auth_helper: AuthenticationHelper,
         openai_client: AsyncOpenAI,
+        auth_helper: AuthenticationHelper,
         chatgpt_model: str,
-        chatgpt_deployment: Optional[str],  # Not needed for non-Azure OpenAI
+        chatgpt_deployment: Optional[str],
+        embedding_deployment: Optional[str],
         embedding_model: str,
-        embedding_deployment: Optional[str],  # Not needed for non-Azure OpenAI or for retrieval_mode="text"
         embedding_dimensions: int,
         embedding_field: str,
         sourcepage_field: str,
         content_field: str,
-        query_language: str,
-        query_speller: str,
-        prompt_manager: PromptManager,
+        query_language: Optional[str],
+        query_speller: Optional[str],
+        openai_host: str = "azure",
+        vision_endpoint: str = "",
+        vision_token_provider = None,
+        prompt_manager,
         reasoning_effort: Optional[str] = None,
+        # Additional parameters from app.py
+        search_index_name: Optional[str] = None,
+        agent_model: Optional[str] = None,
+        agent_deployment: Optional[str] = None,
+        agent_client: Optional[KnowledgeAgentRetrievalClient] = None,
     ):
-        self.search_client = search_client
-        self.search_index_name = search_index_name
-        self.agent_model = agent_model
-        self.agent_deployment = agent_deployment
-        self.agent_client = agent_client
-        self.chatgpt_deployment = chatgpt_deployment
-        self.openai_client = openai_client
-        self.auth_helper = auth_helper
+        super().__init__(
+            search_client=search_client,
+            openai_client=openai_client,
+            auth_helper=auth_helper,
+            query_language=query_language,
+            query_speller=query_speller,
+            embedding_deployment=embedding_deployment,
+            embedding_model=embedding_model,
+            embedding_dimensions=embedding_dimensions,
+            embedding_field=embedding_field,
+            openai_host=openai_host,
+            vision_endpoint=vision_endpoint,
+            vision_token_provider=vision_token_provider,
+            prompt_manager=prompt_manager,
+            reasoning_effort=reasoning_effort,
+        )
         self.chatgpt_model = chatgpt_model
-        self.embedding_model = embedding_model
-        self.embedding_dimensions = embedding_dimensions
         self.chatgpt_deployment = chatgpt_deployment
-        self.embedding_deployment = embedding_deployment
-        self.embedding_field = embedding_field
         self.sourcepage_field = sourcepage_field
         self.content_field = content_field
-        self.query_language = query_language
-        self.query_speller = query_speller
-        self.prompt_manager = prompt_manager
+        # Store additional parameters
+        self.search_index_name = search_index_name
+        self.agent_model = agent_model
+        self.agent_deployment = agent_deployment
+        self.agent_client = agent_client
+        # Add missing answer_prompt initialization
         self.answer_prompt = self.prompt_manager.load_prompt("ask_answer_question.prompty")
-        self.reasoning_effort = reasoning_effort
-        self.include_token_usage = True
 
-    async def run(
-        self,
-        messages: list[ChatCompletionMessageParam],
-        session_state: Any = None,
-        context: dict[str, Any] = {},
-    ) -> dict[str, Any]:
-        overrides = context.get("overrides", {})
-        auth_claims = context.get("auth_claims", {})
-        use_agentic_retrieval = True if overrides.get("use_agentic_retrieval") else False
-        q = messages[-1]["content"]
-        if not isinstance(q, str):
-            raise ValueError("The most recent message content must be a string.")
+    def detect_court_in_query(self, query: str) -> Optional[str]:
+        """
+        Detect if a specific court is mentioned in the user query.
+        Returns the court name if found, None otherwise.
+        """
+        # Common court patterns to look for
+        court_patterns = [
+            r'\b(?:county\s+court|high\s+court|crown\s+court|magistrates?\s+court|circuit\s+commercial\s+court|commercial\s+court|family\s+court|employment\s+tribunal|court\s+of\s+appeal|supreme\s+court)\b',
+            r'\b(?:CC|HC|QBD|ChD|FD|CCC)\b',  # Common abbreviations
+        ]
+        
+        query_lower = query.lower()
+        for pattern in court_patterns:
+            match = re.search(pattern, query_lower, re.IGNORECASE)
+            if match:
+                return match.group(0)
+        
+        return None
+
+    def normalize_court_to_category(self, court_name: str) -> Optional[str]:
+        """
+        Normalize court name to match category format.
+        Returns the normalized category name if the court should be treated as a category.
+        """
+        if not court_name:
+            return None
+            
+        # Map of court names to their category format
+        court_category_map = {
+            'circuit commercial court': 'Circuit Commercial Court',
+            'commercial court': 'Commercial Court',
+            'high court': 'High Court',
+            'county court': 'County Court',
+            'crown court': 'Crown Court',
+            'magistrates court': 'Magistrates Court',
+            'family court': 'Family Court',
+            'employment tribunal': 'Employment Tribunal',
+            'court of appeal': 'Court of Appeal',
+            'supreme court': 'Supreme Court',
+            'ccc': 'Circuit Commercial Court',
+            'hc': 'High Court',
+            'qbd': "Queen's Bench Division",
+            'chd': 'Chancery Division',
+            'fd': 'Family Division'
+        }
+        
+        court_lower = court_name.lower().strip()
+        return court_category_map.get(court_lower)
 
-        if use_agentic_retrieval:
-            extra_info = await self.run_agentic_retrieval_approach(messages, overrides, auth_claims)
+    async def check_if_court_is_category(self, court_name: str) -> bool:
+        """
+        Check if the detected court name exists as a category in the search index.
+        """
+        if not court_name:
+            return False
+            
+        normalized_court = self.normalize_court_to_category(court_name)
+        if not normalized_court:
+            return False
+            
+        try:
+            # Search for documents with this category
+            filter_query = f"category eq '{normalized_court}'"
+            results = await self.search_client.search(
+                search_text="",
+                filter=filter_query,
+                top=1,
+                select=["category"]
+            )
+            
+            # If we get any results, the court exists as a category
+            async for _ in results:
+                return True
+                
+        except Exception as e:
+            import logging
+            logging.warning(f"Error checking if court is category: {e}")
+            
+        return False
+
+    def build_filter(self, overrides: dict[str, Any], auth_claims: dict[str, Any]) -> Optional[str]:
+        """Build search filter with enhanced court/category detection"""
+        filters = []
+        
+        # First, check if exclude_category is specified
+        exclude_category = overrides.get("exclude_category", None)
+        if exclude_category:
+            filters.append(f"category ne '{exclude_category}'")
+        
+        # Check if include_category is specified
+        include_category = overrides.get("include_category", None)
+        if include_category and include_category != "All":
+            filters.append(f"category eq '{include_category}'")
         else:
-            extra_info = await self.run_search_approach(messages, overrides, auth_claims)
+            # If no specific category is included, check if court is mentioned in the query
+            original_user_query = overrides.get("original_user_query", "")
+            detected_court = self.detect_court_in_query(original_user_query)
+            
+            if detected_court:
+                # Check if this court is actually a category
+                normalized_court = self.normalize_court_to_category(detected_court)
+                if normalized_court:
+                    # Store this for async check later
+                    overrides["detected_court_category"] = normalized_court
+                    # For now, we'll build the filter assuming it is a category
+                    # The actual check will be done in run method
+                    filters.append(f"(category eq '{normalized_court}' or category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+                else:
+                    # Court detected but not a category, use default
+                    filters.append("(category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+            elif not include_category:
+                # No court detected and no category specified, use default
+                filters.append("(category eq 'Civil Procedure Rules and Practice Directions' or category eq null or category eq '')")
+        
+        # Add security filters if needed
+        if overrides.get("use_oid_security_filter"):
+            oid = auth_claims.get("oid")
+            if oid:
+                filters.append(f"oids/any(g:search.in(g, '{oid}'))")
+        
+        if overrides.get("use_groups_security_filter"):
+            groups = auth_claims.get("groups", [])
+            if groups:
+                group_str = ", ".join([f"'{g}'" for g in groups])
+                filters.append(f"groups/any(g:search.in(g, '{group_str}'))")
+        
+        return " and ".join(filters) if filters else None
 
-        # Process results
-        messages = self.prompt_manager.render_prompt(
-            self.answer_prompt,
-            self.get_system_prompt_variables(overrides.get("prompt_template"))
-            | {"user_query": q, "text_sources": extra_info.data_points.text},
-        )
+    def get_sources_content(self, results: list[Document], use_semantic_captions: bool, use_image_citation: bool) -> list[dict[str, Any]]:
+        """Return structured data with full content preserved"""
+        return self.get_sources_content_structured(results, use_semantic_captions, use_image_citation)
 
-        chat_completion = cast(
-            ChatCompletion,
-            await self.create_chat_completion(
-                self.chatgpt_deployment,
-                self.chatgpt_model,
-                messages=messages,
-                overrides=overrides,
-                response_token_limit=self.get_response_token_limit(self.chatgpt_model, 1024),
-            ),
-        )
-        extra_info.thoughts.append(
-            self.format_thought_step_for_chatcompletion(
-                title="Prompt to generate answer",
-                messages=messages,
-                overrides=overrides,
-                model=self.chatgpt_model,
-                deployment=self.chatgpt_deployment,
-                usage=chat_completion.usage,
-            )
-        )
-        return {
-            "message": {
-                "content": chat_completion.choices[0].message.content,
-                "role": chat_completion.choices[0].message.role,
-            },
-            "context": extra_info,
-            "session_state": session_state,
-        }
+    def get_sources_content_structured(self, results: list[Document], use_semantic_captions: bool, use_image_citation: bool) -> list[dict[str, Any]]:
+        """Return structured data with all fields preserved including full content and updated field"""
+        structured_results = []
+        for doc in results:
+            # Create structured object with all available fields, ensuring no None values
+            result_obj = {
+                "id": str(doc.id) if doc.id is not None else "",
+                "content": str(doc.content) if doc.content is not None else "",  # Full content preserved, no truncation
+                "sourcepage": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                "sourcefile": str(doc.sourcefile) if doc.sourcefile is not None else "",
+                "category": str(doc.category) if doc.category is not None else "",
+                "storageUrl": str(doc.storage_url) if doc.storage_url is not None else "",
+                "oids": doc.oids if doc.oids is not None else [],
+                "groups": doc.groups if doc.groups is not None else [],
+                "score": float(doc.score) if doc.score is not None else 0.0,
+                "reranker_score": float(doc.reranker_score) if doc.reranker_score is not None else 0.0,
+                "updated": str(doc.updated) if doc.updated is not None else "",  # Include updated field
+                # Add citation information for frontend compatibility
+                "citation": self.get_citation_from_document(doc),
+                "filepath": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                "url": str(doc.storage_url) if doc.storage_url is not None else "",
+            }
 
-    async def run_search_approach(
-        self, messages: list[ChatCompletionMessageParam], overrides: dict[str, Any], auth_claims: dict[str, Any]
-    ):
-        use_text_search = overrides.get("retrieval_mode") in ["text", "hybrid", None]
-        use_vector_search = overrides.get("retrieval_mode") in ["vectors", "hybrid", None]
-        use_semantic_ranker = True if overrides.get("semantic_ranker") else False
-        use_query_rewriting = True if overrides.get("query_rewriting") else False
-        use_semantic_captions = True if overrides.get("semantic_captions") else False
-        top = overrides.get("top", 3)
-        minimum_search_score = overrides.get("minimum_search_score", 0.0)
-        minimum_reranker_score = overrides.get("minimum_reranker_score", 0.0)
-        filter = self.build_filter(overrides, auth_claims)
-        q = str(messages[-1]["content"])
+            # Add captions as supplementary information if using semantic captions
+            if use_semantic_captions and doc.captions:
+                result_obj["captions"] = [
+                    {
+                        "text": str(caption.text) if caption.text is not None else "",
+                        "highlights": str(caption.highlights) if caption.highlights is not None else "",
+                        "additional_properties": caption.additional_properties if caption.additional_properties is not None else {},
+                    }
+                    for caption in doc.captions
+                ]
+                # Store caption summary separately - don't replace content
+                caption_texts = [str(c.text) for c in doc.captions if c.text is not None]
+                if caption_texts:
+                    result_obj["caption_summary"] = " . ".join(caption_texts)
 
-        # If retrieval mode includes vectors, compute an embedding for the query
-        vectors: list[VectorQuery] = []
-        if use_vector_search:
-            vectors.append(await self.compute_text_embedding(q))
+            structured_results.append(result_obj)
 
-        results = await self.search(
-            top,
-            q,
-            filter,
-            vectors,
-            use_text_search,
-            use_vector_search,
-            use_semantic_ranker,
-            use_semantic_captions,
-            minimum_search_score,
-            minimum_reranker_score,
-            use_query_rewriting,
-        )
+        return structured_results
 
-        text_sources = self.get_sources_content(results, use_semantic_captions, use_image_citation=False)
+    def get_citation_from_document(self, doc: Document) -> str:
+        """Get citation string from document object"""
+        if doc.storage_url:
+            return doc.storage_url
+            
+        sourcepage = doc.sourcepage or ""
+        sourcefile = doc.sourcefile or ""
+        
+        if sourcepage and sourcefile:
+            return f"{sourcepage}, {sourcefile}"
+        elif sourcepage:
+            return sourcepage
+        elif sourcefile:
+            return sourcefile
+        else:
+            return "Unknown source"
 
-        return ExtraInfo(
-            DataPoints(text=text_sources),
+    async def run(self, messages: list[ChatCompletionMessageParam], session_state: Any = None, context: dict[str, Any] = {}) -> dict[str, Any]:
+        """Implementation for retrieve-then-read"""
+        auth_claims = context.get("auth_claims", {})
+        overrides = context.get("overrides", {})
+        
+        # Perform search
+        top = overrides.get("top", 3)
+        query_text = str(messages[-1]["content"]) if messages else ""
+        
+        # Store the original query in overrides for the filter building
+        overrides["original_user_query"] = query_text
+        
+        # Build filter with enhanced category logic
+        filter = self.build_filter(overrides, auth_claims)
+        
+        # Check if we need to verify court-as-category
+        if overrides.get("detected_court_category"):
+            court_category = overrides["detected_court_category"]
+            is_category = await self.check_if_court_is_category(court_category)
+            
+            if not is_category:
+                # Court is not a category, rebuild filter with default
+                import logging
+                logging.info(f"Court '{court_category}' is not a category, using default filter")
+                overrides.pop("detected_court_category", None)
+                filter = self.build_filter(overrides, auth_claims)
+        
+        use_text_search = overrides.get("retrieval_mode") in ["text", "hybrid", None]
+        use_vector_search = overrides.get("retrieval_mode") in ["vectors", "hybrid", None]
+        use_semantic_ranker = overrides.get("semantic_ranker", False)
+        use_semantic_captions = overrides.get("semantic_captions", False)
+        
+        vectors = []
+        if use_vector_search and query_text:
+            vectors.append(await self.compute_text_embedding(query_text))
+        
+        # Log the search parameters for debugging
+        import logging
+        logging.info(f"Ask Question - Searching with query: {query_text}, top: {top}, filter: {filter}")
+        logging.info(f"Ask Question - Detected court in query: {self.detect_court_in_query(query_text)}")
+        
+        results = await self.search(
+            top=top,
+            query_text=query_text,
+            filter=filter,
+            vectors=vectors,
+            use_text_search=use_text_search,
+            use_vector_search=use_vector_search,
+            use_semantic_ranker=use_semantic_ranker,
+            use_semantic_captions=use_semantic_captions,
+            minimum_search_score=overrides.get("minimum_search_score", 0.0),
+            minimum_reranker_score=overrides.get("minimum_reranker_score", 0.0),
+        )
+        
+        # Log the search results for debugging
+        logging.info(f"Ask Question - Search returned {len(results)} results")
+        for i, result in enumerate(results[:3]):  # Log first 3 results
+            content_preview = result.content[:200] if result.content else "No content"
+            logging.info(f"Ask Question - Result {i}: id={result.id}, content_length={len(result.content or '')}, preview={content_preview}")
+        
+        # Get structured sources with all fields including updated and storageUrl
+        sources = self.get_sources_content_structured(results, use_semantic_captions, use_image_citation=False)
+        
+        # Ensure all required fields are properly set
+        for source in sources:
+            if isinstance(source, dict):
+                # Map fields from search result to ensure completeness
+                result_idx = sources.index(source)
+                if result_idx < len(results):
+                    search_result = results[result_idx]
+                    source["sourcepage"] = getattr(search_result, "sourcepage", source.get("sourcepage", ""))
+                    source["sourcefile"] = getattr(search_result, "sourcefile", source.get("sourcefile", ""))
+                    source["category"] = getattr(search_result, "category", source.get("category", ""))
+                    source["updated"] = getattr(search_result, "updated", source.get("updated", ""))
+                    source["storageUrl"] = getattr(search_result, "storage_url", source.get("storageUrl", ""))
+                    source["url"] = source.get("storageUrl", "")
+        
+        # Format sources for prompt with citation format similar to chat approach
+        sources_for_prompt = []
+        for source in sources:
+            sourcepage = source.get("sourcepage", "")
+            sourcefile = source.get("sourcefile", "")
+            content = source.get("content", "")
+            
+            # Format source with clear citation format for the prompt
+            formatted_source = f"[{sourcepage}, {sourcefile}]: {content}"
+            sources_for_prompt.append(formatted_source)
+        
+        extra_info = ExtraInfo(
+            DataPoints(text=sources),  # Pass structured data to frontend for proper citation handling
             thoughts=[
                 ThoughtStep(
                     "Search using user query",
-                    q,
+                    query_text,
                     {
                         "use_semantic_captions": use_semantic_captions,
                         "use_semantic_ranker": use_semantic_ranker,
-                        "use_query_rewriting": use_query_rewriting,
                         "top": top,
                         "filter": filter,
                         "use_vector_search": use_vector_search,
                         "use_text_search": use_text_search,
+                        "detected_court": self.detect_court_in_query(query_text),
                     },
                 ),
                 ThoughtStep(
@@ -176,6 +375,33 @@ class RetrieveThenReadApproach(Approach):
             ],
         )
 
+        q = query_text
+        seed = overrides.get("seed", None)
+        
+        messages = self.prompt_manager.render_prompt(
+            self.answer_prompt,
+            self.get_system_prompt_variables(overrides.get("prompt_template"))
+            | {"user_query": q, "text_sources": sources_for_prompt},  # Use formatted sources for prompt
+        )
+
+        chat_completion = await self.openai_client.chat.completions.create(
+            model=self.chatgpt_deployment if self.chatgpt_deployment else self.chatgpt_model,
+            messages=messages,
+            temperature=overrides.get("temperature", 0.3),
+            max_tokens=8192,  # Increased from 1024 to accommodate full content
+            n=1,
+            seed=seed,
+        )
+
+        return {
+            "message": {
+                "content": chat_completion.choices[0].message.content,
+                "role": chat_completion.choices[0].message.role,
+            },
+            "context": extra_info,
+            "session_state": session_state,
+        }
+
     async def run_agentic_retrieval_approach(
         self,
         messages: list[ChatCompletionMessageParam],
@@ -230,3 +456,66 @@ class RetrieveThenReadApproach(Approach):
             ],
         )
         return extra_info
+
+    def get_citation_from_document_dict(self, doc_dict: dict[str, Any]) -> str:
+        """Get citation string from document dict"""
+        if doc_dict.get("storageUrl"):
+            return doc_dict["storageUrl"]
+            
+        sourcepage = doc_dict.get("sourcepage", "")
+        sourcefile = doc_dict.get("sourcefile", "")
+        
+        if sourcepage and sourcefile:
+            return f"{sourcepage}, {sourcefile}"
+        elif sourcepage:
+            return sourcepage
+        elif sourcefile:
+            return sourcefile
+        else:
+            return "Unknown source"
+
+    def get_sources_content(self, results: list[Document], use_semantic_captions: bool, use_image_citation: bool) -> list[dict[str, Any]]:
+        """Return structured data for consistent processing with full content preserved"""
+        structured_results = []
+        for doc in results:
+            # Create structured object with all available fields, ensuring no None values
+            result_obj = {
+                "id": str(doc.id) if doc.id is not None else "",
+                "content": str(doc.content) if doc.content is not None else "",  # Full content, no truncation
+                "sourcepage": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                "sourcefile": str(doc.sourcefile) if doc.sourcefile is not None else "",
+                "category": str(doc.category) if doc.category is not None else "",
+                "storageUrl": str(doc.storage_url) if doc.storage_url is not None else "",
+                "oids": doc.oids if doc.oids is not None else [],
+                "groups": doc.groups if doc.groups is not None else [],
+                "score": doc.score if doc.score is not None else 0.0,
+                "reranker_score": doc.reranker_score if doc.reranker_score is not None else 0.0,
+                "updated": str(doc.updated) if doc.updated is not None else "",
+                # Add citation information for frontend compatibility
+                "citation": self.get_citation_from_document(doc),
+                "filepath": str(doc.sourcepage) if doc.sourcepage is not None else "",
+                "url": str(doc.storage_url) if doc.storage_url is not None else "",
+            }
+
+            # Add captions as supplementary information if using semantic captions
+            if use_semantic_captions and doc.captions:
+                result_obj["captions"] = [
+                    {
+                        "text": str(caption.text) if caption.text is not None else "",
+                        "highlights": caption.highlights if caption.highlights is not None else "",
+                        "additional_properties": caption.additional_properties if caption.additional_properties is not None else {},
+                    }
+                    for caption in doc.captions
+                ]
+                # Store caption summary separately - don't replace content
+                caption_texts = [str(c.text) for c in doc.captions if c.text is not None]
+                if caption_texts:
+                    result_obj["caption_summary"] = " . ".join(caption_texts)
+
+            structured_results.append(result_obj)
+
+        return structured_results
+
+    def nonewlines(self, text: str) -> str:
+        """Utility function to remove newlines from text"""
+        return text.replace("\n", " ").replace("\r", " ")
diff --git a/app/backend/prepdocs.py b/app/backend/prepdocs.py
index db2131a..5426d96 100644
--- a/app/backend/prepdocs.py
+++ b/app/backend/prepdocs.py
@@ -129,7 +129,7 @@ def setup_list_file_strategy(
             data_lake_storage_account=datalake_storage_account,
             data_lake_filesystem=datalake_filesystem,
             data_lake_path=datalake_path,
-            credential=adls_gen2_creds,
+            credential=adls_gen2_creeds,
         )
     elif local_files:
         logger.info("Using local files: %s", local_files)
@@ -431,7 +431,7 @@ if __name__ == "__main__":
     elif not openai_host.startswith("azure") and os.getenv("OPENAI_API_KEY"):
         openai_key = os.getenv("OPENAI_API_KEY")
 
-    openai_dimensions = 1536
+    openai_dimensions = 3072  # Updated default to match text-embedding-3-large
     if os.getenv("AZURE_OPENAI_EMB_DIMENSIONS"):
         openai_dimensions = int(os.environ["AZURE_OPENAI_EMB_DIMENSIONS"])
     openai_embeddings_service = setup_embeddings_service(
diff --git a/app/frontend/package-lock.json b/app/frontend/package-lock.json
index 79eee87..b202101 100644
--- a/app/frontend/package-lock.json
+++ b/app/frontend/package-lock.json
@@ -62,31 +62,28 @@
       }
     },
     "node_modules/@azure/msal-browser": {
-      "version": "4.16.0",
-      "resolved": "https://registry.npmjs.org/@azure/msal-browser/-/msal-browser-4.16.0.tgz",
-      "integrity": "sha512-yF8gqyq7tVnYftnrWaNaxWpqhGQXoXpDfwBtL7UCGlIbDMQ1PUJF/T2xCL6NyDNHoO70qp1xU8GjjYTyNIefkw==",
-      "license": "MIT",
+      "version": "3.27.0",
+      "resolved": "https://registry.npmjs.org/@azure/msal-browser/-/msal-browser-3.27.0.tgz",
+      "integrity": "sha512-+b4ZKSD8+vslCtVRVetkegEhOFMLP3rxDWJY212ct+2r6jVg6OSQKc1Qz3kCoXo0FgwaXkb+76TMZfpHp8QtgA==",
       "dependencies": {
-        "@azure/msal-common": "15.9.0"
+        "@azure/msal-common": "14.16.0"
       },
       "engines": {
         "node": ">=0.8.0"
       }
     },
     "node_modules/@azure/msal-common": {
-      "version": "15.9.0",
-      "resolved": "https://registry.npmjs.org/@azure/msal-common/-/msal-common-15.9.0.tgz",
-      "integrity": "sha512-lbz/D+C9ixUG3hiZzBLjU79a0+5ZXCorjel3mwXluisKNH0/rOS/ajm8yi4yI9RP5Uc70CAcs9Ipd0051Oh/kA==",
-      "license": "MIT",
+      "version": "14.16.0",
+      "resolved": "https://registry.npmjs.org/@azure/msal-common/-/msal-common-14.16.0.tgz",
+      "integrity": "sha512-1KOZj9IpcDSwpNiQNjt0jDYZpQvNZay7QAEi/5DLubay40iGYtLzya/jbjRPLyOTZhEKyL1MzPuw2HqBCjceYA==",
       "engines": {
         "node": ">=0.8.0"
       }
     },
     "node_modules/@azure/msal-react": {
-      "version": "3.0.16",
-      "resolved": "https://registry.npmjs.org/@azure/msal-react/-/msal-react-3.0.16.tgz",
-      "integrity": "sha512-fIFc3z9UrHoOCG4rApNWMRr83DnQlo+CHfLSPNBQa4rndIkr+XYBpdYDqlzqtmikRf3A+CYNVOQ+lQX6jM0zdw==",
-      "license": "MIT",
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/@azure/msal-react/-/msal-react-2.2.0.tgz",
+      "integrity": "sha512-2V+9JXeXyyjYNF92y5u0tU4el9px/V1+vkRuN+DtoxyiMHCtYQpJoaFdGWArh43zhz5aqQqiGW/iajPDSu3QsQ==",
       "engines": {
         "node": ">=10"
       },
@@ -330,13 +327,10 @@
       }
     },
     "node_modules/@babel/runtime": {
-      "version": "7.27.0",
-      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.27.0.tgz",
-      "integrity": "sha512-VtPOkrdPHZsKc/clNqyi9WUA8TINkZ4cGk63UUE3u4pmB2k+ZMQRDuIOagv8UVd6j7k0T3+RRIb7beKTebNbcw==",
+      "version": "7.28.2",
+      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.2.tgz",
+      "integrity": "sha512-KHp2IflsnGywDjBWDkR9iEqiWSpc8GIi0lgTT3mOElT0PP1tG26P4tmFI2YvAdzgq9RGyoHZQEIEdZy6Ec5xCA==",
       "license": "MIT",
-      "dependencies": {
-        "regenerator-runtime": "^0.14.0"
-      },
       "engines": {
         "node": ">=6.9.0"
       }
@@ -389,6 +383,15 @@
         "node": ">=6.9.0"
       }
     },
+    "node_modules/@ctrl/tinycolor": {
+      "version": "3.6.1",
+      "resolved": "https://registry.npmjs.org/@ctrl/tinycolor/-/tinycolor-3.6.1.tgz",
+      "integrity": "sha512-SITSV6aIXsuVNV3f3O0f2n/cgyEDWoSqtZMYiAmcsYHydcKrOz3gUxB/iXd/Qf08+IZX4KpgNbvUdMBmWz+kcA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      }
+    },
     "node_modules/@emotion/hash": {
       "version": "0.9.2",
       "resolved": "https://registry.npmjs.org/@emotion/hash/-/hash-0.9.2.tgz",
@@ -787,11 +790,12 @@
       }
     },
     "node_modules/@floating-ui/core": {
-      "version": "1.6.8",
-      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.6.8.tgz",
-      "integrity": "sha512-7XJ9cPU+yI2QeLS+FCSlqNFZJq8arvswefkZrYI1yQBbftw6FyrZOxYSh+9S7z7TpeWlRt9zJ5IhM1WIL334jA==",
+      "version": "1.7.3",
+      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.7.3.tgz",
+      "integrity": "sha512-sGnvb5dmrJaKEZ+LDIpguvdX3bDlEllmv4/ClQ9awcmCZrlx5jQyyMWFM5kBI+EyNOCDDiKk8il0zeuX3Zlg/w==",
+      "license": "MIT",
       "dependencies": {
-        "@floating-ui/utils": "^0.2.8"
+        "@floating-ui/utils": "^0.2.10"
       }
     },
     "node_modules/@floating-ui/devtools": {
@@ -803,53 +807,63 @@
       }
     },
     "node_modules/@floating-ui/dom": {
-      "version": "1.6.12",
-      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.6.12.tgz",
-      "integrity": "sha512-NP83c0HjokcGVEMeoStg317VD9W7eDlGK7457dMBANbKA6GJZdc7rjujdgqzTaz93jkGgc5P/jeWbaCHnMNc+w==",
+      "version": "1.7.3",
+      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.7.3.tgz",
+      "integrity": "sha512-uZA413QEpNuhtb3/iIKoYMSK07keHPYeXF02Zhd6e213j+d1NamLix/mCLxBUDW/Gx52sPH2m+chlUsyaBs/Ag==",
+      "license": "MIT",
       "dependencies": {
-        "@floating-ui/core": "^1.6.0",
-        "@floating-ui/utils": "^0.2.8"
+        "@floating-ui/core": "^1.7.3",
+        "@floating-ui/utils": "^0.2.10"
       }
     },
     "node_modules/@floating-ui/utils": {
-      "version": "0.2.8",
-      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.8.tgz",
-      "integrity": "sha512-kym7SodPp8/wloecOpcmSnWJsK7M0E5Wg8UcFA+uO4B9s5d0ywXOEro/8HM9x0rW+TljRzul/14UYz3TleT3ig=="
+      "version": "0.2.10",
+      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.10.tgz",
+      "integrity": "sha512-aGTxbpbg8/b5JfU1HXSrbH3wXZuLPJcNEcZQFMxLs3oSzgtVu6nFPkbbGGUvBcUjKV2YyB9Wxxabo+HEH9tcRQ==",
+      "license": "MIT"
     },
     "node_modules/@fluentui/date-time-utilities": {
-      "version": "8.5.14",
+      "version": "8.6.10",
+      "resolved": "https://registry.npmjs.org/@fluentui/date-time-utilities/-/date-time-utilities-8.6.10.tgz",
+      "integrity": "sha512-Bxq8DIMkFvkpCA1HKtCHdnFwPAnXLz3TkGp9kpi2T6VIv6VtLVSxRn95mbsUydpP9Up/DLglp/z9re5YFBGNbw==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/set-version": "^8.2.12",
+        "@fluentui/set-version": "^8.2.24",
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/dom-utilities": {
-      "version": "2.2.12",
+      "version": "2.3.10",
+      "resolved": "https://registry.npmjs.org/@fluentui/dom-utilities/-/dom-utilities-2.3.10.tgz",
+      "integrity": "sha512-6WDImiLqTOpkEtfUKSStcTDpzmJfL6ZammomcjawN9xH/8u8G3Hx72CIt2MNck9giw/oUlNLJFdWRAjeP3rmPQ==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/set-version": "^8.2.12",
+        "@fluentui/set-version": "^8.2.24",
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/font-icons-mdl2": {
-      "version": "8.5.26",
+      "version": "8.5.62",
+      "resolved": "https://registry.npmjs.org/@fluentui/font-icons-mdl2/-/font-icons-mdl2-8.5.62.tgz",
+      "integrity": "sha512-8yIJ1RlOJIXNS+Ac3dKL8LucFlnAPK3jbzYWRNq7rg1pVSdbtCmFCz1eEAgLxVdAfjx1/9Bei/yQr5Fv7WwV5Q==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/style-utilities": "^8.9.19",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/style-utilities": "^8.12.2",
+        "@fluentui/utilities": "^8.15.22",
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/foundation-legacy": {
-      "version": "8.2.46",
+      "version": "8.4.29",
+      "resolved": "https://registry.npmjs.org/@fluentui/foundation-legacy/-/foundation-legacy-8.4.29.tgz",
+      "integrity": "sha512-fSoYEdwk9VBEOPMtHMZ5xsCNCAH+lz104T6oHu9Fpf2VzdFE9ZqnjK3rQNV7xFZcjZtLaH2WUTEGUfpEYlcdDw==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/style-utilities": "^8.9.19",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/style-utilities": "^8.12.2",
+        "@fluentui/utilities": "^8.15.22",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -858,7 +872,9 @@
       }
     },
     "node_modules/@fluentui/keyboard-key": {
-      "version": "0.4.12",
+      "version": "0.4.23",
+      "resolved": "https://registry.npmjs.org/@fluentui/keyboard-key/-/keyboard-key-0.4.23.tgz",
+      "integrity": "sha512-9GXeyUqNJUdg5JiQUZeGPiKnRzMRi9YEUn1l9zq6X/imYdMhxHrxpVZS12129cBfgvPyxt9ceJpywSfmLWqlKA==",
       "license": "MIT",
       "dependencies": {
         "tslib": "^2.1.0"
@@ -868,42 +884,48 @@
       "version": "9.0.8",
       "resolved": "https://registry.npmjs.org/@fluentui/keyboard-keys/-/keyboard-keys-9.0.8.tgz",
       "integrity": "sha512-iUSJUUHAyTosnXK8O2Ilbfxma+ZyZPMua5vB028Ys96z80v+LFwntoehlFsdH3rMuPsA8GaC1RE7LMezwPBPdw==",
+      "license": "MIT",
       "dependencies": {
         "@swc/helpers": "^0.5.1"
       }
     },
     "node_modules/@fluentui/merge-styles": {
-      "version": "8.5.13",
+      "version": "8.6.14",
+      "resolved": "https://registry.npmjs.org/@fluentui/merge-styles/-/merge-styles-8.6.14.tgz",
+      "integrity": "sha512-vghuHFAfQgS9WLIIs4kgDOCh/DHd5vGIddP4/bzposhlAVLZR6wUBqldm9AuCdY88r5LyCRMavVJLV+Up3xdvA==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/set-version": "^8.2.12",
+        "@fluentui/set-version": "^8.2.24",
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/priority-overflow": {
-      "version": "9.1.14",
-      "resolved": "https://registry.npmjs.org/@fluentui/priority-overflow/-/priority-overflow-9.1.14.tgz",
-      "integrity": "sha512-tIH8EhvjZF4MhxSjqrWOyodrQQW+RlVZqxuNFQF5OWRdSqcIK8g+Z+UbC5fYHQooCgVsthk2mFurfGMKFtf9ug==",
+      "version": "9.1.15",
+      "resolved": "https://registry.npmjs.org/@fluentui/priority-overflow/-/priority-overflow-9.1.15.tgz",
+      "integrity": "sha512-/3jPBBq64hRdA416grVj+ZeMBUIaKZk2S5HiRg7CKCAV1JuyF84Do0rQI6ns8Vb9XOGuc4kurMcL/UEftoEVrg==",
+      "license": "MIT",
       "dependencies": {
         "@swc/helpers": "^0.5.1"
       }
     },
     "node_modules/@fluentui/react": {
-      "version": "8.112.5",
-      "license": "MIT",
-      "dependencies": {
-        "@fluentui/date-time-utilities": "^8.5.14",
-        "@fluentui/font-icons-mdl2": "^8.5.26",
-        "@fluentui/foundation-legacy": "^8.2.46",
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/react-focus": "^8.8.33",
-        "@fluentui/react-hooks": "^8.6.32",
-        "@fluentui/react-portal-compat-context": "^9.0.9",
-        "@fluentui/react-window-provider": "^2.2.16",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/style-utilities": "^8.9.19",
-        "@fluentui/theme": "^2.6.37",
-        "@fluentui/utilities": "^8.13.20",
+      "version": "8.123.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react/-/react-8.123.4.tgz",
+      "integrity": "sha512-5YmEfvq4U+SwcXiva1ahYMqJGZl0Nj9zn3Y5+/dIjl3otReO9mHGnnqhuDFI942KlRbp4ABucOBon4KI9NDOPw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/date-time-utilities": "^8.6.10",
+        "@fluentui/font-icons-mdl2": "^8.5.62",
+        "@fluentui/foundation-legacy": "^8.4.29",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/react-focus": "^8.9.25",
+        "@fluentui/react-hooks": "^8.8.19",
+        "@fluentui/react-portal-compat-context": "^9.0.13",
+        "@fluentui/react-window-provider": "^2.2.30",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/style-utilities": "^8.12.2",
+        "@fluentui/theme": "^2.6.67",
+        "@fluentui/utilities": "^8.15.22",
         "@microsoft/load-themed-styles": "^1.10.26",
         "tslib": "^2.1.0"
       },
@@ -915,20 +937,21 @@
       }
     },
     "node_modules/@fluentui/react-accordion": {
-      "version": "9.5.8",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-accordion/-/react-accordion-9.5.8.tgz",
-      "integrity": "sha512-tYkHFbNfJG1/qSzkdagSGZoL9LlRp1/ei0TwezDq9M41rGZWHz+qDRkPlw/f66YWT006tR1zR1voJYhshsJ21g==",
+      "version": "9.8.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-accordion/-/react-accordion-9.8.4.tgz",
+      "integrity": "sha512-VLWQgnH651e+3qfajoagsIYu4LoznP+5LtEXakgKUUDWnNMxM/PVg2/zuBNjm1o8p6lW4jkXAOgCsFzF/Wl/Hg==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-motion-components-preview": "^0.3.0",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-motion-components-preview": "^0.8.2",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -963,15 +986,16 @@
       }
     },
     "node_modules/@fluentui/react-aria": {
-      "version": "9.13.9",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-aria/-/react-aria-9.13.9.tgz",
-      "integrity": "sha512-YURuZ2Nh7hz5VlCQ9NHLvzyqdiJhElm4aW/F4JRmXAoMdeDCfgG0UGL82DDPZL6eNYIjhQN8WpRXH2tfxJ80HA==",
+      "version": "9.16.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-aria/-/react-aria-9.16.3.tgz",
+      "integrity": "sha512-M5jHqcedz6+iJwNFYVXBbqHJdCAjBwdb6G1sNLaTbanO/AC5igl0t9v0QXcA/vP9+D0L0tTOLiSjW5SyJuzzAQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-utilities": "^9.23.2",
         "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
@@ -982,20 +1006,21 @@
       }
     },
     "node_modules/@fluentui/react-avatar": {
-      "version": "9.6.43",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-avatar/-/react-avatar-9.6.43.tgz",
-      "integrity": "sha512-N/bHM7ZriCrUupZ0jgK+cUHuOymIvs3JMxME6z/6711xwHH9PRM0vpu17O+oYsnwatELDaGsN5MWV4T6x1UDVA==",
+      "version": "9.9.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-avatar/-/react-avatar-9.9.4.tgz",
+      "integrity": "sha512-QUUpCtJ86dQuZ5XScjxxb0+K6rPhkNm0H73f+art2+Yjyrfj637rxbKTEt+Gg8JvPAG9y3uECJTrekBW29FHyw==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-badge": "^9.2.45",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-badge": "^9.4.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-popover": "^9.9.25",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-tooltip": "^9.4.43",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-popover": "^9.12.4",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-tooltip": "^9.8.3",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1007,15 +1032,16 @@
       }
     },
     "node_modules/@fluentui/react-badge": {
-      "version": "9.2.45",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-badge/-/react-badge-9.2.45.tgz",
-      "integrity": "sha512-X1dDCs0ZjQNx46VUAWYVvVfufARNtOQoXmcdldtd8kWnLDA4aAVI+/CX4bhZ/+qV9hiIowffuW/QPhNXWSozVQ==",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-badge/-/react-badge-9.4.3.tgz",
+      "integrity": "sha512-c5sgFcyN4+VxTkXKQSezYCYUasqB1fKYAmpOL3uDowm5CyUcysx/0WO24u18AttcdmRsKrAuQBWi6eEaRYXIxg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1027,19 +1053,20 @@
       }
     },
     "node_modules/@fluentui/react-breadcrumb": {
-      "version": "9.0.43",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-breadcrumb/-/react-breadcrumb-9.0.43.tgz",
-      "integrity": "sha512-kVve9azEzJn/6aZU1Hv2KVd3INkoSbX5kbIVUzDdsMZYeFpYp0V9Fz/akwa9jhSkONdqCpKpI/BbT8wRjWky9g==",
+      "version": "9.3.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-breadcrumb/-/react-breadcrumb-9.3.4.tgz",
+      "integrity": "sha512-ND1F+5LSVT6gfeUN4q0SooCWFq9IBVUdfLDrsdIU3KHyW/cQC7W/maabw/jqUSEfBl+SkGs+G3UkeaPJIdu9Ig==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-button": "^9.3.95",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-button": "^9.6.4",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-link": "^9.3.2",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-link": "^9.6.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1051,18 +1078,19 @@
       }
     },
     "node_modules/@fluentui/react-button": {
-      "version": "9.3.95",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-button/-/react-button-9.3.95.tgz",
-      "integrity": "sha512-kvwxBrCLXeFkgVy1+n01BZmRnEE/uPtapkUSInIXf8qQgOZzpLirLfrDqjBsTMd1Wosv9zgh27gqbiw92cqQSg==",
+      "version": "9.6.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-button/-/react-button-9.6.4.tgz",
+      "integrity": "sha512-IbRBmGFdo3MKiVMoreOR2YJSjvrKBbRJpmfjNxQQufjE4Q9ouhli7fpX/1SPKbEgnS1EvKnmwxy/6HUNp6srSQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
+        "@fluentui/react-aria": "^9.16.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1074,16 +1102,18 @@
       }
     },
     "node_modules/@fluentui/react-card": {
-      "version": "9.0.97",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-card/-/react-card-9.0.97.tgz",
-      "integrity": "sha512-E8Rjkn88muKdn3ACn+WzpTsQYX/ldgZvuRT42PTdrIXeFsQ9RAWJ6TkMf5/FURxKlR29ChT5kIyCH/EzZ+iB0g==",
+      "version": "9.4.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-card/-/react-card-9.4.4.tgz",
+      "integrity": "sha512-qwbxyvYIV30Hmrs4eyCfdHDhdpL0EQhDPXPLH7C3Ad/PNI1E8u4P4Wzu3eiRJqESXqzZKVlxko9ngZHHpy/mpg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-text": "^9.4.27",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-text": "^9.6.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1095,24 +1125,26 @@
       }
     },
     "node_modules/@fluentui/react-carousel": {
-      "version": "9.3.1",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-carousel/-/react-carousel-9.3.1.tgz",
-      "integrity": "sha512-nDUOVPAADNRlwg7/KtXgYEgALfll/Zcx7MAIqZkwxtroPzuOqm2CjeMVBwWoekEQzs75i+PgNgL1eXAQwgsAAQ==",
+      "version": "9.8.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-carousel/-/react-carousel-9.8.4.tgz",
+      "integrity": "sha512-6Qi0M42ceqodOJUMfqZmwJZBeHlA93SDIwC7b7Wqprrgl77KMa4j0d+Iy7kF1p/DtW/TK19RjshWYpd77OWOUg==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-button": "^9.3.95",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-tooltip": "^9.8.3",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1",
-        "embla-carousel": "^8.3.0",
-        "embla-carousel-autoplay": "^8.3.0",
-        "embla-carousel-fade": "^8.3.0"
+        "embla-carousel": "^8.5.1",
+        "embla-carousel-autoplay": "^8.5.1",
+        "embla-carousel-fade": "^8.5.1"
       },
       "peerDependencies": {
         "@types/react": ">=16.14.0 <19.0.0",
@@ -1122,18 +1154,42 @@
       }
     },
     "node_modules/@fluentui/react-checkbox": {
-      "version": "9.2.41",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-checkbox/-/react-checkbox-9.2.41.tgz",
-      "integrity": "sha512-+vmoZIaAnN7Z9pxilXSleQJKyLoGksrU0d00huNLIOKFGIgkJHscJzrmAWDWHzFOg1MeGUtpfYYlE3L1N6ypBw==",
+      "version": "9.5.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-checkbox/-/react-checkbox-9.5.3.tgz",
+      "integrity": "sha512-CrGwo5BuO1JUOY7eKtDP/8P+WwvvVjYUoMvIKb4uBez+Vp5utseSeecGiWVmWk4q7Ao6yDaGkf7Lif0A9BexGw==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
+        "@griffel/react": "^1.5.22",
+        "@swc/helpers": "^0.5.1"
+      },
+      "peerDependencies": {
+        "@types/react": ">=16.14.0 <19.0.0",
+        "@types/react-dom": ">=16.9.0 <19.0.0",
+        "react": ">=16.14.0 <19.0.0",
+        "react-dom": ">=16.14.0 <19.0.0"
+      }
+    },
+    "node_modules/@fluentui/react-color-picker": {
+      "version": "9.2.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-color-picker/-/react-color-picker-9.2.3.tgz",
+      "integrity": "sha512-fEx+xDPlJleQWPd+9u4qcRX4eqUOk8VKxxOm0wIO7r2WrvqUJsPojXJlwyAIMXMcJlIfy6TCaqJ9ZIUMd7NO/Q==",
+      "license": "MIT",
+      "dependencies": {
+        "@ctrl/tinycolor": "^3.3.4",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1145,22 +1201,23 @@
       }
     },
     "node_modules/@fluentui/react-combobox": {
-      "version": "9.13.12",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-combobox/-/react-combobox-9.13.12.tgz",
-      "integrity": "sha512-Y710laYoJHmMu09ynLx+13hwtCLhCGqUbVdLCCQmsMzd4hCVNCuhT+ED+sJBTMp/NnyVjMDECJ11Fk5iTkUd0g==",
+      "version": "9.16.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-combobox/-/react-combobox-9.16.4.tgz",
+      "integrity": "sha512-V+JKfaiAQwgI6N6WgAaKjUI1uyFVJbWFqA754pq+mQ3pxF+0kIEZPyqUauEua4EHgm8/ZRgai1WqLo/lY6uBAQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1172,67 +1229,71 @@
       }
     },
     "node_modules/@fluentui/react-components": {
-      "version": "9.56.2",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-components/-/react-components-9.56.2.tgz",
-      "integrity": "sha512-WcxdvJGPK/xhS9FnmG8QaEM5/Es1Hbggmas5DCkuj2XGEexz4zWZ73tESb7QNYpMxhOKKprln0HfbSpg6c4xOw==",
+      "version": "9.68.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-components/-/react-components-9.68.3.tgz",
+      "integrity": "sha512-baVsbfRTeVxtYTryLgSePmNRUqz+7OUsF5CsgOtZ6n5F0ZQLElTMVuECyZEYrccV8o6XSBCWwUEVMHdoifdyxw==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-accordion": "^9.5.8",
+        "@fluentui/react-accordion": "^9.8.4",
         "@fluentui/react-alert": "9.0.0-beta.124",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-avatar": "^9.6.43",
-        "@fluentui/react-badge": "^9.2.45",
-        "@fluentui/react-breadcrumb": "^9.0.43",
-        "@fluentui/react-button": "^9.3.95",
-        "@fluentui/react-card": "^9.0.97",
-        "@fluentui/react-carousel": "^9.3.1",
-        "@fluentui/react-checkbox": "^9.2.41",
-        "@fluentui/react-combobox": "^9.13.12",
-        "@fluentui/react-dialog": "^9.11.21",
-        "@fluentui/react-divider": "^9.2.77",
-        "@fluentui/react-drawer": "^9.6.1",
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-image": "^9.1.75",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-avatar": "^9.9.4",
+        "@fluentui/react-badge": "^9.4.3",
+        "@fluentui/react-breadcrumb": "^9.3.4",
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-card": "^9.4.4",
+        "@fluentui/react-carousel": "^9.8.4",
+        "@fluentui/react-checkbox": "^9.5.3",
+        "@fluentui/react-color-picker": "^9.2.3",
+        "@fluentui/react-combobox": "^9.16.4",
+        "@fluentui/react-dialog": "^9.14.4",
+        "@fluentui/react-divider": "^9.4.3",
+        "@fluentui/react-drawer": "^9.9.4",
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-image": "^9.3.3",
         "@fluentui/react-infobutton": "9.0.0-beta.102",
-        "@fluentui/react-infolabel": "^9.0.50",
-        "@fluentui/react-input": "^9.4.93",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-link": "^9.3.2",
-        "@fluentui/react-menu": "^9.14.20",
-        "@fluentui/react-message-bar": "^9.2.15",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-overflow": "^9.2.1",
-        "@fluentui/react-persona": "^9.2.102",
-        "@fluentui/react-popover": "^9.9.25",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-progress": "^9.1.91",
-        "@fluentui/react-provider": "^9.18.0",
-        "@fluentui/react-radio": "^9.2.36",
-        "@fluentui/react-rating": "^9.0.22",
-        "@fluentui/react-search": "^9.0.22",
-        "@fluentui/react-select": "^9.1.91",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-skeleton": "^9.1.20",
-        "@fluentui/react-slider": "^9.2.0",
-        "@fluentui/react-spinbutton": "^9.2.92",
-        "@fluentui/react-spinner": "^9.5.2",
-        "@fluentui/react-swatch-picker": "^9.1.13",
-        "@fluentui/react-switch": "^9.1.98",
-        "@fluentui/react-table": "^9.15.22",
-        "@fluentui/react-tabs": "^9.6.2",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-tag-picker": "^9.3.9",
-        "@fluentui/react-tags": "^9.3.23",
-        "@fluentui/react-teaching-popover": "^9.1.22",
-        "@fluentui/react-text": "^9.4.27",
-        "@fluentui/react-textarea": "^9.3.92",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-toast": "^9.3.59",
-        "@fluentui/react-toolbar": "^9.2.10",
-        "@fluentui/react-tooltip": "^9.4.43",
-        "@fluentui/react-tree": "^9.8.6",
-        "@fluentui/react-utilities": "^9.18.17",
-        "@fluentui/react-virtualizer": "9.0.0-alpha.87",
+        "@fluentui/react-infolabel": "^9.4.4",
+        "@fluentui/react-input": "^9.7.3",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-link": "^9.6.3",
+        "@fluentui/react-list": "^9.4.2",
+        "@fluentui/react-menu": "^9.19.4",
+        "@fluentui/react-message-bar": "^9.6.4",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-nav": "^9.3.4",
+        "@fluentui/react-overflow": "^9.5.4",
+        "@fluentui/react-persona": "^9.5.4",
+        "@fluentui/react-popover": "^9.12.4",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-progress": "^9.4.3",
+        "@fluentui/react-provider": "^9.22.3",
+        "@fluentui/react-radio": "^9.5.3",
+        "@fluentui/react-rating": "^9.3.3",
+        "@fluentui/react-search": "^9.3.3",
+        "@fluentui/react-select": "^9.4.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-skeleton": "^9.4.3",
+        "@fluentui/react-slider": "^9.5.3",
+        "@fluentui/react-spinbutton": "^9.5.3",
+        "@fluentui/react-spinner": "^9.7.3",
+        "@fluentui/react-swatch-picker": "^9.4.3",
+        "@fluentui/react-switch": "^9.4.3",
+        "@fluentui/react-table": "^9.18.4",
+        "@fluentui/react-tabs": "^9.9.3",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-tag-picker": "^9.7.4",
+        "@fluentui/react-tags": "^9.7.4",
+        "@fluentui/react-teaching-popover": "^9.6.4",
+        "@fluentui/react-text": "^9.6.3",
+        "@fluentui/react-textarea": "^9.6.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-toast": "^9.6.4",
+        "@fluentui/react-toolbar": "^9.6.4",
+        "@fluentui/react-tooltip": "^9.8.3",
+        "@fluentui/react-tree": "^9.12.4",
+        "@fluentui/react-utilities": "^9.23.2",
+        "@fluentui/react-virtualizer": "9.0.0-alpha.102",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1244,11 +1305,12 @@
       }
     },
     "node_modules/@fluentui/react-context-selector": {
-      "version": "9.1.69",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-context-selector/-/react-context-selector-9.1.69.tgz",
-      "integrity": "sha512-g29PE3cya7vY85o1ZwYMhPtkUyb7Q14UdrBCeEUr7+KjTPKMbkF27GKh0fAwwFuh9talvmI6fEVkJ9odYI6Dog==",
+      "version": "9.2.5",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-context-selector/-/react-context-selector-9.2.5.tgz",
+      "integrity": "sha512-rHB5j6k7181klVKMaoEAqXQ9FOPiXqP+44KfgmIbnA9Mu4FXenyDkH6rQ32Hrb4/DyL7J3CB955QYqfbAVZeQA==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-utilities": "^9.23.2",
         "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
@@ -1260,21 +1322,23 @@
       }
     },
     "node_modules/@fluentui/react-dialog": {
-      "version": "9.11.21",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-dialog/-/react-dialog-9.11.21.tgz",
-      "integrity": "sha512-zTBZKGG2z5gV3O9o00coN3p2wemMfiXfgTaiAb866I+htjN8/62BmzKSg32yygfVFaQnvlU1DhKAXd4SpfFAeg==",
+      "version": "9.14.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-dialog/-/react-dialog-9.14.4.tgz",
+      "integrity": "sha512-4Q7Z+tyIpWADz8ATeow28eqljlMocY7GdjEOuH2IaXvIVTOeDWEhIj6Fd+8uBMYmIm5XFgAiQcRT91eAnnVL5w==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-motion-components-preview": "^0.8.2",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1286,14 +1350,15 @@
       }
     },
     "node_modules/@fluentui/react-divider": {
-      "version": "9.2.77",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-divider/-/react-divider-9.2.77.tgz",
-      "integrity": "sha512-mo1ZhkD05p1PC8m5NnQjttIxCZnIy33wtV7w3zEtdlrpqtKvaHmOrbfJPMVVerVEZqX8SL2t5mhXX8AE/kjWyw==",
-      "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-divider/-/react-divider-9.4.3.tgz",
+      "integrity": "sha512-CjOGmh0hWngO0cHiORgqvEcJ5kRSrvX6w+5VU3tpox3Zljy94pYRZAohJmMwjcxKunyf1agSiWbT+SVV6JSD7w==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1305,18 +1370,19 @@
       }
     },
     "node_modules/@fluentui/react-drawer": {
-      "version": "9.6.1",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-drawer/-/react-drawer-9.6.1.tgz",
-      "integrity": "sha512-KDVwTnY72rTq7st8bAIU8vfPM1e+q2wsYOdTaxnD6qVU7EcJc5QxT/FmM0jZ300zqrwhf8r4evGMCe7KZv+I6A==",
-      "dependencies": {
-        "@fluentui/react-dialog": "^9.11.21",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.9.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-drawer/-/react-drawer-9.9.4.tgz",
+      "integrity": "sha512-cfYJbWIgpXGYwGmU5SLkSE6KOl854A+/De5oOqL+bh0x8suSynvlakQz78kgHTvG4g+9f13diVvG+EHelZpDCQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-dialog": "^9.14.4",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1328,16 +1394,18 @@
       }
     },
     "node_modules/@fluentui/react-field": {
-      "version": "9.1.80",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-field/-/react-field-9.1.80.tgz",
-      "integrity": "sha512-e+rVWTq5NUV7bq+PkTx+nxEIQOgRdA1RGyr2GG70qxtfus/JQoEteYMFoOFPiK0oJ0I0BfJf4NQG1mwnov7X0w==",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-field/-/react-field-9.4.3.tgz",
+      "integrity": "sha512-JXDYGa8oH6AUkt+2ByCCP2/ie4gX+kfGcgOSwb3d1FZu0qs/ryHLQowezwyLIPJKG5jruqYm5+YPdgg+P3+Sbg==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1349,14 +1417,16 @@
       }
     },
     "node_modules/@fluentui/react-focus": {
-      "version": "8.8.33",
+      "version": "8.9.25",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-focus/-/react-focus-8.9.25.tgz",
+      "integrity": "sha512-okDwer2ZHSBVEm6ISY2moruCuxa4Y0+AqP7DdoZpceoaAdHURZyLP3j7wxCEJEMRSoqKu5C6xNGn/Rxd5xPXLw==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/keyboard-key": "^0.4.12",
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/style-utilities": "^8.9.19",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/keyboard-key": "^0.4.23",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/style-utilities": "^8.12.2",
+        "@fluentui/utilities": "^8.15.22",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -1365,12 +1435,14 @@
       }
     },
     "node_modules/@fluentui/react-hooks": {
-      "version": "8.6.32",
+      "version": "8.8.19",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-hooks/-/react-hooks-8.8.19.tgz",
+      "integrity": "sha512-uXcETVTl2L0G/Ocyb2Rjym96tcJd2NaZ2Hqt6EJcBb9KJD9irNeXjCCxsRNPC5kBDbfrQML2aai+M2kU9lZKNQ==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/react-window-provider": "^2.2.16",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/react-window-provider": "^2.2.30",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/utilities": "^8.15.22",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -1379,9 +1451,10 @@
       }
     },
     "node_modules/@fluentui/react-icons": {
-      "version": "2.0.265",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-icons/-/react-icons-2.0.265.tgz",
-      "integrity": "sha512-bpiB4LGKv7LA6BsTHYLWuK6IH7CqqJYooHJfjaQ1i90OPfXpTmV1G/HB+6dIsmbAdKS14Z2bKM6Qb+yP3Ojuyg==",
+      "version": "2.0.307",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-icons/-/react-icons-2.0.307.tgz",
+      "integrity": "sha512-HSXrzQ6o+RWPnNy68EJN2M/Dh9LAJ8l5U9zWfwaFWDgktMF7dJxItyckA5BsH6inFisi6cqKtazsq9oZdAj32A==",
+      "license": "MIT",
       "dependencies": {
         "@griffel/react": "^1.0.0",
         "tslib": "^2.1.0"
@@ -1391,14 +1464,15 @@
       }
     },
     "node_modules/@fluentui/react-image": {
-      "version": "9.1.75",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-image/-/react-image-9.1.75.tgz",
-      "integrity": "sha512-pw4vL+j5/Qc9jSivfKRZ2qocx7W7BsfIFu/h8l89dg2OSvcLjUygWLYT/1KBz9oXIE8eQy6aZV/mvI3swhEWqw==",
-      "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.3.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-image/-/react-image-9.3.3.tgz",
+      "integrity": "sha512-3gpJzHMz5NiAjrgNKzFV12JrGaV9ytYK4wygICCVj4nJraQi82kz8i+u2aH6mmE969GLd7DYDoL4PjqHvp4lMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1433,17 +1507,19 @@
       }
     },
     "node_modules/@fluentui/react-infolabel": {
-      "version": "9.0.50",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-infolabel/-/react-infolabel-9.0.50.tgz",
-      "integrity": "sha512-NrEFOD5An+aD4SGx1q0sGdqnMT5eVURigEDW1tm1HPk+Hl0bgmwSlwQwLw9ejfaC5g5SoPwFaVVM2VKLfn9qzw==",
+      "version": "9.4.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-infolabel/-/react-infolabel-9.4.4.tgz",
+      "integrity": "sha512-gr00rSUgi3qLCcRoa2E1gMacyWiN5+rKjjhLpxOXA1hQw36CsLqqVfzlhLFNeeYWzCWS64r+Q215+eO83FXphw==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-popover": "^9.9.25",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-popover": "^9.12.4",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1455,15 +1531,16 @@
       }
     },
     "node_modules/@fluentui/react-input": {
-      "version": "9.4.93",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-input/-/react-input-9.4.93.tgz",
-      "integrity": "sha512-lKxB2mWYzN5bAGlYS1BMUISdAoNqKtW4d+s6vUf8lJdMFyQK4iC7QtcbS4x9FTQnSDV6cfVogp5k8JvUWs1Hww==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.7.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-input/-/react-input-9.7.3.tgz",
+      "integrity": "sha512-Dsu2eFat2EBMLwozzkY3S3fixhDgJUWlh0rzLExb2rlY3+kO9q1C7YdwZkh3MUCp0KN9y+3F7zJWKFdjaEzKzg==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1475,11 +1552,12 @@
       }
     },
     "node_modules/@fluentui/react-jsx-runtime": {
-      "version": "9.0.46",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-jsx-runtime/-/react-jsx-runtime-9.0.46.tgz",
-      "integrity": "sha512-hdzwiRPnFQ8dqmqj/Xtep7SP2I+mx+OFsP5glzdDhTFL6au5yBbnUTgI6XEiSAbisBAhl2V2qsp0mJ55gxU+sg==",
+      "version": "9.1.5",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-jsx-runtime/-/react-jsx-runtime-9.1.5.tgz",
+      "integrity": "sha512-etBvll043KjJTeK4Cchmnh+b4z5pOyC+Y/IHEPOllxWJmUGSsPVsBgNNAFPbxkcBxcZ1YCLSSL8/jef1Sr/6Fg==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-utilities": "^9.23.2",
         "@swc/helpers": "^0.5.1",
         "react-is": "^17.0.2"
       },
@@ -1489,14 +1567,15 @@
       }
     },
     "node_modules/@fluentui/react-label": {
-      "version": "9.1.78",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-label/-/react-label-9.1.78.tgz",
-      "integrity": "sha512-0Tv8Du78+lt17mjkAeoJRfsZgFVbfk2INiGVsQ2caN0n/r1IStbKQVqqWFSjyw//qpFdyw3FGOL9SalPmqIZMA==",
-      "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.3.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-label/-/react-label-9.3.3.tgz",
+      "integrity": "sha512-4fUwrluhhBYB/UROhDsorsxjKzV1Nrkf986bh2ggEqCpWmiGOkGIcavDPNsHSz5Gu7aNG5rvmDnLMgBohcmLyw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1508,16 +1587,17 @@
       }
     },
     "node_modules/@fluentui/react-link": {
-      "version": "9.3.2",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-link/-/react-link-9.3.2.tgz",
-      "integrity": "sha512-JIq2vhcqWug+GFw0EA5hVDXGzcRz4CBd/W/Mr9swlHIsA1BLMNxfHyIfZ6kZMT9IIQltWHK4CBFx2X/5co8DcA==",
+      "version": "9.6.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-link/-/react-link-9.6.3.tgz",
+      "integrity": "sha512-uuJMPPrX1Su5+OUr0GXIKdXR0J1EDHH1GV6RLSlnVW2jC3y59ndh+TKnma+jgTyK19si8UKLjLSfM4tAUsKT+A==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1528,22 +1608,47 @@
         "react-dom": ">=16.14.0 <19.0.0"
       }
     },
+    "node_modules/@fluentui/react-list": {
+      "version": "9.4.2",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-list/-/react-list-9.4.2.tgz",
+      "integrity": "sha512-/4QbChGBqwG5kBXTSii+v9YHGmsnZ3aHcbc2+KDMhDdDIpZ8UwbF/FIM3UiwwC5qTOcQMkUSHiO7b19RHZNYXA==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/keyboard-keys": "^9.0.8",
+        "@fluentui/react-checkbox": "^9.5.3",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
+        "@griffel/react": "^1.5.22",
+        "@swc/helpers": "^0.5.1"
+      },
+      "peerDependencies": {
+        "@types/react": ">=16.8.0 <19.0.0",
+        "@types/react-dom": ">=16.8.0 <19.0.0",
+        "react": ">=16.14.0 <19.0.0",
+        "react-dom": ">=16.8.0 <19.0.0"
+      }
+    },
     "node_modules/@fluentui/react-menu": {
-      "version": "9.14.20",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-menu/-/react-menu-9.14.20.tgz",
-      "integrity": "sha512-zinFHhQi2bwhv7GL8JXHwAfRYWw3hJhlUuWejLGQK1QbmwPlBHN6UCKhhIvF+RwEJbzeoyqvZcAusiHjmCp6rw==",
+      "version": "9.19.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-menu/-/react-menu-9.19.4.tgz",
+      "integrity": "sha512-EFQXHOy2uF6V9CQiCRXiTiWT/+5EByzKh3sOxRG53mRImy0QgfsEiyiK031wTxPk6rkwkJmjfpa03X7WzzlhFA==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1555,17 +1660,18 @@
       }
     },
     "node_modules/@fluentui/react-message-bar": {
-      "version": "9.2.15",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-message-bar/-/react-message-bar-9.2.15.tgz",
-      "integrity": "sha512-+FPH3ciNjTWVk9hGIeo/G8QGHf/q+tFLle4g9hXuOuDuzuaHNK6g7SkXTLm0fiZVrkB3xhFZV5ZnfehiN93S1w==",
+      "version": "9.6.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-message-bar/-/react-message-bar-9.6.4.tgz",
+      "integrity": "sha512-WtN/hoFRhaBQlUi6znfMClxhnAKqBU93mNCJ/B+A5TxfvycszYdwOgP+Q8tvEHkuZLWhyxAeGgcoTRL1KfqqCQ==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-button": "^9.3.95",
+        "@fluentui/react-button": "^9.6.4",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-link": "^9.3.2",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-link": "^9.6.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1",
         "react-transition-group": "^4.4.1"
@@ -1578,14 +1684,14 @@
       }
     },
     "node_modules/@fluentui/react-motion": {
-      "version": "9.6.1",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-motion/-/react-motion-9.6.1.tgz",
-      "integrity": "sha512-P/ZPEAXG24pGU/XY3vY6VOXxNMEztiN7lvJxqUHGDFbpMkgQwCOmfsBuNU4S6RLQy3PosbWfSsU/4N8Ga2XudQ==",
+      "version": "9.10.2",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-motion/-/react-motion-9.10.2.tgz",
+      "integrity": "sha512-DIWvYdpJQwVvBdoDNUPlg23sBgiPeb7Ai2sz5wV4TwW3Fq1Hkc74FJaUIe5q+oq1DcU1+U13QmmwiEs/sQyfHQ==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-utilities": "^9.18.17",
-        "@swc/helpers": "^0.5.1",
-        "react-is": "^17.0.2"
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-utilities": "^9.23.2",
+        "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
         "@types/react": ">=16.8.0 <19.0.0",
@@ -1595,9 +1701,10 @@
       }
     },
     "node_modules/@fluentui/react-motion-components-preview": {
-      "version": "0.3.0",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-motion-components-preview/-/react-motion-components-preview-0.3.0.tgz",
-      "integrity": "sha512-N888xO727bSogyH0WUSW2pkjQ2vXEpyDa0Ygj+4XQaTfHz8DecDiKfM83zUpQ7pZOhx8eQPUP76flijm+iVm8w==",
+      "version": "0.8.2",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-motion-components-preview/-/react-motion-components-preview-0.8.2.tgz",
+      "integrity": "sha512-JAmpEwaI6EoyDynFTyPc7f4jG+Yq4JZoA5MS88mCNFA8HmivD9gMdkf7EiFLj2TBYKHXAw4TMO5aHq15inD3Rg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-motion": "*",
         "@swc/helpers": "^0.5.1"
@@ -1609,15 +1716,45 @@
         "react-dom": ">=16.14.0 <19.0.0"
       }
     },
+    "node_modules/@fluentui/react-nav": {
+      "version": "9.3.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-nav/-/react-nav-9.3.4.tgz",
+      "integrity": "sha512-xRjEnFhsOWIhe4Pk12i0qS+ghkVYEN1rsQLfwYno03jbkbxdWgVh9snTFMFuv2tkaCMW86HT0+QJ+lZ3DPAbyw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-divider": "^9.4.3",
+        "@fluentui/react-drawer": "^9.9.4",
+        "@fluentui/react-icons": "^2.0.245",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-tooltip": "^9.8.3",
+        "@fluentui/react-utilities": "^9.23.2",
+        "@griffel/react": "^1.5.22",
+        "@swc/helpers": "^0.5.1"
+      },
+      "peerDependencies": {
+        "@types/react": ">=16.14.0 <19.0.0",
+        "@types/react-dom": ">=16.9.0 <19.0.0",
+        "react": ">=16.14.0 <19.0.0",
+        "react-dom": ">=16.14.0 <19.0.0"
+      }
+    },
     "node_modules/@fluentui/react-overflow": {
-      "version": "9.2.1",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-overflow/-/react-overflow-9.2.1.tgz",
-      "integrity": "sha512-6u+bP9PV1RedOSDgL+cHs4o3GRRWlEpKTtjeDSgs+nI5fkfN6bF+J70Uk5QksWDUBydMbkSbsD4Ta5+U2G6yww==",
-      "dependencies": {
-        "@fluentui/priority-overflow": "^9.1.14",
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.5.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-overflow/-/react-overflow-9.5.4.tgz",
+      "integrity": "sha512-BRZwNez7jtxlg26yKSziOViZg6jNdVQtxtAtaPVduuZ9cVsfaXmZXQKzNx7fhzbMQKPzStv6Iigj9NgACy9icA==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/priority-overflow": "^9.1.15",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1629,16 +1766,17 @@
       }
     },
     "node_modules/@fluentui/react-persona": {
-      "version": "9.2.102",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-persona/-/react-persona-9.2.102.tgz",
-      "integrity": "sha512-sIoKr2A/zMkFudmeO1+asG6FIItn0+FbKOXezgApHuucbq6iU8oKV8+OEHhCr/mHPulDAV8JZQYkhNHFhzSjdA==",
-      "dependencies": {
-        "@fluentui/react-avatar": "^9.6.43",
-        "@fluentui/react-badge": "^9.2.45",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.5.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-persona/-/react-persona-9.5.4.tgz",
+      "integrity": "sha512-ya1jQX5JztEVxmOAkF0nhO1+hC9aHuYjZG0xGSPZB04GQnBBWNr6+/PX0Zy2MOrXcPHf50jiOzVibOVELWX8ZQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-avatar": "^9.9.4",
+        "@fluentui/react-badge": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1650,20 +1788,21 @@
       }
     },
     "node_modules/@fluentui/react-popover": {
-      "version": "9.9.25",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-popover/-/react-popover-9.9.25.tgz",
-      "integrity": "sha512-QPhbD6MTDU6JuYZl0221IwqKEF3TEoNaL6kdAGnrltLuXVGX2pLr4LerHdbBORolfZZFo/JkKX644ay5X7BnvQ==",
+      "version": "9.12.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-popover/-/react-popover-9.12.4.tgz",
+      "integrity": "sha512-5O0gWCOmz0ShRVzPEbQ19KkdF9MaPpu9ygK6VuHdajXNuzXrLsr2WpbJKIg4an2781JTLzuxIlLa6u6KhDAEMQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1675,16 +1814,16 @@
       }
     },
     "node_modules/@fluentui/react-portal": {
-      "version": "9.4.38",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-portal/-/react-portal-9.4.38.tgz",
-      "integrity": "sha512-V4lvnjlmKqMloNK6tRXx7lDWR1g41ppFLAGMy+0KAMZRwvwiCNpWrr9oFVGTHqnh+3EuICgs1z0WiNUcbpviuA==",
+      "version": "9.8.0",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-portal/-/react-portal-9.8.0.tgz",
+      "integrity": "sha512-t2Y9sV3jqvlzFrPWGFr/6iHmDHdQKAj6Ho6RUxtrGWQoHggB9mqz3JO72JoXaeHRlc9te3HXNQUiKMjFwFvTMQ==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
-        "@swc/helpers": "^0.5.1",
-        "use-disposable": "^1.0.1"
+        "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
         "@types/react": ">=16.14.0 <19.0.0",
@@ -1694,7 +1833,9 @@
       }
     },
     "node_modules/@fluentui/react-portal-compat-context": {
-      "version": "9.0.9",
+      "version": "9.0.13",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-portal-compat-context/-/react-portal-compat-context-9.0.13.tgz",
+      "integrity": "sha512-N+c6Qs775jnr/4WIzsQuNaRu4v16fa+gGsOCzzU1bqxX0IR9BSjjO2oLGC6luaAOqlQP+JIwn/aumOIJICKXkA==",
       "license": "MIT",
       "dependencies": {
         "@swc/helpers": "^0.5.1"
@@ -1705,17 +1846,19 @@
       }
     },
     "node_modules/@fluentui/react-positioning": {
-      "version": "9.15.12",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-positioning/-/react-positioning-9.15.12.tgz",
-      "integrity": "sha512-FqopxQpf8KibdovNFLNqcDzckMgaMO2EAwXhpzH1us1l9vNofVE33k0sGHr1kU+M9TXCKeJ9x31TdS5XzBMPzQ==",
+      "version": "9.20.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-positioning/-/react-positioning-9.20.3.tgz",
+      "integrity": "sha512-h94K/Jer230ljaN6yAslNHARm5iFsIRJLkHgKZQjiQjXbnvgNAyNNDa85HJTVq1r7pD6cgkysPYY8JPM/Qj5Rg==",
+      "license": "MIT",
       "dependencies": {
         "@floating-ui/devtools": "0.2.1",
-        "@floating-ui/dom": "^1.2.0",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@floating-ui/dom": "^1.6.12",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
-        "@swc/helpers": "^0.5.1"
+        "@swc/helpers": "^0.5.1",
+        "use-sync-external-store": "^1.2.0"
       },
       "peerDependencies": {
         "@types/react": ">=16.14.0 <19.0.0",
@@ -1725,15 +1868,16 @@
       }
     },
     "node_modules/@fluentui/react-progress": {
-      "version": "9.1.91",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-progress/-/react-progress-9.1.91.tgz",
-      "integrity": "sha512-7+po8q+kR30g6QutHIpro91l8NTkmSoOZRMuoiPesuIblqeoFPoywlBanJFvLRMAAQefILi0QaTri8+PtHFZwQ==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-progress/-/react-progress-9.4.3.tgz",
+      "integrity": "sha512-sJ2rWF5rx86Q0EHwo2jRspcjy+2uYyDfF/JhntVOu39ujonTLjmlCEB21wBSxzDqx4ObuhILWPQdtmgoOvZKnw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1745,16 +1889,17 @@
       }
     },
     "node_modules/@fluentui/react-provider": {
-      "version": "9.18.0",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-provider/-/react-provider-9.18.0.tgz",
-      "integrity": "sha512-qJS2D/g3h2GwAiw2V1uWLePpAG2CKP0Pg8/iKy6vCdeNgToOGTt7ZinJSNzVzdN1y6kE2Na1glTkDLDwBj9IKg==",
+      "version": "9.22.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-provider/-/react-provider-9.22.3.tgz",
+      "integrity": "sha512-32wAi8YxHATBo0jf0JtOOvXU1OGW2yqgq89OOozEHc88B1iwq9gG/Xj8kWfjZca7n7QWl1w/dKdYMk6hUwv9+Q==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/core": "^1.16.0",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
@@ -1767,17 +1912,18 @@
       }
     },
     "node_modules/@fluentui/react-radio": {
-      "version": "9.2.36",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-radio/-/react-radio-9.2.36.tgz",
-      "integrity": "sha512-G6sYBcT6tEHmXELPvSqzOd/CJeNv6X/IAgnyg9dvXQUw4gBwG7qYuVDQQPDyG+vncA//845eSOf+o8mvBIRUfQ==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.5.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-radio/-/react-radio-9.5.3.tgz",
+      "integrity": "sha512-C8A4OM2x/MO/U+95GYp/Bmgbmp6ZdjSgHs3YX5v7Vxef3dAl0vf2SprOPpOIY7fng5oB+alXPa/Pz49I6cVaIg==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1789,15 +1935,17 @@
       }
     },
     "node_modules/@fluentui/react-rating": {
-      "version": "9.0.22",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-rating/-/react-rating-9.0.22.tgz",
-      "integrity": "sha512-0mlOL2LDt1IrGOq3yIiM5niOk8Nmrip/Xef1Rnc4Q/X6EM66qwBk2fS0ZYtk4BXFlCn2sdsHeGwCy+6Dj7wgsQ==",
+      "version": "9.3.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-rating/-/react-rating-9.3.3.tgz",
+      "integrity": "sha512-ShJaYeVsLljq/XbTZpF3EnddBfFXUT3MFhnGF1vUfOceWVLHfNgwJ0l9spaqrnC3+TqEKZu2RBP86jwuMw3XUg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1809,15 +1957,17 @@
       }
     },
     "node_modules/@fluentui/react-search": {
-      "version": "9.0.22",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-search/-/react-search-9.0.22.tgz",
-      "integrity": "sha512-+ZerMQVdnX7PhodaUF92SQTxv/6YJfcLQ/o6uJ2ppsYpBj8DX2bgWnmX7Ia0T9MReHHvIodRQXVTAFpJSBA+Gg==",
+      "version": "9.3.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-search/-/react-search-9.3.3.tgz",
+      "integrity": "sha512-CA2+Re9dNemfYMDeys3dAtxVcsoJkstA6LC8C7j1UGikehK3hfYpkmIBC8CHg5y7NvAW7E9iiZ0nUQ8aZtiQpQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-input": "^9.4.93",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-input": "^9.7.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1829,16 +1979,17 @@
       }
     },
     "node_modules/@fluentui/react-select": {
-      "version": "9.1.91",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-select/-/react-select-9.1.91.tgz",
-      "integrity": "sha512-mrQORisf6xWKrooCX6F7qqvcgDT7ei4YMtH5KHVa+sCRyy5CC0jOAVD513rj7ysAVxLKv9TSuF/rdx/Cmc7Kzw==",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-select/-/react-select-9.4.3.tgz",
+      "integrity": "sha512-c5xZV427qRro+XFuN/8L/jvOpBbrFnX7TsIxOBHPzm4fv2a8DJbY6xah7ELy3nxnO3N6GAY1vhqyY1Bjgn745w==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1850,11 +2001,12 @@
       }
     },
     "node_modules/@fluentui/react-shared-contexts": {
-      "version": "9.21.0",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-shared-contexts/-/react-shared-contexts-9.21.0.tgz",
-      "integrity": "sha512-GtP9zM7wpZtKXnq6qMd8ww0IN+5ZctPClVz83zDA602rJTJjihGwkmJ1ga8f/YphOTKcE12dnRQDl4iRL5vJ4A==",
+      "version": "9.24.1",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-shared-contexts/-/react-shared-contexts-9.24.1.tgz",
+      "integrity": "sha512-gQmynczh226aiPTV8PyzpOlSX0QTOZt0DG7ok/Q53DLWqBkRqsmfMHCEKZcDnjnemizu1IzB01NiXjXtk3WKzQ==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-theme": "^9.1.22",
+        "@fluentui/react-theme": "^9.2.0",
         "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
@@ -1863,15 +2015,16 @@
       }
     },
     "node_modules/@fluentui/react-skeleton": {
-      "version": "9.1.20",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-skeleton/-/react-skeleton-9.1.20.tgz",
-      "integrity": "sha512-nK1rJGTriJdXR9y820NHmLNRJ6YAiJUVGAtVb7OIi7KoX7/IXt/qY/xx91jnECaWHOPGzlNO+S4hxYkLiU80iQ==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-skeleton/-/react-skeleton-9.4.3.tgz",
+      "integrity": "sha512-SuwIMlZvbsP3IXHOKTf6FIuDbRqk8NEpB4XFGvkCb1Im2UJ0ofXWuce6gyFr+Z7uYUz0sGzuFwlqq2eoHad/cw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1883,16 +2036,17 @@
       }
     },
     "node_modules/@fluentui/react-slider": {
-      "version": "9.2.0",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-slider/-/react-slider-9.2.0.tgz",
-      "integrity": "sha512-96oT573BxYns4+dgGLQOT5j/4QfNIebXelvrw13AfBRBV2+WZlAApnpPujaTzv+DA86c8l+M3tqzAz11kznHzQ==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.5.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-slider/-/react-slider-9.5.3.tgz",
+      "integrity": "sha512-6pySypFo+DLC0UZrqDt3DYIU7QIcVGtF0DVjkLwRrUyK61fq50VQvGjE3xf2d7QYfuBDmJqAGbOXm4400vJ5kA==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1904,17 +2058,18 @@
       }
     },
     "node_modules/@fluentui/react-spinbutton": {
-      "version": "9.2.92",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-spinbutton/-/react-spinbutton-9.2.92.tgz",
-      "integrity": "sha512-lDfjsN1sj4ol4DEnlt1JJ0vKb8lmSMWSEWil1zgPL+wQyVCP389UsROWZuzWpUqa4PxBY78Z4LaAUQx8DM7Y8Q==",
+      "version": "9.5.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-spinbutton/-/react-spinbutton-9.5.3.tgz",
+      "integrity": "sha512-agZvrT6cJo1KmmeaySaG3o6ThbWNXdPt1p4XYDH1d/IIKcsJHQUHD6jkYh8vmd/KkzwvqbNZ/Jk18fvvCGk9/w==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1926,15 +2081,16 @@
       }
     },
     "node_modules/@fluentui/react-spinner": {
-      "version": "9.5.2",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-spinner/-/react-spinner-9.5.2.tgz",
-      "integrity": "sha512-eY6/WgrzTWFgebae5oE9/KS0TA7xrz9LRUccTEwcFBJQgrUFVUHo2jDNdIEaxzpWUGq0usCMQW10PFepnsKEqg==",
-      "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.7.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-spinner/-/react-spinner-9.7.3.tgz",
+      "integrity": "sha512-TnMBI+bCPgjKc53l4bibsTWarX222AY6y38HZWAwW9wjqw4YmxbkO4keDM9ZehtvBz8/m+rUY3Ykz1GGvfV/Og==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1946,17 +2102,19 @@
       }
     },
     "node_modules/@fluentui/react-swatch-picker": {
-      "version": "9.1.13",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-swatch-picker/-/react-swatch-picker-9.1.13.tgz",
-      "integrity": "sha512-gegZCrF+JpPPGPo0GHeJK5267LdIuBQ7sV4b0kLMmIbdzEPe9OFykb5M3PdtSpVCbwbwCX1dVcXG5cQZhAKfVA==",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-swatch-picker/-/react-swatch-picker-9.4.3.tgz",
+      "integrity": "sha512-R2x+Lv1V5KBrQc+uQ3QdKFqYB3iVdbg92WkNcOjZeQvfl7ykoe0EOtwCGEFVENLPvaTpSWSWQnaQoGZjmvSTYw==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1968,18 +2126,19 @@
       }
     },
     "node_modules/@fluentui/react-switch": {
-      "version": "9.1.98",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-switch/-/react-switch-9.1.98.tgz",
-      "integrity": "sha512-vvU2XVU9BVlJb6GGiDOOIJ/7q3XsfxuuUx6sA4ROWhHxFd+oPq3a7S5g6BhPfBZapIRDn4XjlSSxAnKxZFi8SA==",
+      "version": "9.4.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-switch/-/react-switch-9.4.3.tgz",
+      "integrity": "sha512-fvOeb49gnWLVsySyM3tCwX3Vxn74RhQG7sIZVbRKyQ+E0YEI1mBnAYEZKO7u9UWcZeMb3gz+Lr45c3UiQP/dmw==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-label": "^9.1.78",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-label": "^9.3.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -1991,22 +2150,23 @@
       }
     },
     "node_modules/@fluentui/react-table": {
-      "version": "9.15.22",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-table/-/react-table-9.15.22.tgz",
-      "integrity": "sha512-XQEmigbpWvDBHJQILcWMa9aJ4Nskt3D8t00GPuVeuSJP+1pW7aAz6MHYzDOeeVSDj1P8nk7sTSUss3TNd4VP5g==",
+      "version": "9.18.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-table/-/react-table-9.18.4.tgz",
+      "integrity": "sha512-6ysCLzsU4OHDJmKGjxWS5Yd8v3dgKjo6iqMNqEDcwASF2K617URODXEA+vXuGpacgvu/TD8l2Xryjz3mjYg8cA==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-avatar": "^9.6.43",
-        "@fluentui/react-checkbox": "^9.2.41",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-avatar": "^9.9.4",
+        "@fluentui/react-checkbox": "^9.5.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-radio": "^9.2.36",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-radio": "^9.5.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2018,16 +2178,17 @@
       }
     },
     "node_modules/@fluentui/react-tabs": {
-      "version": "9.6.2",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tabs/-/react-tabs-9.6.2.tgz",
-      "integrity": "sha512-RjlKoF+QzfZ3FN7y+NIgcTcwPqecZYGxV7ij1HeWH05wkQcT+SFnu5GEeMfN05Snia/85zDdtiwSjHW4rllm4Q==",
-      "dependencies": {
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.9.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tabs/-/react-tabs-9.9.3.tgz",
+      "integrity": "sha512-F/+KIDYUlApjG50YF6KJ4HrGxGmB084vaFALiaqt0upHq75K53KSU9R+USHYAf+NzJVjc1Jd30x04YZmXe4IfQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2039,17 +2200,18 @@
       }
     },
     "node_modules/@fluentui/react-tabster": {
-      "version": "9.23.0",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tabster/-/react-tabster-9.23.0.tgz",
-      "integrity": "sha512-YW9CcDDc4S2wV/fMex5VMZ+Nudxz0X67smSPo29sUFtCowEomZ+PRNbUhGkAgizrm7gTUCs+ITdvxm0vpl+bcQ==",
+      "version": "9.26.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tabster/-/react-tabster-9.26.3.tgz",
+      "integrity": "sha512-7Lq1GiWIYTsr+Y5jDkvn18VrL6ujXO7aNBU6HHvRlRbC7IY0q3l8tHCAlBcS6jZ7ztS+GeK35fN9RyedIE1s4g==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1",
         "keyborg": "^2.6.0",
-        "tabster": "^8.2.0"
+        "tabster": "^8.5.5"
       },
       "peerDependencies": {
         "@types/react": ">=16.14.0 <19.0.0",
@@ -2059,24 +2221,25 @@
       }
     },
     "node_modules/@fluentui/react-tag-picker": {
-      "version": "9.3.9",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tag-picker/-/react-tag-picker-9.3.9.tgz",
-      "integrity": "sha512-CX8+dbd3UX2Z2vy1guduBUPzqc9vVvEcyB4LSKkTjin8s2QH4+uip7oWA6ba6EpueFIocbE3X3+BYRiwoo01LA==",
+      "version": "9.7.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tag-picker/-/react-tag-picker-9.7.4.tgz",
+      "integrity": "sha512-Kk51El82xLcywkioXUuxJpZiIUzQUUBim+3NIstJM+SC89VR4D1Gp1l40w/9RO6H29/GBhmXTsvngr2Xvi3tnA==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-combobox": "^9.13.12",
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-field": "^9.1.80",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-combobox": "^9.16.4",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-field": "^9.4.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-tags": "^9.3.23",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-tags": "^9.7.4",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2088,19 +2251,20 @@
       }
     },
     "node_modules/@fluentui/react-tags": {
-      "version": "9.3.23",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tags/-/react-tags-9.3.23.tgz",
-      "integrity": "sha512-XX9NcAqBqkhTrbP2iYFp9LGA0NG5ZDf5X8FxtD+uUyDo+P9v6m6Tqqd0EHYtGB26aZLHTZWZTJpuq6klx/KdAQ==",
+      "version": "9.7.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tags/-/react-tags-9.7.4.tgz",
+      "integrity": "sha512-4oyoMzqXyccDeVZA2d5QxOfaTfA+uW89aOmKIzVIe1sNiRiuHN+3y3eeHvsI0QfOER1a/+IMCwryOs3g1zUaWg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-avatar": "^9.6.43",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-avatar": "^9.9.4",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2112,20 +2276,21 @@
       }
     },
     "node_modules/@fluentui/react-teaching-popover": {
-      "version": "9.1.22",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-teaching-popover/-/react-teaching-popover-9.1.22.tgz",
-      "integrity": "sha512-chzQ251KL19FPi1VRGiDMYLu/BnTUhMEyes2vaCyX8oZwcxvu37N/1PIQcbd9KCPN0kXX4TY3wVLZI8CFfporA==",
+      "version": "9.6.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-teaching-popover/-/react-teaching-popover-9.6.4.tgz",
+      "integrity": "sha512-OLiHXyFufQB4ciCtsYJdQdNnmgxVHkWyddaT9Dj/7hOc0GWqLXTzq/D7ewa0cTjxqgsFNBp8SbzHS0nMoWfG0g==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-button": "^9.3.95",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-popover": "^9.9.25",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-popover": "^9.12.4",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1",
         "use-sync-external-store": "^1.2.0"
@@ -2138,14 +2303,15 @@
       }
     },
     "node_modules/@fluentui/react-text": {
-      "version": "9.4.27",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-text/-/react-text-9.4.27.tgz",
-      "integrity": "sha512-/a1/eibyGYcWsc5M0i32vOAD/zf2gD5lDjaLXSiwoerF+e0j7GLgjbTi63ZK3K3Sh2repTrW/nsAHhqbeQhMyw==",
-      "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.6.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-text/-/react-text-9.6.3.tgz",
+      "integrity": "sha512-wYidjCPCfUBObCESK1v3PkaV9FYZGSB/r00xlLQgpgrKaQeuJgPSmDi45s9onA3T/CtF1CTTDE1+Yp22yH8t4w==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2157,15 +2323,16 @@
       }
     },
     "node_modules/@fluentui/react-textarea": {
-      "version": "9.3.92",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-textarea/-/react-textarea-9.3.92.tgz",
-      "integrity": "sha512-Vmv0l8rGs34pjNSUDPKazZVN2yiWbda0PWy9PhOTIZsl9DdcLwyLcge3tKHnxHBvqEz6c1VzKxgK3+liLaSxpg==",
-      "dependencies": {
-        "@fluentui/react-field": "^9.1.80",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.6.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-textarea/-/react-textarea-9.6.3.tgz",
+      "integrity": "sha512-j1bgUevTgu/1pFbwfYieDZ53h8V885kjhQLmN/K7YHrZIK0c5LYAA/oc6eATxi3tohGGd0xn9HlxFVLU4Ei8yw==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-field": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2177,29 +2344,32 @@
       }
     },
     "node_modules/@fluentui/react-theme": {
-      "version": "9.1.22",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-theme/-/react-theme-9.1.22.tgz",
-      "integrity": "sha512-+orOyOsI0I7m6ovkU20soe8BUOS6eESfVAr3iZ+P9NsqtnCRNnrkOnfEmuOIh+UkNhljEkY9pVUSF1JPq+XHtg==",
+      "version": "9.2.0",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-theme/-/react-theme-9.2.0.tgz",
+      "integrity": "sha512-Q0zp/MY1m5RjlkcwMcjn/PQRT2T+q3bgxuxWbhgaD07V+tLzBhGROvuqbsdg4YWF/IK21zPfLhmGyifhEu0DnQ==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/tokens": "1.0.0-alpha.19",
+        "@fluentui/tokens": "1.0.0-alpha.22",
         "@swc/helpers": "^0.5.1"
       }
     },
     "node_modules/@fluentui/react-toast": {
-      "version": "9.3.59",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-toast/-/react-toast-9.3.59.tgz",
-      "integrity": "sha512-42+MBvjkwCmEj46pvwN0+8HABXJ0tbm1gSuAlaiQO5zIO+xWCZKLeqlGtbJ2DH6G6ZcOwBkiOXioOLyRS7t03A==",
+      "version": "9.6.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-toast/-/react-toast-9.6.4.tgz",
+      "integrity": "sha512-uJSXqYK/S+xTBS7u3hvhyRNnQNH9WXwWMcvdqucDC5aE6Ippq/mNDk3J7KKDrnjC8OyWWlHv5nwtkdtTkXxugA==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
+        "@fluentui/react-aria": "^9.16.3",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-motion-components-preview": "^0.8.2",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2211,19 +2381,20 @@
       }
     },
     "node_modules/@fluentui/react-toolbar": {
-      "version": "9.2.10",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-toolbar/-/react-toolbar-9.2.10.tgz",
-      "integrity": "sha512-lTix5YU3u85JnI/ISSraNIQDdj3FX6n2Xuzd27lGC6cebpI799NsZVfaprwNr5ywOwLlJ/B+kQXflQMZAJ4NxA==",
-      "dependencies": {
-        "@fluentui/react-button": "^9.3.95",
-        "@fluentui/react-context-selector": "^9.1.69",
-        "@fluentui/react-divider": "^9.2.77",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-radio": "^9.2.36",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+      "version": "9.6.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-toolbar/-/react-toolbar-9.6.4.tgz",
+      "integrity": "sha512-wiSRzZxfJ5b8wytLqtUEe1PB4092iFWdbPvXh+kHCcpenDActdaGaVX3yCAX34BnEYGPWVoVbi7F5j8SRnBpKg==",
+      "license": "MIT",
+      "dependencies": {
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-context-selector": "^9.2.5",
+        "@fluentui/react-divider": "^9.4.3",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-radio": "^9.5.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2235,18 +2406,19 @@
       }
     },
     "node_modules/@fluentui/react-tooltip": {
-      "version": "9.4.43",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tooltip/-/react-tooltip-9.4.43.tgz",
-      "integrity": "sha512-KUIrs7uxjC916HT6XJgCfcxoxlbABi6TlriOzi/aELh0Gu5zH/9UPgvKw5BzWQUUyFLpjVOBKjogqI5SdsQGRg==",
+      "version": "9.8.3",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tooltip/-/react-tooltip-9.8.3.tgz",
+      "integrity": "sha512-kuyV5RwK5P84Qe0LdYByqFqEQ3AEHj7zAYg+6uz1IqKgIyscZillfhY3X9vaMrGG+2DOO2JLlkPQ46bhPsz/Zg==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-portal": "^9.4.38",
-        "@fluentui/react-positioning": "^9.15.12",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-portal": "^9.8.0",
+        "@fluentui/react-positioning": "^9.20.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2258,25 +2430,26 @@
       }
     },
     "node_modules/@fluentui/react-tree": {
-      "version": "9.8.6",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-tree/-/react-tree-9.8.6.tgz",
-      "integrity": "sha512-iqT7wRz3uz/zgUkuxCc7LeDBhtVNmv2fA2e5AoEgcFGJRck3b97G9l8bqiyaitqt/1MXLCKOf0LlTqLpe7mVbQ==",
+      "version": "9.12.4",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-tree/-/react-tree-9.12.4.tgz",
+      "integrity": "sha512-6kdKupn+yHIrjHCC3SAzVqIzHyHd2mr8y29NEBaDgROrrsmfuVaIuaaG9NhV0cgGf/7nxg04Ab5mTzBfl7uy9g==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-aria": "^9.13.9",
-        "@fluentui/react-avatar": "^9.6.43",
-        "@fluentui/react-button": "^9.3.95",
-        "@fluentui/react-checkbox": "^9.2.41",
-        "@fluentui/react-context-selector": "^9.1.69",
+        "@fluentui/react-aria": "^9.16.3",
+        "@fluentui/react-avatar": "^9.9.4",
+        "@fluentui/react-button": "^9.6.4",
+        "@fluentui/react-checkbox": "^9.5.3",
+        "@fluentui/react-context-selector": "^9.2.5",
         "@fluentui/react-icons": "^2.0.245",
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-motion": "^9.6.1",
-        "@fluentui/react-motion-components-preview": "^0.3.0",
-        "@fluentui/react-radio": "^9.2.36",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-tabster": "^9.23.0",
-        "@fluentui/react-theme": "^9.1.22",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.5",
+        "@fluentui/react-motion": "^9.10.2",
+        "@fluentui/react-motion-components-preview": "^0.8.2",
+        "@fluentui/react-radio": "^9.5.3",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-tabster": "^9.26.3",
+        "@fluentui/react-theme": "^9.2.0",
+        "@fluentui/react-utilities": "^9.23.2",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2288,12 +2461,13 @@
       }
     },
     "node_modules/@fluentui/react-utilities": {
-      "version": "9.18.17",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-utilities/-/react-utilities-9.18.17.tgz",
-      "integrity": "sha512-xW3e+sNd14njyXX1ovI2I8Sz/kjuieGzEbMbduNQONERp6Doc4JItPyxXUgv20qZ8eFYO6AykcI+xCTpHRkiBA==",
+      "version": "9.23.2",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-utilities/-/react-utilities-9.23.2.tgz",
+      "integrity": "sha512-ke2Ey3wz8UpCmL2WtxJQlWtT9XSe8aTXSi8kMJjwlu4uxhfq9LavVNMM/bs+CavB7fwyxtIH3ceAkVK6a4uTVQ==",
+      "license": "MIT",
       "dependencies": {
         "@fluentui/keyboard-keys": "^9.0.8",
-        "@fluentui/react-shared-contexts": "^9.21.0",
+        "@fluentui/react-shared-contexts": "^9.24.1",
         "@swc/helpers": "^0.5.1"
       },
       "peerDependencies": {
@@ -2302,13 +2476,14 @@
       }
     },
     "node_modules/@fluentui/react-virtualizer": {
-      "version": "9.0.0-alpha.87",
-      "resolved": "https://registry.npmjs.org/@fluentui/react-virtualizer/-/react-virtualizer-9.0.0-alpha.87.tgz",
-      "integrity": "sha512-NbeZ9COirzepBqSnUjfAJzgep7b9Z718Rqrr66vMFkBSKC5pfkeS4qrQIXyansNndSy6AUz8i0SI/JLGS8wyNw==",
+      "version": "9.0.0-alpha.102",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-virtualizer/-/react-virtualizer-9.0.0-alpha.102.tgz",
+      "integrity": "sha512-kt/kuAMTKTTY/00ToUlgUwUCty2HGj4Tnr+fxKRmr7Ziy5VWhi1YoNJ8vcgmxog5J90t4tS29LB0LP0KztQUVg==",
+      "license": "MIT",
       "dependencies": {
-        "@fluentui/react-jsx-runtime": "^9.0.46",
-        "@fluentui/react-shared-contexts": "^9.21.0",
-        "@fluentui/react-utilities": "^9.18.17",
+        "@fluentui/react-jsx-runtime": "^9.1.4",
+        "@fluentui/react-shared-contexts": "^9.24.1",
+        "@fluentui/react-utilities": "^9.23.1",
         "@griffel/react": "^1.5.22",
         "@swc/helpers": "^0.5.1"
       },
@@ -2320,10 +2495,12 @@
       }
     },
     "node_modules/@fluentui/react-window-provider": {
-      "version": "2.2.16",
+      "version": "2.2.30",
+      "resolved": "https://registry.npmjs.org/@fluentui/react-window-provider/-/react-window-provider-2.2.30.tgz",
+      "integrity": "sha512-2SXuiZcU29W0D9zfExcTfzVx97OI50YCn5fGGO0bTDuP5VxzTQp1mipAY4qm/yJMMinoXkzBGLl1rK0Tdtxh1w==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/set-version": "^8.2.12",
+        "@fluentui/set-version": "^8.2.24",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -2332,31 +2509,37 @@
       }
     },
     "node_modules/@fluentui/set-version": {
-      "version": "8.2.12",
+      "version": "8.2.24",
+      "resolved": "https://registry.npmjs.org/@fluentui/set-version/-/set-version-8.2.24.tgz",
+      "integrity": "sha512-8uNi2ThvNgF+6d3q2luFVVdk/wZV0AbRfJ85kkvf2+oSRY+f6QVK0w13vMorNhA5puumKcZniZoAfUF02w7NSg==",
       "license": "MIT",
       "dependencies": {
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/style-utilities": {
-      "version": "8.9.19",
+      "version": "8.12.2",
+      "resolved": "https://registry.npmjs.org/@fluentui/style-utilities/-/style-utilities-8.12.2.tgz",
+      "integrity": "sha512-inDXaSs3Fj+oM5vIlqws9sQa+zh0Nk1+ZGFGCxsVw9jSGT2OD08Hx5oh4hio3wWqDUa78zZ6VEzGChTaLyOm4g==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/theme": "^2.6.37",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/theme": "^2.6.67",
+        "@fluentui/utilities": "^8.15.22",
         "@microsoft/load-themed-styles": "^1.10.26",
         "tslib": "^2.1.0"
       }
     },
     "node_modules/@fluentui/theme": {
-      "version": "2.6.37",
+      "version": "2.6.67",
+      "resolved": "https://registry.npmjs.org/@fluentui/theme/-/theme-2.6.67.tgz",
+      "integrity": "sha512-+9+VkIkZ+NCQDXFP6+WV2ChAj/KHphOEDCvGO15w8ql7sqRxeRQACtoWYNq1tAAsodbnq/amCfo2PNy2VIcIOQ==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/set-version": "^8.2.12",
-        "@fluentui/utilities": "^8.13.20",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/set-version": "^8.2.24",
+        "@fluentui/utilities": "^8.15.22",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -2365,20 +2548,24 @@
       }
     },
     "node_modules/@fluentui/tokens": {
-      "version": "1.0.0-alpha.19",
-      "resolved": "https://registry.npmjs.org/@fluentui/tokens/-/tokens-1.0.0-alpha.19.tgz",
-      "integrity": "sha512-Y1MI/d/SVhheFglzG/hyyNynbUk9vby7yU4oMLbIlqNRyQw03hPE3LhHb1k9/EHAuLxRioezEcEhRfOD8ej8dQ==",
+      "version": "1.0.0-alpha.22",
+      "resolved": "https://registry.npmjs.org/@fluentui/tokens/-/tokens-1.0.0-alpha.22.tgz",
+      "integrity": "sha512-i9fgYyyCWFRdUi+vQwnV6hp7wpLGK4p09B+O/f2u71GBXzPuniubPYvrIJYtl444DD6shLjYToJhQ1S6XTFwLg==",
+      "license": "MIT",
       "dependencies": {
         "@swc/helpers": "^0.5.1"
       }
     },
     "node_modules/@fluentui/utilities": {
-      "version": "8.13.20",
+      "version": "8.15.22",
+      "resolved": "https://registry.npmjs.org/@fluentui/utilities/-/utilities-8.15.22.tgz",
+      "integrity": "sha512-ZhDO+6dVLjf2BbHizCA2bnVFLPmOSpemsTMtEY/Nr5fhot5+xeoZVBJrr10X6wN0fTdfMketj/+rnkh5hWXljg==",
       "license": "MIT",
       "dependencies": {
-        "@fluentui/dom-utilities": "^2.2.12",
-        "@fluentui/merge-styles": "^8.5.13",
-        "@fluentui/set-version": "^8.2.12",
+        "@fluentui/dom-utilities": "^2.3.10",
+        "@fluentui/merge-styles": "^8.6.14",
+        "@fluentui/react-window-provider": "^2.2.30",
+        "@fluentui/set-version": "^8.2.24",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
@@ -2387,13 +2574,13 @@
       }
     },
     "node_modules/@griffel/core": {
-      "version": "1.18.0",
-      "resolved": "https://registry.npmjs.org/@griffel/core/-/core-1.18.0.tgz",
-      "integrity": "sha512-3Dkn6f7ULeSzJ1wLyLfN1vc+v3q5shuEejeMe4XymBozQo0l35WIfH8FWcwB+Xrgip4fLLOy1p3sYN85gFGZxw==",
+      "version": "1.19.2",
+      "resolved": "https://registry.npmjs.org/@griffel/core/-/core-1.19.2.tgz",
+      "integrity": "sha512-WkB/QQkjy9dE4vrNYGhQvRRUHFkYVOuaznVOMNTDT4pS9aTJ9XPrMTXXlkpcwaf0D3vNKoerj4zAwnU2lBzbOg==",
       "license": "MIT",
       "dependencies": {
         "@emotion/hash": "^0.9.0",
-        "@griffel/style-types": "^1.2.0",
+        "@griffel/style-types": "^1.3.0",
         "csstype": "^3.1.3",
         "rtl-css-js": "^1.16.1",
         "stylis": "^4.2.0",
@@ -2401,22 +2588,22 @@
       }
     },
     "node_modules/@griffel/react": {
-      "version": "1.5.25",
-      "resolved": "https://registry.npmjs.org/@griffel/react/-/react-1.5.25.tgz",
-      "integrity": "sha512-ZGiCdn71VIX56fd3AxM7ouCxgClPvunOFIpXxFKebGJ94/rdj4sIbahuI1QBUFuU4/bqUyD6QonjDEpFBl9ORw==",
+      "version": "1.5.30",
+      "resolved": "https://registry.npmjs.org/@griffel/react/-/react-1.5.30.tgz",
+      "integrity": "sha512-1q4ojbEVFY5YA0j1NamP0WWF4BKh+GHsVugltDYeEgEaVbH3odJ7tJabuhQgY+7Nhka0pyEFWSiHJev0K3FSew==",
       "license": "MIT",
       "dependencies": {
-        "@griffel/core": "^1.18.0",
+        "@griffel/core": "^1.19.2",
         "tslib": "^2.1.0"
       },
       "peerDependencies": {
-        "react": ">=16.8.0 <19.0.0"
+        "react": ">=16.8.0 <20.0.0"
       }
     },
     "node_modules/@griffel/style-types": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/@griffel/style-types/-/style-types-1.2.0.tgz",
-      "integrity": "sha512-x166MNw0vWe5l5qhinfNT4eyWOaP48iFzPyFOfIB0/BVidKTWsEe5PmqRJDDtrJFS3VHhd/tE0oM6tkEMh2tsg==",
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/@griffel/style-types/-/style-types-1.3.0.tgz",
+      "integrity": "sha512-bHwD3sUE84Xwv4dH011gOKe1jul77M1S6ZFN9Tnq8pvZ48UMdY//vtES6fv7GRS5wXYT4iqxQPBluAiYAfkpmw==",
       "license": "MIT",
       "dependencies": {
         "csstype": "^3.1.3"
@@ -2463,12 +2650,15 @@
     },
     "node_modules/@microsoft/load-themed-styles": {
       "version": "1.10.295",
+      "resolved": "https://registry.npmjs.org/@microsoft/load-themed-styles/-/load-themed-styles-1.10.295.tgz",
+      "integrity": "sha512-W+IzEBw8a6LOOfRJM02dTT7BDZijxm+Z7lhtOAz1+y9vQm1Kdz9jlAO+qCEKsfxtUOmKilW8DIRqFw2aUgKeGg==",
       "license": "MIT"
     },
     "node_modules/@react-spring/animated": {
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/animated/-/animated-9.7.5.tgz",
       "integrity": "sha512-Tqrwz7pIlsSDITzxoLS3n/v/YCUHQdOIKtOJf4yL6kYVSDTSmVK1LI1Q3M/uu2Sx4X3pIWF3xLUhlsA6SPNTNg==",
+      "license": "MIT",
       "dependencies": {
         "@react-spring/shared": "~9.7.5",
         "@react-spring/types": "~9.7.5"
@@ -2481,6 +2671,7 @@
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/core/-/core-9.7.5.tgz",
       "integrity": "sha512-rmEqcxRcu7dWh7MnCcMXLvrf6/SDlSokLaLTxiPlAYi11nN3B5oiCUAblO72o+9z/87j2uzxa2Inm8UbLjXA+w==",
+      "license": "MIT",
       "dependencies": {
         "@react-spring/animated": "~9.7.5",
         "@react-spring/shared": "~9.7.5",
@@ -2497,12 +2688,14 @@
     "node_modules/@react-spring/rafz": {
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/rafz/-/rafz-9.7.5.tgz",
-      "integrity": "sha512-5ZenDQMC48wjUzPAm1EtwQ5Ot3bLIAwwqP2w2owG5KoNdNHpEJV263nGhCeKKmuA3vG2zLLOdu3or6kuDjA6Aw=="
+      "integrity": "sha512-5ZenDQMC48wjUzPAm1EtwQ5Ot3bLIAwwqP2w2owG5KoNdNHpEJV263nGhCeKKmuA3vG2zLLOdu3or6kuDjA6Aw==",
+      "license": "MIT"
     },
     "node_modules/@react-spring/shared": {
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/shared/-/shared-9.7.5.tgz",
       "integrity": "sha512-wdtoJrhUeeyD/PP/zo+np2s1Z820Ohr/BbuVYv+3dVLW7WctoiN7std8rISoYoHpUXtbkpesSKuPIw/6U1w1Pw==",
+      "license": "MIT",
       "dependencies": {
         "@react-spring/rafz": "~9.7.5",
         "@react-spring/types": "~9.7.5"
@@ -2514,12 +2707,14 @@
     "node_modules/@react-spring/types": {
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/types/-/types-9.7.5.tgz",
-      "integrity": "sha512-HVj7LrZ4ReHWBimBvu2SKND3cDVUPWKLqRTmWe/fNY6o1owGOX0cAHbdPDTMelgBlVbrTKrre6lFkhqGZErK/g=="
+      "integrity": "sha512-HVj7LrZ4ReHWBimBvu2SKND3cDVUPWKLqRTmWe/fNY6o1owGOX0cAHbdPDTMelgBlVbrTKrre6lFkhqGZErK/g==",
+      "license": "MIT"
     },
     "node_modules/@react-spring/web": {
       "version": "9.7.5",
       "resolved": "https://registry.npmjs.org/@react-spring/web/-/web-9.7.5.tgz",
       "integrity": "sha512-lmvqGwpe+CSttsWNZVr+Dg62adtKhauGwLyGE/RRyZ8AAMLgb9x3NDMA5RMElXo+IMyTkPp7nxTB8ZQlmhb6JQ==",
+      "license": "MIT",
       "dependencies": {
         "@react-spring/animated": "~9.7.5",
         "@react-spring/core": "~9.7.5",
@@ -2532,9 +2727,10 @@
       }
     },
     "node_modules/@remix-run/router": {
-      "version": "1.21.0",
-      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.21.0.tgz",
-      "integrity": "sha512-xfSkCAchbdG5PnbrKqFWwia4Bi61nH+wm8wLEqfHDyp7Y3dZzgqS2itV8i4gAq9pC2HsTpwyBC6Ds8VHZ96JlA==",
+      "version": "1.23.0",
+      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.23.0.tgz",
+      "integrity": "sha512-O3rHJzAQKamUz1fvE0Qaw0xSFqsA/yafi2iqeE0pvdFtCO1viYx8QL6f3Ln/aCCTLxs68SLf0KPM9eSeM8yBnA==",
+      "license": "MIT",
       "engines": {
         "node": ">=14.0.0"
       }
@@ -2547,9 +2743,9 @@
       "license": "MIT"
     },
     "node_modules/@rollup/rollup-android-arm-eabi": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.46.1.tgz",
-      "integrity": "sha512-oENme6QxtLCqjChRUUo3S6X8hjCXnWmJWnedD7VbGML5GUtaOtAyx+fEEXnBXVf0CBZApMQU0Idwi0FmyxzQhw==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.22.4.tgz",
+      "integrity": "sha512-Fxamp4aEZnfPOcGA8KSNEohV8hX7zVHOemC8jVBoBUHu5zpJK/Eu3uJwt6BMgy9fkvzxDaurgj96F/NiLukF2w==",
       "cpu": [
         "arm"
       ],
@@ -2561,9 +2757,9 @@
       ]
     },
     "node_modules/@rollup/rollup-android-arm64": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.46.1.tgz",
-      "integrity": "sha512-OikvNT3qYTl9+4qQ9Bpn6+XHM+ogtFadRLuT2EXiFQMiNkXFLQfNVppi5o28wvYdHL2s3fM0D/MZJ8UkNFZWsw==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.22.4.tgz",
+      "integrity": "sha512-VXoK5UMrgECLYaMuGuVTOx5kcuap1Jm8g/M83RnCHBKOqvPPmROFJGQaZhGccnsFtfXQ3XYa4/jMCJvZnbJBdA==",
       "cpu": [
         "arm64"
       ],
@@ -2575,9 +2771,9 @@
       ]
     },
     "node_modules/@rollup/rollup-darwin-arm64": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.46.1.tgz",
-      "integrity": "sha512-EFYNNGij2WllnzljQDQnlFTXzSJw87cpAs4TVBAWLdkvic5Uh5tISrIL6NRcxoh/b2EFBG/TK8hgRrGx94zD4A==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.22.4.tgz",
+      "integrity": "sha512-xMM9ORBqu81jyMKCDP+SZDhnX2QEVQzTcC6G18KlTQEzWK8r/oNZtKuZaCcHhnsa6fEeOBionoyl5JsAbE/36Q==",
       "cpu": [
         "arm64"
       ],
@@ -2589,9 +2785,9 @@
       ]
     },
     "node_modules/@rollup/rollup-darwin-x64": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.46.1.tgz",
-      "integrity": "sha512-ZaNH06O1KeTug9WI2+GRBE5Ujt9kZw4a1+OIwnBHal92I8PxSsl5KpsrPvthRynkhMck4XPdvY0z26Cym/b7oA==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.22.4.tgz",
+      "integrity": "sha512-aJJyYKQwbHuhTUrjWjxEvGnNNBCnmpHDvrb8JFDbeSH3m2XdHcxDd3jthAzvmoI8w/kSjd2y0udT+4okADsZIw==",
       "cpu": [
         "x64"
       ],
@@ -2602,38 +2798,10 @@
         "darwin"
       ]
     },
-    "node_modules/@rollup/rollup-freebsd-arm64": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.46.1.tgz",
-      "integrity": "sha512-n4SLVebZP8uUlJ2r04+g2U/xFeiQlw09Me5UFqny8HGbARl503LNH5CqFTb5U5jNxTouhRjai6qPT0CR5c/Iig==",
-      "cpu": [
-        "arm64"
-      ],
-      "dev": true,
-      "license": "MIT",
-      "optional": true,
-      "os": [
-        "freebsd"
-      ]
-    },
-    "node_modules/@rollup/rollup-freebsd-x64": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.46.1.tgz",
-      "integrity": "sha512-8vu9c02F16heTqpvo3yeiu7Vi1REDEC/yES/dIfq3tSXe6mLndiwvYr3AAvd1tMNUqE9yeGYa5w7PRbI5QUV+w==",
-      "cpu": [
-        "x64"
-      ],
-      "dev": true,
-      "license": "MIT",
-      "optional": true,
-      "os": [
-        "freebsd"
-      ]
-    },
     "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.46.1.tgz",
-      "integrity": "sha512-K4ncpWl7sQuyp6rWiGUvb6Q18ba8mzM0rjWJ5JgYKlIXAau1db7hZnR0ldJvqKWWJDxqzSLwGUhA4jp+KqgDtQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.22.4.tgz",
+      "integrity": "sha512-j63YtCIRAzbO+gC2L9dWXRh5BFetsv0j0va0Wi9epXDgU/XUi5dJKo4USTttVyK7fGw2nPWK0PbAvyliz50SCQ==",
       "cpu": [
         "arm"
       ],
@@ -2645,9 +2813,9 @@
       ]
     },
     "node_modules/@rollup/rollup-linux-arm-musleabihf": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.46.1.tgz",
-      "integrity": "sha512-YykPnXsjUjmXE6j6k2QBBGAn1YsJUix7pYaPLK3RVE0bQL2jfdbfykPxfF8AgBlqtYbfEnYHmLXNa6QETjdOjQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.22.4.tgz",
+      "integrity": "sha512-dJnWUgwWBX1YBRsuKKMOlXCzh2Wu1mlHzv20TpqEsfdZLb3WoJW2kIEsGwLkroYf24IrPAvOT/ZQ2OYMV6vlrg==",
       "cpu": [
         "arm"
       ],
@@ -2659,9 +2827,9 @@
       ]
     },
     "node_modules/@rollup/rollup-linux-arm64-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.46.1.tgz",
-      "integrity": "sha512-kKvqBGbZ8i9pCGW3a1FH3HNIVg49dXXTsChGFsHGXQaVJPLA4f/O+XmTxfklhccxdF5FefUn2hvkoGJH0ScWOA==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.22.4.tgz",
+      "integrity": "sha512-AdPRoNi3NKVLolCN/Sp4F4N1d98c4SBnHMKoLuiG6RXgoZ4sllseuGioszumnPGmPM2O7qaAX/IJdeDU8f26Aw==",
       "cpu": [
         "arm64"
       ],
@@ -2673,9 +2841,9 @@
       ]
     },
     "node_modules/@rollup/rollup-linux-arm64-musl": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.46.1.tgz",
-      "integrity": "sha512-zzX5nTw1N1plmqC9RGC9vZHFuiM7ZP7oSWQGqpbmfjK7p947D518cVK1/MQudsBdcD84t6k70WNczJOct6+hdg==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.22.4.tgz",
+      "integrity": "sha512-Gl0AxBtDg8uoAn5CCqQDMqAx22Wx22pjDOjBdmG0VIWX3qUBHzYmOKh8KXHL4UpogfJ14G4wk16EQogF+v8hmA==",
       "cpu": [
         "arm64"
       ],
@@ -2686,24 +2854,10 @@
         "linux"
       ]
     },
-    "node_modules/@rollup/rollup-linux-loongarch64-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loongarch64-gnu/-/rollup-linux-loongarch64-gnu-4.46.1.tgz",
-      "integrity": "sha512-O8CwgSBo6ewPpktFfSDgB6SJN9XDcPSvuwxfejiddbIC/hn9Tg6Ai0f0eYDf3XvB/+PIWzOQL+7+TZoB8p9Yuw==",
-      "cpu": [
-        "loong64"
-      ],
-      "dev": true,
-      "license": "MIT",
-      "optional": true,
-      "os": [
-        "linux"
-      ]
-    },
-    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.46.1.tgz",
-      "integrity": "sha512-JnCfFVEKeq6G3h3z8e60kAp8Rd7QVnWCtPm7cxx+5OtP80g/3nmPtfdCXbVl063e3KsRnGSKDHUQMydmzc/wBA==",
+    "node_modules/@rollup/rollup-linux-powerpc64le-gnu": {
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-powerpc64le-gnu/-/rollup-linux-powerpc64le-gnu-4.22.4.tgz",
+      "integrity": "sha512-3aVCK9xfWW1oGQpTsYJJPF6bfpWfhbRnhdlyhak2ZiyFLDaayz0EP5j9V1RVLAAxlmWKTDfS9wyRyY3hvhPoOg==",
       "cpu": [
         "ppc64"
       ],
@@ -2715,37 +2869,22 @@
       ]
     },
     "node_modules/@rollup/rollup-linux-riscv64-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.46.1.tgz",
-      "integrity": "sha512-dVxuDqS237eQXkbYzQQfdf/njgeNw6LZuVyEdUaWwRpKHhsLI+y4H/NJV8xJGU19vnOJCVwaBFgr936FHOnJsQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.22.4.tgz",
+      "integrity": "sha512-ePYIir6VYnhgv2C5Xe9u+ico4t8sZWXschR6fMgoPUK31yQu7hTEJb7bCqivHECwIClJfKgE7zYsh1qTP3WHUA==",
       "cpu": [
         "riscv64"
       ],
       "dev": true,
-      "license": "MIT",
-      "optional": true,
-      "os": [
-        "linux"
-      ]
-    },
-    "node_modules/@rollup/rollup-linux-riscv64-musl": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.46.1.tgz",
-      "integrity": "sha512-CvvgNl2hrZrTR9jXK1ye0Go0HQRT6ohQdDfWR47/KFKiLd5oN5T14jRdUVGF4tnsN8y9oSfMOqH6RuHh+ck8+w==",
-      "cpu": [
-        "riscv64"
-      ],
-      "dev": true,
-      "license": "MIT",
       "optional": true,
       "os": [
         "linux"
       ]
     },
     "node_modules/@rollup/rollup-linux-s390x-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.46.1.tgz",
-      "integrity": "sha512-x7ANt2VOg2565oGHJ6rIuuAon+A8sfe1IeUx25IKqi49OjSr/K3awoNqr9gCwGEJo9OuXlOn+H2p1VJKx1psxA==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.22.4.tgz",
+      "integrity": "sha512-GqFJ9wLlbB9daxhVlrTe61vJtEY99/xB3C8e4ULVsVfflcpmR6c8UZXjtkMA6FhNONhj2eA5Tk9uAVw5orEs4Q==",
       "cpu": [
         "s390x"
       ],
@@ -2757,23 +2896,22 @@
       ]
     },
     "node_modules/@rollup/rollup-linux-x64-gnu": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.46.1.tgz",
-      "integrity": "sha512-9OADZYryz/7E8/qt0vnaHQgmia2Y0wrjSSn1V/uL+zw/i7NUhxbX4cHXdEQ7dnJgzYDS81d8+tf6nbIdRFZQoQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.22.4.tgz",
+      "integrity": "sha512-87v0ol2sH9GE3cLQLNEy0K/R0pz1nvg76o8M5nhMR0+Q+BBGLnb35P0fVz4CQxHYXaAOhE8HhlkaZfsdUOlHwg==",
       "cpu": [
         "x64"
       ],
       "dev": true,
-      "license": "MIT",
       "optional": true,
       "os": [
         "linux"
       ]
     },
     "node_modules/@rollup/rollup-linux-x64-musl": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.46.1.tgz",
-      "integrity": "sha512-NuvSCbXEKY+NGWHyivzbjSVJi68Xfq1VnIvGmsuXs6TCtveeoDRKutI5vf2ntmNnVq64Q4zInet0UDQ+yMB6tA==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.22.4.tgz",
+      "integrity": "sha512-UV6FZMUgePDZrFjrNGIWzDo/vABebuXBhJEqrHxrGiU6HikPy0Z3LfdtciIttEUQfuDdCn8fqh7wiFJjCNwO+g==",
       "cpu": [
         "x64"
       ],
@@ -2785,9 +2923,9 @@
       ]
     },
     "node_modules/@rollup/rollup-win32-arm64-msvc": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.46.1.tgz",
-      "integrity": "sha512-mWz+6FSRb82xuUMMV1X3NGiaPFqbLN9aIueHleTZCc46cJvwTlvIh7reQLk4p97dv0nddyewBhwzryBHH7wtPw==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.22.4.tgz",
+      "integrity": "sha512-BjI+NVVEGAXjGWYHz/vv0pBqfGoUH0IGZ0cICTn7kB9PyjrATSkX+8WkguNjWoj2qSr1im/+tTGRaY+4/PdcQw==",
       "cpu": [
         "arm64"
       ],
@@ -2799,9 +2937,9 @@
       ]
     },
     "node_modules/@rollup/rollup-win32-ia32-msvc": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.46.1.tgz",
-      "integrity": "sha512-7Thzy9TMXDw9AU4f4vsLNBxh7/VOKuXi73VH3d/kHGr0tZ3x/ewgL9uC7ojUKmH1/zvmZe2tLapYcZllk3SO8Q==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.22.4.tgz",
+      "integrity": "sha512-SiWG/1TuUdPvYmzmYnmd3IEifzR61Tragkbx9D3+R8mzQqDBz8v+BvZNDlkiTtI9T15KYZhP0ehn3Dld4n9J5g==",
       "cpu": [
         "ia32"
       ],
@@ -2813,9 +2951,9 @@
       ]
     },
     "node_modules/@rollup/rollup-win32-x64-msvc": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.46.1.tgz",
-      "integrity": "sha512-7GVB4luhFmGUNXXJhH2jJwZCFB3pIOixv2E3s17GQHBFUOQaISlt7aGcQgqvCaDSxTZJUzlK/QJ1FN8S94MrzQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.22.4.tgz",
+      "integrity": "sha512-j8pPKp53/lq9lMXN57S8cFz0MynJk8OWNuUnXct/9KCpKU7DgU3bYMJhwWmcqC0UU29p8Lr0/7KEVcaM6bf47Q==",
       "cpu": [
         "x64"
       ],
@@ -2827,10 +2965,12 @@
       ]
     },
     "node_modules/@swc/helpers": {
-      "version": "0.5.3",
+      "version": "0.5.17",
+      "resolved": "https://registry.npmjs.org/@swc/helpers/-/helpers-0.5.17.tgz",
+      "integrity": "sha512-5IKx/Y13RsYd+sauPb2x+U/xZikHjolzfuDgTAl/Tdf3Q8rslRvC19NKDLgAJQ6wsqADk10ntlv08nPFw/gO/A==",
       "license": "Apache-2.0",
       "dependencies": {
-        "tslib": "^2.4.0"
+        "tslib": "^2.8.0"
       }
     },
     "node_modules/@types/babel__core": {
@@ -2838,6 +2978,7 @@
       "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
       "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
         "@babel/parser": "^7.20.7",
         "@babel/types": "^7.20.7",
@@ -2847,10 +2988,11 @@
       }
     },
     "node_modules/@types/babel__generator": {
-      "version": "7.6.8",
-      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.6.8.tgz",
-      "integrity": "sha512-ASsj+tpEDsEiFr1arWrlN6V3mdfjRMZt6LtK/Vp/kreFLnr5QH5+DhvD5nINYZXzwJvXeGq+05iUXcAzVrqWtw==",
+      "version": "7.27.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
+      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
         "@babel/types": "^7.0.0"
       }
@@ -2860,18 +3002,20 @@
       "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
       "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
         "@babel/parser": "^7.1.0",
         "@babel/types": "^7.0.0"
       }
     },
     "node_modules/@types/babel__traverse": {
-      "version": "7.20.6",
-      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.20.6.tgz",
-      "integrity": "sha512-r1bzfrm0tomOI8g1SzvCaQHo6Lcv6zu0EA+W2kHrt8dyrHQxGzBBL4kdkzIS+jBMV+EYcMAEAqXqYaLJq5rOZg==",
+      "version": "7.28.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
+      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
-        "@babel/types": "^7.20.7"
+        "@babel/types": "^7.28.2"
       }
     },
     "node_modules/@types/debug": {
@@ -2887,13 +3031,15 @@
       "version": "0.0.4",
       "resolved": "https://registry.npmjs.org/@types/dom-speech-recognition/-/dom-speech-recognition-0.0.4.tgz",
       "integrity": "sha512-zf2GwV/G6TdaLwpLDcGTIkHnXf8JEf/viMux+khqKQKDa8/8BAUtXXZS563GnvJ4Fg0PBLGAaFf2GekEVSZ6GQ==",
-      "dev": true
+      "dev": true,
+      "license": "MIT"
     },
     "node_modules/@types/dompurify": {
       "version": "3.0.5",
       "resolved": "https://registry.npmjs.org/@types/dompurify/-/dompurify-3.0.5.tgz",
       "integrity": "sha512-1Wg0g3BtQF7sSb27fJQAKck1HECM6zV1EB66j8JH9i3LCjYabJa0FSdiSgsD5K/RbrsR0SiraKacLB+T8ZVYAg==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
         "@types/trusted-types": "*"
       }
@@ -2914,10 +3060,12 @@
       }
     },
     "node_modules/@types/hast": {
-      "version": "2.3.7",
+      "version": "3.0.4",
+      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
+      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
       "license": "MIT",
       "dependencies": {
-        "@types/unist": "^2"
+        "@types/unist": "*"
       }
     },
     "node_modules/@types/mdast": {
@@ -2930,30 +3078,34 @@
       }
     },
     "node_modules/@types/ms": {
-      "version": "0.7.34",
-      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-0.7.34.tgz",
-      "integrity": "sha512-nG96G3Wp6acyAgJqGasjODb+acrI7KltPiRxzHPXnP3NgI28bpQDRv53olbqGXbfcgF5aiiHmO3xpwEpS5Ld9g==",
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
+      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
       "license": "MIT"
     },
     "node_modules/@types/prop-types": {
-      "version": "15.7.5",
+      "version": "15.7.15",
+      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
+      "integrity": "sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==",
       "license": "MIT"
     },
     "node_modules/@types/react": {
-      "version": "18.3.12",
-      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.12.tgz",
-      "integrity": "sha512-D2wOSq/d6Agt28q7rSI3jhU7G6aiuzljDGZ2hTZHIkrTLUI+AF3WMeKkEZ9nN2fkBAlcktT6vcZjDFiIhMYEQw==",
+      "version": "18.3.23",
+      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.23.tgz",
+      "integrity": "sha512-/LDXMQh55EzZQ0uVAZmKKhfENivEvWz6E+EYzh+/MCjMhNsotd+ZHhBGIjFDTi6+fz0OhQQQLbTgdQIxxCsC0w==",
+      "license": "MIT",
       "dependencies": {
         "@types/prop-types": "*",
         "csstype": "^3.0.2"
       }
     },
     "node_modules/@types/react-dom": {
-      "version": "18.3.1",
-      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.1.tgz",
-      "integrity": "sha512-qW1Mfv8taImTthu4KoXgDfLuk4bydU6Q/TkADnDWWHwi4NX4BR+LWfTp2sVmTqRrsHvyDDTelgelxJ+SsejKKQ==",
-      "dependencies": {
-        "@types/react": "*"
+      "version": "18.3.7",
+      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz",
+      "integrity": "sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@types/react": "^18.0.0"
       }
     },
     "node_modules/@types/react-syntax-highlighter": {
@@ -2961,6 +3113,7 @@
       "resolved": "https://registry.npmjs.org/@types/react-syntax-highlighter/-/react-syntax-highlighter-15.5.13.tgz",
       "integrity": "sha512-uLGJ87j6Sz8UaBAooU0T6lWJ0dBmjZgN1PZTrj05TNql2/XpC6+4HhMT5syIdFUUt+FASfCeLLv4kBygNU+8qA==",
       "dev": true,
+      "license": "MIT",
       "dependencies": {
         "@types/react": "*"
       }
@@ -2973,13 +3126,15 @@
       "license": "MIT"
     },
     "node_modules/@types/unist": {
-      "version": "2.0.7",
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
+      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
       "license": "MIT"
     },
     "node_modules/@ungap/structured-clone": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/@ungap/structured-clone/-/structured-clone-1.2.0.tgz",
-      "integrity": "sha512-zuVdFrMJiuCDQUMCzQaD6KL28MjnqqN8XnAqiEq9PNm/hCPTSGfrXCOfwj1ow4LFb/tNymJPwsNbVePc1xFqrQ==",
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/@ungap/structured-clone/-/structured-clone-1.3.0.tgz",
+      "integrity": "sha512-WmoN8qaIAo7WTYWbAZuG8PYEhn5fkz7dZrqTBZ7dtt//lL2Gwms1IcnQ5yHqjDfX8Ft5j4YzDM23f87zBfDe9g==",
       "license": "ISC"
     },
     "node_modules/@vitejs/plugin-react": {
@@ -3013,6 +3168,18 @@
         "node": ">=8"
       }
     },
+    "node_modules/ansi-styles": {
+      "version": "3.2.1",
+      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-3.2.1.tgz",
+      "integrity": "sha512-VT0ZI6kZRdTh8YyJw3SMbYm/u+NqfsAxEpWO0Pf9sq8/e94WxxOpPKx9FR1FlyCtOVDNOQ+8ntlqFxiRc+r5qA==",
+      "dev": true,
+      "dependencies": {
+        "color-convert": "^1.9.0"
+      },
+      "engines": {
+        "node": ">=4"
+      }
+    },
     "node_modules/bail": {
       "version": "2.0.2",
       "resolved": "https://registry.npmjs.org/bail/-/bail-2.0.2.tgz",
@@ -3057,9 +3224,9 @@
       }
     },
     "node_modules/caniuse-lite": {
-      "version": "1.0.30001727",
-      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001727.tgz",
-      "integrity": "sha512-pB68nIHmbN6L/4C6MH1DokyR3bYqFwjaSs/sWDHGj4CTcFtQUQMuJftVwWkXq7mNWOybD3KhUv3oWHoGxgP14Q==",
+      "version": "1.0.30001667",
+      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001667.tgz",
+      "integrity": "sha512-7LTwJjcRkzKFmtqGsibMeuXmvFDfZq/nzIjnmgCGzKKRVzjD72selLDK1oPF/Oxzmt4fNcPvTDvGqSDG4tCALw==",
       "dev": true,
       "funding": [
         {
@@ -3088,7 +3255,9 @@
       }
     },
     "node_modules/character-entities": {
-      "version": "1.2.4",
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-2.0.2.tgz",
+      "integrity": "sha512-shx7oQ0Awen/BRIdkjkvz54PnEEI/EjwXDSIZp86/KKdbafHh1Df/RYGBhn4hbe2+uKC9FnT5UCEdyPz3ai9hQ==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3106,7 +3275,9 @@
       }
     },
     "node_modules/character-entities-legacy": {
-      "version": "1.1.4",
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/character-entities-legacy/-/character-entities-legacy-3.0.0.tgz",
+      "integrity": "sha512-RpPp0asT/6ufRm//AJVwpViZbGM/MkjQFxJccQRHmISF/22NBtsHqAWmL+/pmkPWoIUJdWyeVleTl1wydHATVQ==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3114,7 +3285,9 @@
       }
     },
     "node_modules/character-reference-invalid": {
-      "version": "1.1.4",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/character-reference-invalid/-/character-reference-invalid-2.0.1.tgz",
+      "integrity": "sha512-iBZ4F4wRbyORVsu0jPV7gXkOsGYjGHPmAyv+HiHG8gi5PtC9KI2j1+v8/tlibRvjoWX027ypmG/n0HtO5t7unw==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3136,8 +3309,25 @@
         "node": ">=12"
       }
     },
+    "node_modules/color-convert": {
+      "version": "1.9.3",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-1.9.3.tgz",
+      "integrity": "sha512-QfAUtd+vFdAtFQcC8CCyYt1fYWxSqAiK2cSD6zDB8N3cpsEBAvRxp9zOGg6G/SHHJYAT88/az/IuDGALsNVbGg==",
+      "dev": true,
+      "dependencies": {
+        "color-name": "1.1.3"
+      }
+    },
+    "node_modules/color-name": {
+      "version": "1.1.3",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.3.tgz",
+      "integrity": "sha512-72fSenhMw2HZMTVHeCA9KCmpEIbzWiQsjN+BHcBbS9vr1mtt+vJjPdksIBNUmKAW8TFUDPJK5SUU3QhE9NEXDw==",
+      "dev": true
+    },
     "node_modules/comma-separated-tokens": {
-      "version": "1.0.8",
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/comma-separated-tokens/-/comma-separated-tokens-2.0.3.tgz",
+      "integrity": "sha512-Fu4hJdvzeylCfQPp9SGWidpzrMs7tTrlu6Vb8XGaRGck8QSNZJJp538Wrb60Lax4fPwR64ViY468OIUTbRlGZg==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3167,11 +3357,12 @@
       "license": "MIT"
     },
     "node_modules/debug": {
-      "version": "4.3.5",
-      "resolved": "https://registry.npmjs.org/debug/-/debug-4.3.5.tgz",
-      "integrity": "sha512-pt0bNEmneDIvdL1Xsd9oDQ/wrQRkXDT4AUWlNZNPKvW5x/jyO9VFXkJUP07vQ2upmw5PlaITaPKc31jK13V+jg==",
+      "version": "4.4.1",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.1.tgz",
+      "integrity": "sha512-KcKCqiftBJcZr++7ykoDIEwSa3XWowTfNPo92BYxjXiyYEVrUQh2aLyhxBCwww+heortUFxEJYcRzosstTEBYQ==",
+      "license": "MIT",
       "dependencies": {
-        "ms": "2.1.2"
+        "ms": "^2.1.3"
       },
       "engines": {
         "node": ">=6.0"
@@ -3183,9 +3374,9 @@
       }
     },
     "node_modules/decode-named-character-reference": {
-      "version": "1.0.2",
-      "resolved": "https://registry.npmjs.org/decode-named-character-reference/-/decode-named-character-reference-1.0.2.tgz",
-      "integrity": "sha512-O8x12RzrUF8xyVcY0KJowWsmaJxQbmy0/EtnNtHRpsOcT7dFk5W598coHqBVpmWo1oQQfsCqfCmkZN5DJrZVdg==",
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/decode-named-character-reference/-/decode-named-character-reference-1.2.0.tgz",
+      "integrity": "sha512-c6fcElNV6ShtZXmsgNgFFV5tVX2PaV4g+MOAkb8eXHvn6sryJBrZa9r0zV6+dtTyoCKxtDy5tyQ5ZwQuidtd+Q==",
       "license": "MIT",
       "dependencies": {
         "character-entities": "^2.0.0"
@@ -3195,21 +3386,11 @@
         "url": "https://github.com/sponsors/wooorm"
       }
     },
-    "node_modules/decode-named-character-reference/node_modules/character-entities": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-2.0.2.tgz",
-      "integrity": "sha512-shx7oQ0Awen/BRIdkjkvz54PnEEI/EjwXDSIZp86/KKdbafHh1Df/RYGBhn4hbe2+uKC9FnT5UCEdyPz3ai9hQ==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/define-lazy-prop": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz",
-      "integrity": "sha512-Ds09qNh8yw3khSjiJjiUInaGX9xlqZDY7JVryGxdxV7NPeuqQfplOpQ66yJFZut3jLa5zOwkXw1g9EI2uKh4Og==",
-      "dev": true,
+    "node_modules/define-lazy-prop": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz",
+      "integrity": "sha512-Ds09qNh8yw3khSjiJjiUInaGX9xlqZDY7JVryGxdxV7NPeuqQfplOpQ66yJFZut3jLa5zOwkXw1g9EI2uKh4Og==",
+      "dev": true,
       "license": "MIT",
       "engines": {
         "node": ">=8"
@@ -3241,46 +3422,49 @@
       "version": "5.2.1",
       "resolved": "https://registry.npmjs.org/dom-helpers/-/dom-helpers-5.2.1.tgz",
       "integrity": "sha512-nRCa7CK3VTrM2NmGkIy4cbK7IZlgBE/PYMn55rrXefr5xXDP0LdtfPnblFDoVdcAfslJ7or6iqAUnx0CCGIWQA==",
+      "license": "MIT",
       "dependencies": {
         "@babel/runtime": "^7.8.7",
         "csstype": "^3.0.2"
       }
     },
     "node_modules/dompurify": {
-      "version": "3.2.4",
-      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.2.4.tgz",
-      "integrity": "sha512-ysFSFEDVduQpyhzAob/kkuJjf5zWkZD8/A9ywSp1byueyuCfHamrCBa14/Oc2iiB0e51B+NpxSl5gmzn+Ms/mg==",
+      "version": "3.2.6",
+      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.2.6.tgz",
+      "integrity": "sha512-/2GogDQlohXPZe6D6NOgQvXLPSYBqIWMnZ8zzOhn09REE4eyAzb+Hed3jhoM9OkuaJ8P6ZGTTVWQKAi8ieIzfQ==",
       "license": "(MPL-2.0 OR Apache-2.0)",
       "optionalDependencies": {
         "@types/trusted-types": "^2.0.7"
       }
     },
     "node_modules/electron-to-chromium": {
-      "version": "1.5.191",
-      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.191.tgz",
-      "integrity": "sha512-xcwe9ELcuxYLUFqZZxL19Z6HVKcvNkIwhbHUz7L3us6u12yR+7uY89dSl570f/IqNthx8dAw3tojG7i4Ni4tDA==",
-      "dev": true,
-      "license": "ISC"
+      "version": "1.5.32",
+      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.32.tgz",
+      "integrity": "sha512-M+7ph0VGBQqqpTT2YrabjNKSQ2fEl9PVx6AK3N558gDH9NO8O6XN9SXXFWRo9u9PbEg/bWq+tjXQr+eXmxubCw==",
+      "dev": true
     },
     "node_modules/embla-carousel": {
-      "version": "8.4.0",
-      "resolved": "https://registry.npmjs.org/embla-carousel/-/embla-carousel-8.4.0.tgz",
-      "integrity": "sha512-sUzm4DGGsdZCom7LEO38Uu6C7oQoFfPorKDf/f7j2EeRCMhHSOt3CvF+pHCaI6N+x5Y8/tfLueJ0WZlgUREnew=="
+      "version": "8.6.0",
+      "resolved": "https://registry.npmjs.org/embla-carousel/-/embla-carousel-8.6.0.tgz",
+      "integrity": "sha512-SjWyZBHJPbqxHOzckOfo8lHisEaJWmwd23XppYFYVh10bU66/Pn5tkVkbkCMZVdbUE5eTCI2nD8OyIP4Z+uwkA==",
+      "license": "MIT"
     },
     "node_modules/embla-carousel-autoplay": {
-      "version": "8.4.0",
-      "resolved": "https://registry.npmjs.org/embla-carousel-autoplay/-/embla-carousel-autoplay-8.4.0.tgz",
-      "integrity": "sha512-AJHXrnaY+Tf4tb/+oItmJSpz4P0WvS62GrW5Z4iFY3zsH0mkKcijzd04LIkj0P4DkTazIBEuXple+nUVmuMsrQ==",
+      "version": "8.6.0",
+      "resolved": "https://registry.npmjs.org/embla-carousel-autoplay/-/embla-carousel-autoplay-8.6.0.tgz",
+      "integrity": "sha512-OBu5G3nwaSXkZCo1A6LTaFMZ8EpkYbwIaH+bPqdBnDGQ2fh4+NbzjXjs2SktoPNKCtflfVMc75njaDHOYXcrsA==",
+      "license": "MIT",
       "peerDependencies": {
-        "embla-carousel": "8.4.0"
+        "embla-carousel": "8.6.0"
       }
     },
     "node_modules/embla-carousel-fade": {
-      "version": "8.4.0",
-      "resolved": "https://registry.npmjs.org/embla-carousel-fade/-/embla-carousel-fade-8.4.0.tgz",
-      "integrity": "sha512-d2/Pk/gHnlLCwE0MuwjLxLn22ngTf1rS17KT+TsYctVCApvDvxwgn5bDrwSpwg4BZhO4+xIrWw293rAHjCDewQ==",
+      "version": "8.6.0",
+      "resolved": "https://registry.npmjs.org/embla-carousel-fade/-/embla-carousel-fade-8.6.0.tgz",
+      "integrity": "sha512-qaYsx5mwCz72ZrjlsXgs1nKejSrW+UhkbOMwLgfRT7w2LtdEB03nPRI06GHuHv5ac2USvbEiX2/nAHctcDwvpg==",
+      "license": "MIT",
       "peerDependencies": {
-        "embla-carousel": "8.4.0"
+        "embla-carousel": "8.6.0"
       }
     },
     "node_modules/emoji-regex": {
@@ -3291,9 +3475,9 @@
       "license": "MIT"
     },
     "node_modules/entities": {
-      "version": "4.5.0",
-      "resolved": "https://registry.npmjs.org/entities/-/entities-4.5.0.tgz",
-      "integrity": "sha512-V0hjH4dGPh9Ao5p0MoRY6BVqtwCjhz6vI5LT8AJ55H+4g9/4vbHx1I54fS0XuclLhDHArPQCiMjDxjaL8fPxhw==",
+      "version": "6.0.1",
+      "resolved": "https://registry.npmjs.org/entities/-/entities-6.0.1.tgz",
+      "integrity": "sha512-aN97NXWF6AWBTahfVOIrB/NShkzi5H7F9r1s9mD3cDj4Ko5f2qhhVoYMibXF7GlLveb/D2ioWay8lxI97Ven3g==",
       "license": "BSD-2-Clause",
       "engines": {
         "node": ">=0.12"
@@ -3346,10 +3530,20 @@
       "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
       "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
       "dev": true,
+      "license": "MIT",
       "engines": {
         "node": ">=6"
       }
     },
+    "node_modules/escape-string-regexp": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-1.0.5.tgz",
+      "integrity": "sha512-vbRorB5FUQWvla16U8R/qgaFIya2qGzwDrNmCZuYKrbdSUMG6I1ZCGQRefkRVhuOkIGVne7BQ35DSfo1qvJqFg==",
+      "dev": true,
+      "engines": {
+        "node": ">=0.8.0"
+      }
+    },
     "node_modules/estree-util-is-identifier-name": {
       "version": "3.0.0",
       "resolved": "https://registry.npmjs.org/estree-util-is-identifier-name/-/estree-util-is-identifier-name-3.0.0.tgz",
@@ -3368,6 +3562,8 @@
     },
     "node_modules/fault": {
       "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/fault/-/fault-1.0.4.tgz",
+      "integrity": "sha512-CJ0HCB5tL5fYTEA7ToAq5+kTwd++Borf1/bifxd9iT70QcXr4MRrO3Llf8Ifs70q+SJcGHFtnIE/Nw6giCtECA==",
       "license": "MIT",
       "dependencies": {
         "format": "^0.2.0"
@@ -3379,6 +3575,8 @@
     },
     "node_modules/format": {
       "version": "0.2.2",
+      "resolved": "https://registry.npmjs.org/format/-/format-0.2.2.tgz",
+      "integrity": "sha512-wzsgA6WOq+09wrU1tsJ09udeR/YZRaeArL9e1wPbFg3GG2yDnC2ldKpxs4xunpFF9DgqCqOIra3bc1HWrJ37Ww==",
       "engines": {
         "node": ">=0.4.x"
       }
@@ -3389,6 +3587,7 @@
       "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
       "dev": true,
       "hasInstallScript": true,
+      "license": "MIT",
       "optional": true,
       "os": [
         "darwin"
@@ -3418,16 +3617,16 @@
       }
     },
     "node_modules/hast-util-from-parse5": {
-      "version": "8.0.1",
-      "resolved": "https://registry.npmjs.org/hast-util-from-parse5/-/hast-util-from-parse5-8.0.1.tgz",
-      "integrity": "sha512-Er/Iixbc7IEa7r/XLtuG52zoqn/b3Xng/w6aZQ0xGVxzhw5xUFxcRqdPzP6yFi/4HBYRaifaI5fQ1RH8n0ZeOQ==",
+      "version": "8.0.3",
+      "resolved": "https://registry.npmjs.org/hast-util-from-parse5/-/hast-util-from-parse5-8.0.3.tgz",
+      "integrity": "sha512-3kxEVkEKt0zvcZ3hCRYI8rqrgwtlIOFMWkbclACvjlDw8Li9S2hk/d51OI0nr/gIpdMHNepwgOKqZ/sy0Clpyg==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^3.0.0",
         "@types/unist": "^3.0.0",
         "devlop": "^1.0.0",
-        "hastscript": "^8.0.0",
-        "property-information": "^6.0.0",
+        "hastscript": "^9.0.0",
+        "property-information": "^7.0.0",
         "vfile": "^6.0.0",
         "vfile-location": "^5.0.0",
         "web-namespaces": "^2.0.0"
@@ -3437,31 +3636,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-from-parse5/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
-    "node_modules/hast-util-from-parse5/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/hast-util-from-parse5/node_modules/comma-separated-tokens": {
-      "version": "2.0.3",
-      "resolved": "https://registry.npmjs.org/comma-separated-tokens/-/comma-separated-tokens-2.0.3.tgz",
-      "integrity": "sha512-Fu4hJdvzeylCfQPp9SGWidpzrMs7tTrlu6Vb8XGaRGck8QSNZJJp538Wrb60Lax4fPwR64ViY468OIUTbRlGZg==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/hast-util-from-parse5/node_modules/hast-util-parse-selector": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/hast-util-parse-selector/-/hast-util-parse-selector-4.0.0.tgz",
@@ -3476,15 +3650,15 @@
       }
     },
     "node_modules/hast-util-from-parse5/node_modules/hastscript": {
-      "version": "8.0.0",
-      "resolved": "https://registry.npmjs.org/hastscript/-/hastscript-8.0.0.tgz",
-      "integrity": "sha512-dMOtzCEd3ABUeSIISmrETiKuyydk1w0pa+gE/uormcTpSYuaNJPbX1NU3JLyscSLjwAQM8bWMhhIlnCqnRvDTw==",
+      "version": "9.0.1",
+      "resolved": "https://registry.npmjs.org/hastscript/-/hastscript-9.0.1.tgz",
+      "integrity": "sha512-g7df9rMFX/SPi34tyGCyUBREQoKkapwdY/T04Qn9TDWfHhAYt4/I0gMVirzK5wEzeUqIjEB+LXC/ypb7Aqno5w==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^3.0.0",
         "comma-separated-tokens": "^2.0.0",
         "hast-util-parse-selector": "^4.0.0",
-        "property-information": "^6.0.0",
+        "property-information": "^7.0.0",
         "space-separated-tokens": "^2.0.0"
       },
       "funding": {
@@ -3492,28 +3666,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-from-parse5/node_modules/property-information": {
-      "version": "6.5.0",
-      "resolved": "https://registry.npmjs.org/property-information/-/property-information-6.5.0.tgz",
-      "integrity": "sha512-PgTgs/BlvHxOu8QuEN7wi5A0OmXaBcHpmCSTehcs6Uuu9IkDIEo13Hy7n898RHfrQ49vKCoGeWZSaAK01nwVig==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/hast-util-from-parse5/node_modules/space-separated-tokens": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/space-separated-tokens/-/space-separated-tokens-2.0.2.tgz",
-      "integrity": "sha512-PEGlAwrG8yXGXRjW32fGbg66JAlOAwbObuqVoJpv/mRgoWDQfgH1wDPvtzWyUSNAXBGSk8h755YDbbcEy3SH2Q==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/hast-util-parse-selector": {
       "version": "2.2.5",
+      "resolved": "https://registry.npmjs.org/hast-util-parse-selector/-/hast-util-parse-selector-2.2.5.tgz",
+      "integrity": "sha512-7j6mrk/qqkSehsM92wQjdIgWM2/BW61u/53G6xmC8i1OmEdKLHbk419QKQUjz6LglWsfqoiHmyMRkP1BGjecNQ==",
       "license": "MIT",
       "funding": {
         "type": "opencollective",
@@ -3521,9 +3677,9 @@
       }
     },
     "node_modules/hast-util-raw": {
-      "version": "9.0.4",
-      "resolved": "https://registry.npmjs.org/hast-util-raw/-/hast-util-raw-9.0.4.tgz",
-      "integrity": "sha512-LHE65TD2YiNsHD3YuXcKPHXPLuYh/gjp12mOfU8jxSrm1f/yJpsb0F/KKljS6U9LJoP0Ux+tCe8iJ2AsPzTdgA==",
+      "version": "9.1.0",
+      "resolved": "https://registry.npmjs.org/hast-util-raw/-/hast-util-raw-9.1.0.tgz",
+      "integrity": "sha512-Y8/SBAHkZGoNkpzqqfCldijcuUKh7/su31kEBp67cFY09Wy0mTRgtsLYsiIxMJxlu0f6AA5SUTbDR8K0rxnbUw==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^3.0.0",
@@ -3545,25 +3701,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-raw/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
-    "node_modules/hast-util-raw/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/hast-util-to-jsx-runtime": {
-      "version": "2.3.0",
-      "resolved": "https://registry.npmjs.org/hast-util-to-jsx-runtime/-/hast-util-to-jsx-runtime-2.3.0.tgz",
-      "integrity": "sha512-H/y0+IWPdsLLS738P8tDnrQ8Z+dj12zQQ6WC11TIM21C8WFVoIxcqWXf2H3hiTVZjF1AWqoimGwrTWecWrnmRQ==",
+      "version": "2.3.6",
+      "resolved": "https://registry.npmjs.org/hast-util-to-jsx-runtime/-/hast-util-to-jsx-runtime-2.3.6.tgz",
+      "integrity": "sha512-zl6s8LwNyo1P9uw+XJGvZtdFF1GdAkOg8ujOw+4Pyb76874fLps4ueHXDhXWdk6YHQ6OgUtinliG7RsYvCbbBg==",
       "license": "MIT",
       "dependencies": {
         "@types/estree": "^1.0.0",
@@ -3576,9 +3717,9 @@
         "mdast-util-mdx-expression": "^2.0.0",
         "mdast-util-mdx-jsx": "^3.0.0",
         "mdast-util-mdxjs-esm": "^2.0.0",
-        "property-information": "^6.0.0",
+        "property-information": "^7.0.0",
         "space-separated-tokens": "^2.0.0",
-        "style-to-object": "^1.0.0",
+        "style-to-js": "^1.0.0",
         "unist-util-position": "^5.0.0",
         "vfile-message": "^4.0.0"
       },
@@ -3587,51 +3728,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-to-jsx-runtime/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
-    "node_modules/hast-util-to-jsx-runtime/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/hast-util-to-jsx-runtime/node_modules/comma-separated-tokens": {
-      "version": "2.0.3",
-      "resolved": "https://registry.npmjs.org/comma-separated-tokens/-/comma-separated-tokens-2.0.3.tgz",
-      "integrity": "sha512-Fu4hJdvzeylCfQPp9SGWidpzrMs7tTrlu6Vb8XGaRGck8QSNZJJp538Wrb60Lax4fPwR64ViY468OIUTbRlGZg==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/hast-util-to-jsx-runtime/node_modules/property-information": {
-      "version": "6.5.0",
-      "resolved": "https://registry.npmjs.org/property-information/-/property-information-6.5.0.tgz",
-      "integrity": "sha512-PgTgs/BlvHxOu8QuEN7wi5A0OmXaBcHpmCSTehcs6Uuu9IkDIEo13Hy7n898RHfrQ49vKCoGeWZSaAK01nwVig==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/hast-util-to-jsx-runtime/node_modules/space-separated-tokens": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/space-separated-tokens/-/space-separated-tokens-2.0.2.tgz",
-      "integrity": "sha512-PEGlAwrG8yXGXRjW32fGbg66JAlOAwbObuqVoJpv/mRgoWDQfgH1wDPvtzWyUSNAXBGSk8h755YDbbcEy3SH2Q==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/hast-util-to-parse5": {
       "version": "8.0.0",
       "resolved": "https://registry.npmjs.org/hast-util-to-parse5/-/hast-util-to-parse5-8.0.0.tgz",
@@ -3651,25 +3747,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-to-parse5/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
-    "node_modules/hast-util-to-parse5/node_modules/comma-separated-tokens": {
-      "version": "2.0.3",
-      "resolved": "https://registry.npmjs.org/comma-separated-tokens/-/comma-separated-tokens-2.0.3.tgz",
-      "integrity": "sha512-Fu4hJdvzeylCfQPp9SGWidpzrMs7tTrlu6Vb8XGaRGck8QSNZJJp538Wrb60Lax4fPwR64ViY468OIUTbRlGZg==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/hast-util-to-parse5/node_modules/property-information": {
       "version": "6.5.0",
       "resolved": "https://registry.npmjs.org/property-information/-/property-information-6.5.0.tgz",
@@ -3680,16 +3757,6 @@
         "url": "https://github.com/sponsors/wooorm"
       }
     },
-    "node_modules/hast-util-to-parse5/node_modules/space-separated-tokens": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/space-separated-tokens/-/space-separated-tokens-2.0.2.tgz",
-      "integrity": "sha512-PEGlAwrG8yXGXRjW32fGbg66JAlOAwbObuqVoJpv/mRgoWDQfgH1wDPvtzWyUSNAXBGSk8h755YDbbcEy3SH2Q==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/hast-util-whitespace": {
       "version": "3.0.0",
       "resolved": "https://registry.npmjs.org/hast-util-whitespace/-/hast-util-whitespace-3.0.0.tgz",
@@ -3703,17 +3770,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/hast-util-whitespace/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/hastscript": {
       "version": "6.0.0",
+      "resolved": "https://registry.npmjs.org/hastscript/-/hastscript-6.0.0.tgz",
+      "integrity": "sha512-nDM6bvd7lIqDUiYEiu5Sl/+6ReP0BMk/2f4U/Rooccxkj0P5nm+acM5PrGJ/t5I8qPGiqZSE6hVAwZEdZIvP4w==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^2.0.0",
@@ -3727,8 +3787,58 @@
         "url": "https://opencollective.com/unified"
       }
     },
+    "node_modules/hastscript/node_modules/@types/hast": {
+      "version": "2.3.10",
+      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-2.3.10.tgz",
+      "integrity": "sha512-McWspRw8xx8J9HurkVBfYj0xKoE25tOFlHGdx4MJ5xORQrMGZNqJhVQWaIbm6Oyla5kYOXtDiopzKRJzEOkwJw==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/unist": "^2"
+      }
+    },
+    "node_modules/hastscript/node_modules/@types/unist": {
+      "version": "2.0.11",
+      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-2.0.11.tgz",
+      "integrity": "sha512-CmBKiL6NNo/OqgmMn95Fk9Whlp2mtvIv+KNpQKN2F4SjvrEesubTRWGYSg+BnWZOnlCaSTU1sMpsBOzgbYhnsA==",
+      "license": "MIT"
+    },
+    "node_modules/hastscript/node_modules/comma-separated-tokens": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/comma-separated-tokens/-/comma-separated-tokens-1.0.8.tgz",
+      "integrity": "sha512-GHuDRO12Sypu2cV70d1dkA2EUmXHgntrzbpvOB+Qy+49ypNfGgFQIC2fhhXbnyrJRynDCAARsT7Ou0M6hirpfw==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/hastscript/node_modules/property-information": {
+      "version": "5.6.0",
+      "resolved": "https://registry.npmjs.org/property-information/-/property-information-5.6.0.tgz",
+      "integrity": "sha512-YUHSPk+A30YPv+0Qf8i9Mbfe/C0hdPXk1s1jPVToV8pk8BQtpw10ct89Eo7OWkutrwqvT0eicAxlOg3dOAu8JA==",
+      "license": "MIT",
+      "dependencies": {
+        "xtend": "^4.0.0"
+      },
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/hastscript/node_modules/space-separated-tokens": {
+      "version": "1.1.5",
+      "resolved": "https://registry.npmjs.org/space-separated-tokens/-/space-separated-tokens-1.1.5.tgz",
+      "integrity": "sha512-q/JSVd1Lptzhf5bkYm4ob4iWPjx0KiRe3sRFBNrVqbJkFaBm5vbbowy1mymoPNLRa52+oadOhJ+K49wsSeSjTA==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
     "node_modules/highlight.js": {
       "version": "10.7.3",
+      "resolved": "https://registry.npmjs.org/highlight.js/-/highlight.js-10.7.3.tgz",
+      "integrity": "sha512-tzcUFauisWKNHaRkN4Wjl/ZA07gENAjFl3J/c480dprkGTg5EQstgaNFqBfUqCq54kZRIEcreTsAgF/m2quD7A==",
       "license": "BSD-3-Clause",
       "engines": {
         "node": "*"
@@ -3737,7 +3847,8 @@
     "node_modules/highlightjs-vue": {
       "version": "1.0.0",
       "resolved": "https://registry.npmjs.org/highlightjs-vue/-/highlightjs-vue-1.0.0.tgz",
-      "integrity": "sha512-PDEfEF102G23vHmPhLyPboFCD+BkMGu+GuJe2d9/eH4FsCwvgBpnc9n0pGE+ffKdph38s6foEZiEjdgHdzp+IA=="
+      "integrity": "sha512-PDEfEF102G23vHmPhLyPboFCD+BkMGu+GuJe2d9/eH4FsCwvgBpnc9n0pGE+ffKdph38s6foEZiEjdgHdzp+IA==",
+      "license": "CC0-1.0"
     },
     "node_modules/html-parse-stringify": {
       "version": "3.0.1",
@@ -3749,9 +3860,9 @@
       }
     },
     "node_modules/html-url-attributes": {
-      "version": "3.0.0",
-      "resolved": "https://registry.npmjs.org/html-url-attributes/-/html-url-attributes-3.0.0.tgz",
-      "integrity": "sha512-/sXbVCWayk6GDVg3ctOX6nxaVj7So40FcFAnWlWGNAB1LpYKcV5Cd10APjPjW80O7zYW2MsjBV4zZ7IZO5fVow==",
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/html-url-attributes/-/html-url-attributes-3.0.1.tgz",
+      "integrity": "sha512-ol6UPyBWqsrO6EJySPz2O7ZSr856WDrEzM5zMqp+FJJLGMW35cLYmmZnl0vztAZxRUoNZJFTCohfjuIJ8I4QBQ==",
       "license": "MIT",
       "funding": {
         "type": "opencollective",
@@ -3769,9 +3880,9 @@
       }
     },
     "node_modules/i18next": {
-      "version": "24.2.0",
-      "resolved": "https://registry.npmjs.org/i18next/-/i18next-24.2.0.tgz",
-      "integrity": "sha512-ArJJTS1lV6lgKH7yEf4EpgNZ7+THl7bsGxxougPYiXRTJ/Fe1j08/TBpV9QsXCIYVfdE/HWG/xLezJ5DOlfBOA==",
+      "version": "24.2.3",
+      "resolved": "https://registry.npmjs.org/i18next/-/i18next-24.2.3.tgz",
+      "integrity": "sha512-lfbf80OzkocvX7nmZtu7nSTNbrTYR52sLWxPtlXX1zAhVw8WEnFk4puUkCR4B1dNQwbSpEHHHemcZu//7EcB7A==",
       "funding": [
         {
           "type": "individual",
@@ -3786,8 +3897,9 @@
           "url": "https://www.i18next.com/how-to/faq#i18next-is-awesome.-how-can-i-support-the-project"
         }
       ],
+      "license": "MIT",
       "dependencies": {
-        "@babel/runtime": "^7.23.2"
+        "@babel/runtime": "^7.26.10"
       },
       "peerDependencies": {
         "typescript": "^5"
@@ -3799,30 +3911,33 @@
       }
     },
     "node_modules/i18next-browser-languagedetector": {
-      "version": "8.0.2",
-      "resolved": "https://registry.npmjs.org/i18next-browser-languagedetector/-/i18next-browser-languagedetector-8.0.2.tgz",
-      "integrity": "sha512-shBvPmnIyZeD2VU5jVGIOWP7u9qNG3Lj7mpaiPFpbJ3LVfHZJvVzKR4v1Cb91wAOFpNw442N+LGPzHOHsten2g==",
+      "version": "8.2.0",
+      "resolved": "https://registry.npmjs.org/i18next-browser-languagedetector/-/i18next-browser-languagedetector-8.2.0.tgz",
+      "integrity": "sha512-P+3zEKLnOF0qmiesW383vsLdtQVyKtCNA9cjSoKCppTKPQVfKd2W8hbVo5ZhNJKDqeM7BOcvNoKJOjpHh4Js9g==",
+      "license": "MIT",
       "dependencies": {
         "@babel/runtime": "^7.23.2"
       }
     },
     "node_modules/i18next-http-backend": {
-      "version": "3.0.1",
-      "resolved": "https://registry.npmjs.org/i18next-http-backend/-/i18next-http-backend-3.0.1.tgz",
-      "integrity": "sha512-XT2lYSkbAtDE55c6m7CtKxxrsfuRQO3rUfHzj8ZyRtY9CkIX3aRGwXGTkUhpGWce+J8n7sfu3J0f2wTzo7Lw0A==",
+      "version": "3.0.2",
+      "resolved": "https://registry.npmjs.org/i18next-http-backend/-/i18next-http-backend-3.0.2.tgz",
+      "integrity": "sha512-PdlvPnvIp4E1sYi46Ik4tBYh/v/NbYfFFgTjkwFl0is8A18s7/bx9aXqsrOax9WUbeNS6mD2oix7Z0yGGf6m5g==",
+      "license": "MIT",
       "dependencies": {
         "cross-fetch": "4.0.0"
       }
     },
     "node_modules/idb": {
-      "version": "8.0.0",
-      "resolved": "https://registry.npmjs.org/idb/-/idb-8.0.0.tgz",
-      "integrity": "sha512-l//qvlAKGmQO31Qn7xdzagVPPaHTxXx199MhrAFuVBTPqydcPYBWjkrbv4Y0ktB+GmWOiwHl237UUOrLmQxLvw=="
+      "version": "8.0.3",
+      "resolved": "https://registry.npmjs.org/idb/-/idb-8.0.3.tgz",
+      "integrity": "sha512-LtwtVyVYO5BqRvcsKuB2iUMnHwPVByPCXFXOpuU96IZPPoPN6xjOGxZQ74pgSVVLQWtUOYgyeL4GE98BY5D3wg==",
+      "license": "ISC"
     },
     "node_modules/inline-style-parser": {
-      "version": "0.2.3",
-      "resolved": "https://registry.npmjs.org/inline-style-parser/-/inline-style-parser-0.2.3.tgz",
-      "integrity": "sha512-qlD8YNDqyTKTyuITrDOffsl6Tdhv+UC4hcdAVuQsK4IMQ99nSgd1MIA/Q+jQYoh9r3hVUXhYh7urSRmXPkW04g==",
+      "version": "0.2.4",
+      "resolved": "https://registry.npmjs.org/inline-style-parser/-/inline-style-parser-0.2.4.tgz",
+      "integrity": "sha512-0aO8FkhNZlj/ZIbNi7Lxxr12obT7cL1moPfE4tg1LkX7LlLfC6DeX4l2ZEud1ukP9jNQyNnfzQVqwbwmAATY4Q==",
       "license": "MIT"
     },
     "node_modules/invariant": {
@@ -3835,7 +3950,9 @@
       }
     },
     "node_modules/is-alphabetical": {
-      "version": "1.0.4",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-alphabetical/-/is-alphabetical-2.0.1.tgz",
+      "integrity": "sha512-FWyyY60MeTNyeSRpkM2Iry0G9hpr7/9kD40mD/cGQEuilcZYS4okz8SN2Q6rLCJ8gbCt6fN+rC+6tMGS99LaxQ==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3843,11 +3960,13 @@
       }
     },
     "node_modules/is-alphanumerical": {
-      "version": "1.0.4",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-alphanumerical/-/is-alphanumerical-2.0.1.tgz",
+      "integrity": "sha512-hmbYhX/9MUMF5uh7tOXyK/n0ZvWpad5caBA17GsC6vyuCqaWliRG5K1qS9inmUhEMaOBIW7/whAnSwveW/LtZw==",
       "license": "MIT",
       "dependencies": {
-        "is-alphabetical": "^1.0.0",
-        "is-decimal": "^1.0.0"
+        "is-alphabetical": "^2.0.0",
+        "is-decimal": "^2.0.0"
       },
       "funding": {
         "type": "github",
@@ -3855,7 +3974,9 @@
       }
     },
     "node_modules/is-decimal": {
-      "version": "1.0.4",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-decimal/-/is-decimal-2.0.1.tgz",
+      "integrity": "sha512-AAB9hiomQs5DXWcRB1rqsxGUstbRroFOPPVAomNk/3XHR5JyEZChOyTWe2oayKnsSsr/kcGqF+z6yuH6HHpN0A==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3889,7 +4010,9 @@
       }
     },
     "node_modules/is-hexadecimal": {
-      "version": "1.0.4",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-hexadecimal/-/is-hexadecimal-2.0.1.tgz",
+      "integrity": "sha512-DgZQp241c8oO6cA1SbTEWiXeoxV42vlcJxgH+B3hi1AiqqKruZR3ZGF8In3fj4+/y/7rHvlOZLZtgJ/4ttYGZg==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -3923,6 +4046,8 @@
     },
     "node_modules/js-tokens": {
       "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
+      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
       "license": "MIT"
     },
     "node_modules/jsesc": {
@@ -3954,7 +4079,8 @@
     "node_modules/keyborg": {
       "version": "2.6.0",
       "resolved": "https://registry.npmjs.org/keyborg/-/keyborg-2.6.0.tgz",
-      "integrity": "sha512-o5kvLbuTF+o326CMVYpjlaykxqYP9DphFQZ2ZpgrvBouyvOxyEB7oqe8nOLFpiV5VCtz0D3pt8gXQYWpLpBnmA=="
+      "integrity": "sha512-o5kvLbuTF+o326CMVYpjlaykxqYP9DphFQZ2ZpgrvBouyvOxyEB7oqe8nOLFpiV5VCtz0D3pt8gXQYWpLpBnmA==",
+      "license": "MIT"
     },
     "node_modules/longest-streak": {
       "version": "3.1.0",
@@ -3968,6 +4094,8 @@
     },
     "node_modules/loose-envify": {
       "version": "1.4.0",
+      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
+      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
       "license": "MIT",
       "dependencies": {
         "js-tokens": "^3.0.0 || ^4.0.0"
@@ -3978,6 +4106,8 @@
     },
     "node_modules/lowlight": {
       "version": "1.20.0",
+      "resolved": "https://registry.npmjs.org/lowlight/-/lowlight-1.20.0.tgz",
+      "integrity": "sha512-8Ktj+prEb1RoCPkEOrPMYUN/nCggB7qAWe3a7OpMjWQkh3l2RD5wKRQ+o8Q8YuI9RG/xs95waaI/E6ym/7NsTw==",
       "license": "MIT",
       "dependencies": {
         "fault": "^1.0.0",
@@ -3999,9 +4129,9 @@
       }
     },
     "node_modules/markdown-table": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/markdown-table/-/markdown-table-3.0.3.tgz",
-      "integrity": "sha512-Z1NL3Tb1M9wH4XESsCDEksWoKTdlUafKc4pt0GRwjUyXaCFZ+dc3g2erqB6zm3szA2IUSi7VnPI+o/9jnxh9hw==",
+      "version": "3.0.4",
+      "resolved": "https://registry.npmjs.org/markdown-table/-/markdown-table-3.0.4.tgz",
+      "integrity": "sha512-wiYz4+JrLyb/DqW2hkFJxP7Vd7JuTDm77fvbM8VfEQdmSMqcImWeeRbHwZjBjIFki/VaMK2BhFi7oUUZeM5bqw==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -4009,9 +4139,9 @@
       }
     },
     "node_modules/mdast-util-find-and-replace": {
-      "version": "3.0.1",
-      "resolved": "https://registry.npmjs.org/mdast-util-find-and-replace/-/mdast-util-find-and-replace-3.0.1.tgz",
-      "integrity": "sha512-SG21kZHGC3XRTSUhtofZkBzZTJNM5ecCi0SK2IMKmSXR8vO3peL+kb1O0z7Zl83jKtutG4k5Wv/W7V3/YHvzPA==",
+      "version": "3.0.2",
+      "resolved": "https://registry.npmjs.org/mdast-util-find-and-replace/-/mdast-util-find-and-replace-3.0.2.tgz",
+      "integrity": "sha512-Tmd1Vg/m3Xz43afeNxDIhWRtFZgM2VLyaf4vSTYwudTyeuTneoL3qtWMA5jeLyz/O1vDJmmV4QuScFCA2tBPwg==",
       "license": "MIT",
       "dependencies": {
         "@types/mdast": "^4.0.0",
@@ -4024,22 +4154,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-find-and-replace/node_modules/escape-string-regexp": {
-      "version": "5.0.0",
-      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-5.0.0.tgz",
-      "integrity": "sha512-/veY75JbMK4j1yjvuUxuVsiS/hr/4iHs9FTT6cgTexxdE0Ly/glccBAkloH/DofkjRbZU3bnoj38mOmhkZ0lHw==",
-      "license": "MIT",
-      "engines": {
-        "node": ">=12"
-      },
-      "funding": {
-        "url": "https://github.com/sponsors/sindresorhus"
-      }
-    },
     "node_modules/mdast-util-from-markdown": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/mdast-util-from-markdown/-/mdast-util-from-markdown-2.0.1.tgz",
-      "integrity": "sha512-aJEUyzZ6TzlsX2s5B4Of7lN7EQtAxvtradMMglCQDyaTFgse6CmtmdJ15ElnVRlCg1vpNyVtbem0PWzlNieZsA==",
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/mdast-util-from-markdown/-/mdast-util-from-markdown-2.0.2.tgz",
+      "integrity": "sha512-uZhTV/8NBuw0WHkPTrCqDOl0zVe1BIng5ZtHoDk49ME1qqcjYmmLmOf0gELgcRMxN4w2iuIeVso5/6QymSrgmA==",
       "license": "MIT",
       "dependencies": {
         "@types/mdast": "^4.0.0",
@@ -4060,16 +4178,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-from-markdown/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/mdast-util-gfm": {
-      "version": "3.0.0",
-      "resolved": "https://registry.npmjs.org/mdast-util-gfm/-/mdast-util-gfm-3.0.0.tgz",
-      "integrity": "sha512-dgQEX5Amaq+DuUqf26jJqSK9qgixgd6rYDHAv4aTBuA92cTknZlKpPfa86Z/s8Dj8xsAQpFfBmPUHWJBWqS4Bw==",
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/mdast-util-gfm/-/mdast-util-gfm-3.1.0.tgz",
+      "integrity": "sha512-0ulfdQOM3ysHhCJ1p06l0b0VKlhU0wuQs3thxZQagjcjPrlFRqY215uZGHHJan9GEAXd9MbfPjFJz+qMkVR6zQ==",
       "license": "MIT",
       "dependencies": {
         "mdast-util-from-markdown": "^2.0.0",
@@ -4103,9 +4215,9 @@
       }
     },
     "node_modules/mdast-util-gfm-footnote": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/mdast-util-gfm-footnote/-/mdast-util-gfm-footnote-2.0.0.tgz",
-      "integrity": "sha512-5jOT2boTSVkMnQ7LTrd6n/18kqwjmuYqo7JUPe+tRCY6O7dAuTFMtTPauYYrMPpox9hlN0uOx/FL8XvEfG9/mQ==",
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/mdast-util-gfm-footnote/-/mdast-util-gfm-footnote-2.1.0.tgz",
+      "integrity": "sha512-sqpDWlsHn7Ac9GNZQMeUzPQSMzR6Wv0WKRNvQRg0KqHh02fpTz69Qc1QSseNX29bhz1ROIyNyxExfawVKTm1GQ==",
       "license": "MIT",
       "dependencies": {
         "@types/mdast": "^4.0.0",
@@ -4168,9 +4280,9 @@
       }
     },
     "node_modules/mdast-util-mdx-expression": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/mdast-util-mdx-expression/-/mdast-util-mdx-expression-2.0.0.tgz",
-      "integrity": "sha512-fGCu8eWdKUKNu5mohVGkhBXCXGnOTLuFqOvGMvdikr+J1w7lDJgxThOKpwRWzzbyXAU2hhSwsmssOY4yTokluw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/mdast-util-mdx-expression/-/mdast-util-mdx-expression-2.0.1.tgz",
+      "integrity": "sha512-J6f+9hUp+ldTZqKRSg7Vw5V6MqjATc+3E4gf3CFNcuZNWD8XdyI6zQ8GqH7f8169MM6P7hMBRDVGnn7oHB9kXQ==",
       "license": "MIT",
       "dependencies": {
         "@types/estree-jsx": "^1.0.0",
@@ -4185,19 +4297,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-mdx-expression/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/mdast-util-mdx-jsx": {
-      "version": "3.1.2",
-      "resolved": "https://registry.npmjs.org/mdast-util-mdx-jsx/-/mdast-util-mdx-jsx-3.1.2.tgz",
-      "integrity": "sha512-eKMQDeywY2wlHc97k5eD8VC+9ASMjN8ItEZQNGwJ6E0XWKiW/Z0V5/H8pvoXUf+y+Mj0VIgeRRbujBmFn4FTyA==",
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/mdast-util-mdx-jsx/-/mdast-util-mdx-jsx-3.2.0.tgz",
+      "integrity": "sha512-lj/z8v0r6ZtsN/cGNNtemmmfoLAFZnjMbNyLzBafjzikOM+glrjNHPlf6lQDOTccj9n5b0PPihEBbhneMyGs1Q==",
       "license": "MIT",
       "dependencies": {
         "@types/estree-jsx": "^1.0.0",
@@ -4210,7 +4313,6 @@
         "mdast-util-to-markdown": "^2.0.0",
         "parse-entities": "^4.0.0",
         "stringify-entities": "^4.0.0",
-        "unist-util-remove-position": "^5.0.0",
         "unist-util-stringify-position": "^4.0.0",
         "vfile-message": "^4.0.0"
       },
@@ -4219,121 +4321,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-mdx-jsx/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/character-entities": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-2.0.2.tgz",
-      "integrity": "sha512-shx7oQ0Awen/BRIdkjkvz54PnEEI/EjwXDSIZp86/KKdbafHh1Df/RYGBhn4hbe2+uKC9FnT5UCEdyPz3ai9hQ==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/character-entities-legacy": {
-      "version": "3.0.0",
-      "resolved": "https://registry.npmjs.org/character-entities-legacy/-/character-entities-legacy-3.0.0.tgz",
-      "integrity": "sha512-RpPp0asT/6ufRm//AJVwpViZbGM/MkjQFxJccQRHmISF/22NBtsHqAWmL+/pmkPWoIUJdWyeVleTl1wydHATVQ==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/character-reference-invalid": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/character-reference-invalid/-/character-reference-invalid-2.0.1.tgz",
-      "integrity": "sha512-iBZ4F4wRbyORVsu0jPV7gXkOsGYjGHPmAyv+HiHG8gi5PtC9KI2j1+v8/tlibRvjoWX027ypmG/n0HtO5t7unw==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/is-alphabetical": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/is-alphabetical/-/is-alphabetical-2.0.1.tgz",
-      "integrity": "sha512-FWyyY60MeTNyeSRpkM2Iry0G9hpr7/9kD40mD/cGQEuilcZYS4okz8SN2Q6rLCJ8gbCt6fN+rC+6tMGS99LaxQ==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/is-alphanumerical": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/is-alphanumerical/-/is-alphanumerical-2.0.1.tgz",
-      "integrity": "sha512-hmbYhX/9MUMF5uh7tOXyK/n0ZvWpad5caBA17GsC6vyuCqaWliRG5K1qS9inmUhEMaOBIW7/whAnSwveW/LtZw==",
-      "license": "MIT",
-      "dependencies": {
-        "is-alphabetical": "^2.0.0",
-        "is-decimal": "^2.0.0"
-      },
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/is-decimal": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/is-decimal/-/is-decimal-2.0.1.tgz",
-      "integrity": "sha512-AAB9hiomQs5DXWcRB1rqsxGUstbRroFOPPVAomNk/3XHR5JyEZChOyTWe2oayKnsSsr/kcGqF+z6yuH6HHpN0A==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/is-hexadecimal": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/is-hexadecimal/-/is-hexadecimal-2.0.1.tgz",
-      "integrity": "sha512-DgZQp241c8oO6cA1SbTEWiXeoxV42vlcJxgH+B3hi1AiqqKruZR3ZGF8In3fj4+/y/7rHvlOZLZtgJ/4ttYGZg==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/parse-entities": {
-      "version": "4.0.1",
-      "resolved": "https://registry.npmjs.org/parse-entities/-/parse-entities-4.0.1.tgz",
-      "integrity": "sha512-SWzvYcSJh4d/SGLIOQfZ/CoNv6BTlI6YEQ7Nj82oDVnRpwe/Z/F1EMx42x3JAOwGBlCjeCH0BRJQbQ/opHL17w==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "^2.0.0",
-        "character-entities": "^2.0.0",
-        "character-entities-legacy": "^3.0.0",
-        "character-reference-invalid": "^2.0.0",
-        "decode-named-character-reference": "^1.0.0",
-        "is-alphanumerical": "^2.0.0",
-        "is-decimal": "^2.0.0",
-        "is-hexadecimal": "^2.0.0"
-      },
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
-    "node_modules/mdast-util-mdx-jsx/node_modules/parse-entities/node_modules/@types/unist": {
-      "version": "2.0.11",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-2.0.11.tgz",
-      "integrity": "sha512-CmBKiL6NNo/OqgmMn95Fk9Whlp2mtvIv+KNpQKN2F4SjvrEesubTRWGYSg+BnWZOnlCaSTU1sMpsBOzgbYhnsA==",
-      "license": "MIT"
-    },
     "node_modules/mdast-util-mdxjs-esm": {
       "version": "2.0.1",
       "resolved": "https://registry.npmjs.org/mdast-util-mdxjs-esm/-/mdast-util-mdxjs-esm-2.0.1.tgz",
@@ -4352,15 +4339,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-mdxjs-esm/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/mdast-util-phrasing": {
       "version": "4.1.0",
       "resolved": "https://registry.npmjs.org/mdast-util-phrasing/-/mdast-util-phrasing-4.1.0.tgz",
@@ -4396,19 +4374,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-to-hast/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/mdast-util-to-markdown": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/mdast-util-to-markdown/-/mdast-util-to-markdown-2.1.0.tgz",
-      "integrity": "sha512-SR2VnIEdVNCJbP6y7kVTJgPLifdr8WEU440fQec7qHoHOUz/oJ2jmNRqdDQ3rbiStOXb2mCDGTuwsK5OPUgYlQ==",
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/mdast-util-to-markdown/-/mdast-util-to-markdown-2.1.2.tgz",
+      "integrity": "sha512-xj68wMTvGXVOKonmog6LwyJKrYXZPvlwabaryTjLh9LuvovB/KAH+kvi8Gjj+7rJjsFi23nkUxRQv1KqSroMqA==",
       "license": "MIT",
       "dependencies": {
         "@types/mdast": "^4.0.0",
@@ -4416,6 +4385,7 @@
         "longest-streak": "^3.0.0",
         "mdast-util-phrasing": "^4.0.0",
         "mdast-util-to-string": "^4.0.0",
+        "micromark-util-classify-character": "^2.0.0",
         "micromark-util-decode-string": "^2.0.0",
         "unist-util-visit": "^5.0.0",
         "zwitch": "^2.0.0"
@@ -4425,12 +4395,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/mdast-util-to-markdown/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/mdast-util-to-string": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/mdast-util-to-string/-/mdast-util-to-string-4.0.0.tgz",
@@ -4445,9 +4409,9 @@
       }
     },
     "node_modules/micromark": {
-      "version": "4.0.0",
-      "resolved": "https://registry.npmjs.org/micromark/-/micromark-4.0.0.tgz",
-      "integrity": "sha512-o/sd0nMof8kYff+TqcDx3VSrgBTcZpSvYcAHIfHhv5VAuNmisCxjhx6YmxS8PFEpb9z5WKWKPdzf0jM23ro3RQ==",
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/micromark/-/micromark-4.0.2.tgz",
+      "integrity": "sha512-zpe98Q6kvavpCr1NPVSCMebCKfD7CA2NqZ+rykeNhONIJBpc1tFKt9hucLGwha3jNTNI8lHpctWJWoimVF4PfA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4480,9 +4444,9 @@
       }
     },
     "node_modules/micromark-core-commonmark": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/micromark-core-commonmark/-/micromark-core-commonmark-2.0.1.tgz",
-      "integrity": "sha512-CUQyKr1e///ZODyD1U3xit6zXwy1a8q2a1S1HKtIlmgvurrEpaw/Y9y6KSIbF8P59cn/NjzHyO+Q2fAyYLQrAA==",
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/micromark-core-commonmark/-/micromark-core-commonmark-2.0.3.tgz",
+      "integrity": "sha512-RDBrHEMSxVFLg6xvnXmb1Ayr2WzLAWjeSATAoxwKYJV94TeNavgoIdA0a9ytzDSVzBy2YKFK+emCPOEibLeCrg==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4588,9 +4552,9 @@
       }
     },
     "node_modules/micromark-extension-gfm-table": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/micromark-extension-gfm-table/-/micromark-extension-gfm-table-2.1.0.tgz",
-      "integrity": "sha512-Ub2ncQv+fwD70/l4ou27b4YzfNaCJOvyX4HxXU15m7mpYY+rjuWzsLIPZHJL253Z643RpbcP1oeIJlQ/SKW67g==",
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/micromark-extension-gfm-table/-/micromark-extension-gfm-table-2.1.1.tgz",
+      "integrity": "sha512-t2OU/dXXioARrC6yWfJ4hqB7rct14e8f7m0cbI5hUmDyyIlwv5vEtooptH8INkbLzOatzKuVbQmAYcbWoyz6Dg==",
       "license": "MIT",
       "dependencies": {
         "devlop": "^1.0.0",
@@ -4635,9 +4599,9 @@
       }
     },
     "node_modules/micromark-factory-destination": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-factory-destination/-/micromark-factory-destination-2.0.0.tgz",
-      "integrity": "sha512-j9DGrQLm/Uhl2tCzcbLhy5kXsgkHUrjJHg4fFAeoMRwJmJerT9aw4FEhIbZStWN8A3qMwOp1uzHr4UL8AInxtA==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-factory-destination/-/micromark-factory-destination-2.0.1.tgz",
+      "integrity": "sha512-Xe6rDdJlkmbFRExpTOmRj9N3MaWmbAgdpSrBQvCFqhezUn4AHqJHbaEnfbVYYiexVSs//tqOdY/DxhjdCiJnIA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4656,9 +4620,9 @@
       }
     },
     "node_modules/micromark-factory-label": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-factory-label/-/micromark-factory-label-2.0.0.tgz",
-      "integrity": "sha512-RR3i96ohZGde//4WSe/dJsxOX6vxIg9TimLAS3i4EhBAFx8Sm5SmqVfR8E87DPSR31nEAjZfbt91OMZWcNgdZw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-factory-label/-/micromark-factory-label-2.0.1.tgz",
+      "integrity": "sha512-VFMekyQExqIW7xIChcXn4ok29YE3rnuyveW3wZQWWqF4Nv9Wk5rgJ99KzPvHjkmPXF93FXIbBp6YdW3t71/7Vg==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4678,9 +4642,9 @@
       }
     },
     "node_modules/micromark-factory-space": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-factory-space/-/micromark-factory-space-2.0.0.tgz",
-      "integrity": "sha512-TKr+LIDX2pkBJXFLzpyPyljzYK3MtmllMUMODTQJIUfDGncESaqB90db9IAUcz4AZAJFdd8U9zOp9ty1458rxg==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-factory-space/-/micromark-factory-space-2.0.1.tgz",
+      "integrity": "sha512-zRkxjtBxxLd2Sc0d+fbnEunsTj46SWXgXciZmHq0kDYGnck/ZSGj9/wULTV95uoeYiK5hRXP2mJ98Uo4cq/LQg==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4698,9 +4662,9 @@
       }
     },
     "node_modules/micromark-factory-title": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-factory-title/-/micromark-factory-title-2.0.0.tgz",
-      "integrity": "sha512-jY8CSxmpWLOxS+t8W+FG3Xigc0RDQA9bKMY/EwILvsesiRniiVMejYTE4wumNc2f4UbAa4WsHqe3J1QS1sli+A==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-factory-title/-/micromark-factory-title-2.0.1.tgz",
+      "integrity": "sha512-5bZ+3CjhAd9eChYTHsjy6TGxpOFSKgKKJPJxr293jTbfry2KDoWkhBb6TcPVB4NmzaPhMs1Frm9AZH7OD4Cjzw==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4720,9 +4684,9 @@
       }
     },
     "node_modules/micromark-factory-whitespace": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-factory-whitespace/-/micromark-factory-whitespace-2.0.0.tgz",
-      "integrity": "sha512-28kbwaBjc5yAI1XadbdPYHX/eDnqaUFVikLwrO7FDnKG7lpgxnvk/XGRhX/PN0mOZ+dBSZ+LgunHS+6tYQAzhA==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-factory-whitespace/-/micromark-factory-whitespace-2.0.1.tgz",
+      "integrity": "sha512-Ob0nuZ3PKt/n0hORHyvoD9uZhr+Za8sFoP+OnMcnWK5lngSzALgQYKMr9RJVOWLqQYuyn6ulqGWSXdwf6F80lQ==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4742,9 +4706,9 @@
       }
     },
     "node_modules/micromark-util-character": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-character/-/micromark-util-character-2.1.0.tgz",
-      "integrity": "sha512-KvOVV+X1yLBfs9dCBSopq/+G1PcgT3lAK07mC4BzXi5E7ahzMAF8oIupDDJ6mievI6F+lAATkbQQlQixJfT3aQ==",
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-character/-/micromark-util-character-2.1.1.tgz",
+      "integrity": "sha512-wv8tdUTJ3thSFFFJKtpYKOYiGP2+v96Hvk4Tu8KpCAsTMs6yi+nVmGh1syvSCsaxz45J6Jbw+9DD6g97+NV67Q==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4762,9 +4726,9 @@
       }
     },
     "node_modules/micromark-util-chunked": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-chunked/-/micromark-util-chunked-2.0.0.tgz",
-      "integrity": "sha512-anK8SWmNphkXdaKgz5hJvGa7l00qmcaUQoMYsBwDlSKFKjc6gjGXPDw3FNL3Nbwq5L8gE+RCbGqTw49FK5Qyvg==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-chunked/-/micromark-util-chunked-2.0.1.tgz",
+      "integrity": "sha512-QUNFEOPELfmvv+4xiNg2sRYeS/P84pTW0TCgP5zc9FpXetHY0ab7SxKyAQCNCc1eK0459uoLI1y5oO5Vc1dbhA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4781,9 +4745,9 @@
       }
     },
     "node_modules/micromark-util-classify-character": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-classify-character/-/micromark-util-classify-character-2.0.0.tgz",
-      "integrity": "sha512-S0ze2R9GH+fu41FA7pbSqNWObo/kzwf8rN/+IGlW/4tC6oACOs8B++bh+i9bVyNnwCcuksbFwsBme5OCKXCwIw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-classify-character/-/micromark-util-classify-character-2.0.1.tgz",
+      "integrity": "sha512-K0kHzM6afW/MbeWYWLjoHQv1sgg2Q9EccHEDzSkxiP/EaagNzCm7T/WMKZ3rjMbvIpvBiZgwR3dKMygtA4mG1Q==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4802,9 +4766,9 @@
       }
     },
     "node_modules/micromark-util-combine-extensions": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-combine-extensions/-/micromark-util-combine-extensions-2.0.0.tgz",
-      "integrity": "sha512-vZZio48k7ON0fVS3CUgFatWHoKbbLTK/rT7pzpJ4Bjp5JjkZeasRfrS9wsBdDJK2cJLHMckXZdzPSSr1B8a4oQ==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-combine-extensions/-/micromark-util-combine-extensions-2.0.1.tgz",
+      "integrity": "sha512-OnAnH8Ujmy59JcyZw8JSbK9cGpdVY44NKgSM7E9Eh7DiLS2E9RNQf0dONaGDzEG9yjEl5hcqeIsj4hfRkLH/Bg==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4822,9 +4786,9 @@
       }
     },
     "node_modules/micromark-util-decode-numeric-character-reference": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/micromark-util-decode-numeric-character-reference/-/micromark-util-decode-numeric-character-reference-2.0.1.tgz",
-      "integrity": "sha512-bmkNc7z8Wn6kgjZmVHOX3SowGmVdhYS7yBpMnuMnPzDq/6xwVA604DuOXMZTO1lvq01g+Adfa0pE2UKGlxL1XQ==",
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/micromark-util-decode-numeric-character-reference/-/micromark-util-decode-numeric-character-reference-2.0.2.tgz",
+      "integrity": "sha512-ccUbYk6CwVdkmCQMyr64dXz42EfHGkPQlBj5p7YVGzq8I7CtjXZJrubAYezf7Rp+bjPseiROqe7G6foFd+lEuw==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4841,9 +4805,9 @@
       }
     },
     "node_modules/micromark-util-decode-string": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-decode-string/-/micromark-util-decode-string-2.0.0.tgz",
-      "integrity": "sha512-r4Sc6leeUTn3P6gk20aFMj2ntPwn6qpDZqWvYmAG6NgvFTIlj4WtrAudLi65qYoaGdXYViXYw2pkmn7QnIFasA==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-decode-string/-/micromark-util-decode-string-2.0.1.tgz",
+      "integrity": "sha512-nDV/77Fj6eH1ynwscYTOsbK7rR//Uj0bZXBwJZRfaLEJ1iGBR6kIfNmlNqaqJf649EP0F3NWNdeJi03elllNUQ==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4863,9 +4827,9 @@
       }
     },
     "node_modules/micromark-util-encode": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-encode/-/micromark-util-encode-2.0.0.tgz",
-      "integrity": "sha512-pS+ROfCXAGLWCOc8egcBvT0kf27GoWMqtdarNfDcjb6YLuV5cM3ioG45Ys2qOVqeqSbjaKg72vU+Wby3eddPsA==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-encode/-/micromark-util-encode-2.0.1.tgz",
+      "integrity": "sha512-c3cVx2y4KqUnwopcO9b/SCdo2O67LwJJ/UyqGfbigahfegL9myoEFoDYZgkT7f36T0bLrM9hZTAaAyH+PCAXjw==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4879,9 +4843,9 @@
       "license": "MIT"
     },
     "node_modules/micromark-util-html-tag-name": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-html-tag-name/-/micromark-util-html-tag-name-2.0.0.tgz",
-      "integrity": "sha512-xNn4Pqkj2puRhKdKTm8t1YHC/BAjx6CEwRFXntTaRf/x16aqka6ouVoutm+QdkISTlT7e2zU7U4ZdlDLJd2Mcw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-html-tag-name/-/micromark-util-html-tag-name-2.0.1.tgz",
+      "integrity": "sha512-2cNEiYDhCWKI+Gs9T0Tiysk136SnR13hhO8yW6BGNyhOC4qYFnwF1nKfD3HFAIXA5c45RrIG1ub11GiXeYd1xA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4895,9 +4859,9 @@
       "license": "MIT"
     },
     "node_modules/micromark-util-normalize-identifier": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-normalize-identifier/-/micromark-util-normalize-identifier-2.0.0.tgz",
-      "integrity": "sha512-2xhYT0sfo85FMrUPtHcPo2rrp1lwbDEEzpx7jiH2xXJLqBuy4H0GgXk5ToU8IEwoROtXuL8ND0ttVa4rNqYK3w==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-normalize-identifier/-/micromark-util-normalize-identifier-2.0.1.tgz",
+      "integrity": "sha512-sxPqmo70LyARJs0w2UclACPUUEqltCkJ6PhKdMIDuJ3gSf/Q+/GIe3WKl0Ijb/GyH9lOpUkRAO2wp0GVkLvS9Q==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4914,9 +4878,9 @@
       }
     },
     "node_modules/micromark-util-resolve-all": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-resolve-all/-/micromark-util-resolve-all-2.0.0.tgz",
-      "integrity": "sha512-6KU6qO7DZ7GJkaCgwBNtplXCvGkJToU86ybBAUdavvgsCiG8lSSvYxr9MhwmQ+udpzywHsl4RpGJsYWG1pDOcA==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-resolve-all/-/micromark-util-resolve-all-2.0.1.tgz",
+      "integrity": "sha512-VdQyxFWFT2/FGJgwQnJYbe1jjQoNTS4RjglmSjTUlpUMa95Htx9NHeYW4rGDJzbjvCsl9eLjMQwGeElsqmzcHg==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4933,9 +4897,9 @@
       }
     },
     "node_modules/micromark-util-sanitize-uri": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-sanitize-uri/-/micromark-util-sanitize-uri-2.0.0.tgz",
-      "integrity": "sha512-WhYv5UEcZrbAtlsnPuChHUAsu/iBPOVaEVsntLBIdpibO0ddy8OzavZz3iL2xVvBZOpolujSliP65Kq0/7KIYw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-sanitize-uri/-/micromark-util-sanitize-uri-2.0.1.tgz",
+      "integrity": "sha512-9N9IomZ/YuGGZZmQec1MbgxtlgougxTodVwDzzEouPKo3qFWvymFHWcnDi2vzV1ff6kas9ucW+o3yzJK9YB1AQ==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4954,9 +4918,9 @@
       }
     },
     "node_modules/micromark-util-subtokenize": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/micromark-util-subtokenize/-/micromark-util-subtokenize-2.0.1.tgz",
-      "integrity": "sha512-jZNtiFl/1aY73yS3UGQkutD0UbhTt68qnRpw2Pifmz5wV9h8gOVsN70v+Lq/f1rKaU/W8pxRe8y8Q9FX1AOe1Q==",
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-subtokenize/-/micromark-util-subtokenize-2.1.0.tgz",
+      "integrity": "sha512-XQLu552iSctvnEcgXw6+Sx75GflAPNED1qx7eBJ+wydBb2KCbRZe+NwvIEEMM83uml1+2WSXpBAcp9IUCgCYWA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4976,9 +4940,9 @@
       }
     },
     "node_modules/micromark-util-symbol": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-symbol/-/micromark-util-symbol-2.0.0.tgz",
-      "integrity": "sha512-8JZt9ElZ5kyTnO94muPxIGS8oyElRJaiJO8EzV6ZSyGQ1Is8xwl4Q45qU5UOg+bGH4AikWziz0iN4sFLWs8PGw==",
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/micromark-util-symbol/-/micromark-util-symbol-2.0.1.tgz",
+      "integrity": "sha512-vs5t8Apaud9N28kgCrRUdEed4UJ+wWNvicHLPxCa9ENlYuAY31M0ETy5y1vA33YoNPDFTghEbnh6efaE8h4x0Q==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -4992,9 +4956,9 @@
       "license": "MIT"
     },
     "node_modules/micromark-util-types": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/micromark-util-types/-/micromark-util-types-2.0.0.tgz",
-      "integrity": "sha512-oNh6S2WMHWRZrmutsRmDDfkzKtxF+bc2VxLC9dvtrDIRFln627VsFP6fLMgTryGDljgLPjkrzQSDcPrjPyDJ5w==",
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/micromark-util-types/-/micromark-util-types-2.0.2.tgz",
+      "integrity": "sha512-Yw0ECSpJoViF1qTU4DC6NwtC4aWGt1EkzaQB8KPPyCRR8z9TWeV0HbEFGTO+ZY1wB22zmxnJqhPyTpOVCpeHTA==",
       "funding": [
         {
           "type": "GitHub Sponsors",
@@ -5008,9 +4972,10 @@
       "license": "MIT"
     },
     "node_modules/ms": {
-      "version": "2.1.2",
-      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.2.tgz",
-      "integrity": "sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w=="
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
     },
     "node_modules/nanoid": {
       "version": "3.3.11",
@@ -5032,9 +4997,10 @@
       }
     },
     "node_modules/ndjson-readablestream": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/ndjson-readablestream/-/ndjson-readablestream-1.2.0.tgz",
-      "integrity": "sha512-QbWX2IIfKMVL+ZFHm9vFEzPh1NzZfzJql59T+9XoXzUp8n0wu2t9qgDV9nT0A77YYa6KbAjsHNWzJfpZTfp4xQ=="
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/ndjson-readablestream/-/ndjson-readablestream-1.3.0.tgz",
+      "integrity": "sha512-woBFmA+6hq6L/OgbY+a6jb2tUhQY+NsNPtC7ACDWCX/xYe+mUEziBsIAWeYhijvCRW7DqQ34/ZhcnhaXwDx4bw==",
+      "license": "MIT"
     },
     "node_modules/node-fetch": {
       "version": "2.7.0",
@@ -5065,6 +5031,8 @@
     },
     "node_modules/object-assign": {
       "version": "4.1.1",
+      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
+      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
       "license": "MIT",
       "engines": {
         "node": ">=0.10.0"
@@ -5089,28 +5057,37 @@
       }
     },
     "node_modules/parse-entities": {
-      "version": "2.0.0",
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/parse-entities/-/parse-entities-4.0.2.tgz",
+      "integrity": "sha512-GG2AQYWoLgL877gQIKeRPGO1xF9+eG1ujIb5soS5gPvLQ1y2o8FL90w2QWNdf9I361Mpp7726c+lj3U0qK1uGw==",
       "license": "MIT",
       "dependencies": {
-        "character-entities": "^1.0.0",
-        "character-entities-legacy": "^1.0.0",
-        "character-reference-invalid": "^1.0.0",
-        "is-alphanumerical": "^1.0.0",
-        "is-decimal": "^1.0.0",
-        "is-hexadecimal": "^1.0.0"
+        "@types/unist": "^2.0.0",
+        "character-entities-legacy": "^3.0.0",
+        "character-reference-invalid": "^2.0.0",
+        "decode-named-character-reference": "^1.0.0",
+        "is-alphanumerical": "^2.0.0",
+        "is-decimal": "^2.0.0",
+        "is-hexadecimal": "^2.0.0"
       },
       "funding": {
         "type": "github",
         "url": "https://github.com/sponsors/wooorm"
       }
     },
+    "node_modules/parse-entities/node_modules/@types/unist": {
+      "version": "2.0.11",
+      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-2.0.11.tgz",
+      "integrity": "sha512-CmBKiL6NNo/OqgmMn95Fk9Whlp2mtvIv+KNpQKN2F4SjvrEesubTRWGYSg+BnWZOnlCaSTU1sMpsBOzgbYhnsA==",
+      "license": "MIT"
+    },
     "node_modules/parse5": {
-      "version": "7.1.2",
-      "resolved": "https://registry.npmjs.org/parse5/-/parse5-7.1.2.tgz",
-      "integrity": "sha512-Czj1WaSVpaoj0wbhMzLmWD69anp2WH7FXMB9n1Sy8/ZFF9jolSQVMu1Ij5WIyGmcBmhk7EOndpO4mIpihVqAXw==",
+      "version": "7.3.0",
+      "resolved": "https://registry.npmjs.org/parse5/-/parse5-7.3.0.tgz",
+      "integrity": "sha512-IInvU7fabl34qmi9gY8XOVxhYyMyuH2xUNpb2q8/Y+7552KlejkRvqvD19nMoUW/uQGGbqNpA6Tufu5FL5BZgw==",
       "license": "MIT",
       "dependencies": {
-        "entities": "^4.4.0"
+        "entities": "^6.0.0"
       },
       "funding": {
         "url": "https://github.com/inikulin/parse5?sponsor=1"
@@ -5124,13 +5101,13 @@
       "license": "ISC"
     },
     "node_modules/picomatch": {
-      "version": "2.3.1",
-      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
-      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
+      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
       "dev": true,
       "license": "MIT",
       "engines": {
-        "node": ">=8.6"
+        "node": ">=12"
       },
       "funding": {
         "url": "https://github.com/sponsors/jonschlinkert"
@@ -5166,10 +5143,11 @@
       }
     },
     "node_modules/prettier": {
-      "version": "3.3.3",
-      "resolved": "https://registry.npmjs.org/prettier/-/prettier-3.3.3.tgz",
-      "integrity": "sha512-i2tDNA0O5IrMO757lfrdQZCc2jPNDVntV0m/+4whiDfWaTKfMNgR7Qz0NAeGz/nRqF4m5/6CLzbP4/liHt12Ew==",
+      "version": "3.6.2",
+      "resolved": "https://registry.npmjs.org/prettier/-/prettier-3.6.2.tgz",
+      "integrity": "sha512-I7AIg5boAr5R0FFtJ6rCfD+LFsWHp81dolrFD8S79U9tb8Az2nGrJncnMSnys+bpQJfRUzqs9hnA81OAA3hCuQ==",
       "dev": true,
+      "license": "MIT",
       "bin": {
         "prettier": "bin/prettier.cjs"
       },
@@ -5181,7 +5159,9 @@
       }
     },
     "node_modules/prismjs": {
-      "version": "1.29.0",
+      "version": "1.30.0",
+      "resolved": "https://registry.npmjs.org/prismjs/-/prismjs-1.30.0.tgz",
+      "integrity": "sha512-DEvV2ZF2r2/63V+tK8hQvrR2ZGn10srHbXviTlcv7Kpzw8jWiNTqbVgjO3IY8RxrrOUF8VPMQQFysYYYv0YZxw==",
       "license": "MIT",
       "engines": {
         "node": ">=6"
@@ -5191,6 +5171,7 @@
       "version": "15.8.1",
       "resolved": "https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz",
       "integrity": "sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==",
+      "license": "MIT",
       "dependencies": {
         "loose-envify": "^1.4.0",
         "object-assign": "^4.1.1",
@@ -5200,14 +5181,14 @@
     "node_modules/prop-types/node_modules/react-is": {
       "version": "16.13.1",
       "resolved": "https://registry.npmjs.org/react-is/-/react-is-16.13.1.tgz",
-      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ=="
+      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==",
+      "license": "MIT"
     },
     "node_modules/property-information": {
-      "version": "5.6.0",
+      "version": "7.1.0",
+      "resolved": "https://registry.npmjs.org/property-information/-/property-information-7.1.0.tgz",
+      "integrity": "sha512-TwEZ+X+yCJmYfL7TPUOcvBZ4QfoT5YenQiJuX//0th53DE6w0xxLEtfK3iyryQFddXuvkIk51EEgrJQ0WJkOmQ==",
       "license": "MIT",
-      "dependencies": {
-        "xtend": "^4.0.0"
-      },
       "funding": {
         "type": "github",
         "url": "https://github.com/sponsors/wooorm"
@@ -5217,6 +5198,7 @@
       "version": "18.3.1",
       "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
       "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
+      "license": "MIT",
       "dependencies": {
         "loose-envify": "^1.1.0"
       },
@@ -5228,6 +5210,7 @@
       "version": "18.3.1",
       "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
       "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
+      "license": "MIT",
       "dependencies": {
         "loose-envify": "^1.1.0",
         "scheduler": "^0.23.2"
@@ -5240,6 +5223,7 @@
       "version": "0.23.2",
       "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
       "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
+      "license": "MIT",
       "dependencies": {
         "loose-envify": "^1.1.0"
       }
@@ -5265,17 +5249,18 @@
       }
     },
     "node_modules/react-i18next": {
-      "version": "15.4.1",
-      "resolved": "https://registry.npmjs.org/react-i18next/-/react-i18next-15.4.1.tgz",
-      "integrity": "sha512-ahGab+IaSgZmNPYXdV1n+OYky95TGpFwnKRflX/16dY04DsYYKHtVLjeny7sBSCREEcoMbAgSkFiGLF5g5Oofw==",
+      "version": "15.6.1",
+      "resolved": "https://registry.npmjs.org/react-i18next/-/react-i18next-15.6.1.tgz",
+      "integrity": "sha512-uGrzSsOUUe2sDBG/+FJq2J1MM+Y4368/QW8OLEKSFvnDflHBbZhSd1u3UkW0Z06rMhZmnB/AQrhCpYfE5/5XNg==",
       "license": "MIT",
       "dependencies": {
-        "@babel/runtime": "^7.25.0",
+        "@babel/runtime": "^7.27.6",
         "html-parse-stringify": "^3.0.1"
       },
       "peerDependencies": {
         "i18next": ">= 23.2.3",
-        "react": ">= 16.8.0"
+        "react": ">= 16.8.0",
+        "typescript": "^5"
       },
       "peerDependenciesMeta": {
         "react-dom": {
@@ -5283,6 +5268,9 @@
         },
         "react-native": {
           "optional": true
+        },
+        "typescript": {
+          "optional": true
         }
       }
     },
@@ -5293,12 +5281,13 @@
       "license": "MIT"
     },
     "node_modules/react-markdown": {
-      "version": "9.0.1",
-      "resolved": "https://registry.npmjs.org/react-markdown/-/react-markdown-9.0.1.tgz",
-      "integrity": "sha512-186Gw/vF1uRkydbsOIkcGXw7aHq0sZOCRFFjGrr7b9+nVZg4UfA4enXCaxm4fUzecU38sWfrNDitGhshuU7rdg==",
+      "version": "9.1.0",
+      "resolved": "https://registry.npmjs.org/react-markdown/-/react-markdown-9.1.0.tgz",
+      "integrity": "sha512-xaijuJB0kzGiUdG7nc2MOMDUDBWPyGAjZtUrow9XxUeua8IqeP+VlIfAZ3bphpcLTnSZXz6z9jcVC/TCwbfgdw==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^3.0.0",
+        "@types/mdast": "^4.0.0",
         "devlop": "^1.0.0",
         "hast-util-to-jsx-runtime": "^2.0.0",
         "html-url-attributes": "^3.0.0",
@@ -5318,15 +5307,6 @@
         "react": ">=18"
       }
     },
-    "node_modules/react-markdown/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/react-refresh": {
       "version": "0.17.0",
       "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
@@ -5338,11 +5318,12 @@
       }
     },
     "node_modules/react-router": {
-      "version": "6.28.0",
-      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.28.0.tgz",
-      "integrity": "sha512-HrYdIFqdrnhDw0PqG/AKjAqEqM7AvxCz0DQ4h2W8k6nqmc5uRBYDag0SBxx9iYz5G8gnuNVLzUe13wl9eAsXXg==",
+      "version": "6.30.1",
+      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.30.1.tgz",
+      "integrity": "sha512-X1m21aEmxGXqENEPG3T6u0Th7g0aS4ZmoNynhbs+Cn+q+QGTLt+d5IQ2bHAXKzKcxGJjxACpVbnYQSCRcfxHlQ==",
+      "license": "MIT",
       "dependencies": {
-        "@remix-run/router": "1.21.0"
+        "@remix-run/router": "1.23.0"
       },
       "engines": {
         "node": ">=14.0.0"
@@ -5352,12 +5333,13 @@
       }
     },
     "node_modules/react-router-dom": {
-      "version": "6.28.0",
-      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.28.0.tgz",
-      "integrity": "sha512-kQ7Unsl5YdyOltsPGl31zOjLrDv+m2VcIEcIHqYYD3Lp0UppLjrzcfJqDJwXxFw3TH/yvapbnUvPlAj7Kx5nbg==",
+      "version": "6.30.1",
+      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.30.1.tgz",
+      "integrity": "sha512-llKsgOkZdbPU1Eg3zK8lCn+sjD9wMRZZPuzmdWWX5SUs8OFkN5HnFVC0u5KMeMaC9aoancFI/KoLuKPqN+hxHw==",
+      "license": "MIT",
       "dependencies": {
-        "@remix-run/router": "1.21.0",
-        "react-router": "6.28.0"
+        "@remix-run/router": "1.23.0",
+        "react-router": "6.30.1"
       },
       "engines": {
         "node": ">=14.0.0"
@@ -5371,6 +5353,7 @@
       "version": "15.6.1",
       "resolved": "https://registry.npmjs.org/react-syntax-highlighter/-/react-syntax-highlighter-15.6.1.tgz",
       "integrity": "sha512-OqJ2/vL7lEeV5zTJyG7kmARppUjiB9h9udl4qHQjjgEos66z00Ia0OckwYfRxCSFrW8RJIBnsBwQsHZbVPspqg==",
+      "license": "MIT",
       "dependencies": {
         "@babel/runtime": "^7.3.1",
         "highlight.js": "^10.4.1",
@@ -5387,6 +5370,7 @@
       "version": "4.4.5",
       "resolved": "https://registry.npmjs.org/react-transition-group/-/react-transition-group-4.4.5.tgz",
       "integrity": "sha512-pZcd1MCJoiKiBR2NRxeCRg13uCXbydPnmB4EOeRrY7480qNWO8IIgQG6zlDkm6uRMsURXPuKq0GWtiM59a5Q6g==",
+      "license": "BSD-3-Clause",
       "dependencies": {
         "@babel/runtime": "^7.5.5",
         "dom-helpers": "^5.0.1",
@@ -5400,6 +5384,8 @@
     },
     "node_modules/refractor": {
       "version": "3.6.0",
+      "resolved": "https://registry.npmjs.org/refractor/-/refractor-3.6.0.tgz",
+      "integrity": "sha512-MY9W41IOWxxk31o+YvFCNyNzdkc9M20NoZK5vq6jkv4I/uh2zkWcfudj0Q1fovjUQJrNewS9NMzeTtqPf+n5EA==",
       "license": "MIT",
       "dependencies": {
         "hastscript": "^6.0.0",
@@ -5411,17 +5397,107 @@
         "url": "https://github.com/sponsors/wooorm"
       }
     },
+    "node_modules/refractor/node_modules/character-entities": {
+      "version": "1.2.4",
+      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-1.2.4.tgz",
+      "integrity": "sha512-iBMyeEHxfVnIakwOuDXpVkc54HijNgCyQB2w0VfGQThle6NXn50zU6V/u+LDhxHcDUPojn6Kpga3PTAD8W1bQw==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/character-entities-legacy": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/character-entities-legacy/-/character-entities-legacy-1.1.4.tgz",
+      "integrity": "sha512-3Xnr+7ZFS1uxeiUDvV02wQ+QDbc55o97tIV5zHScSPJpcLm/r0DFPcoY3tYRp+VZukxuMeKgXYmsXQHO05zQeA==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/character-reference-invalid": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/character-reference-invalid/-/character-reference-invalid-1.1.4.tgz",
+      "integrity": "sha512-mKKUkUbhPpQlCOfIuZkvSEgktjPFIsZKRRbC6KWVEMvlzblj3i3asQv5ODsrwt0N3pHAEvjP8KTQPHkp0+6jOg==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/is-alphabetical": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/is-alphabetical/-/is-alphabetical-1.0.4.tgz",
+      "integrity": "sha512-DwzsA04LQ10FHTZuL0/grVDk4rFoVH1pjAToYwBrHSxcrBIGQuXrQMtD5U1b0U2XVgKZCTLLP8u2Qxqhy3l2Vg==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/is-alphanumerical": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/is-alphanumerical/-/is-alphanumerical-1.0.4.tgz",
+      "integrity": "sha512-UzoZUr+XfVz3t3v4KyGEniVL9BDRoQtY7tOyrRybkVNjDFWyo1yhXNGrrBTQxp3ib9BLAWs7k2YKBQsFRkZG9A==",
+      "license": "MIT",
+      "dependencies": {
+        "is-alphabetical": "^1.0.0",
+        "is-decimal": "^1.0.0"
+      },
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/is-decimal": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/is-decimal/-/is-decimal-1.0.4.tgz",
+      "integrity": "sha512-RGdriMmQQvZ2aqaQq3awNA6dCGtKpiDFcOzrTWrDAT2MiWrKQVPmxLGHl7Y2nNu6led0kEyoX0enY0qXYsv9zw==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/is-hexadecimal": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/is-hexadecimal/-/is-hexadecimal-1.0.4.tgz",
+      "integrity": "sha512-gyPJuv83bHMpocVYoqof5VDiZveEoGoFL8m3BXNb2VW8Xs+rz9kqO8LOQ5DH6EsuvilT1ApazU0pyl+ytbPtlw==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/refractor/node_modules/parse-entities": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/parse-entities/-/parse-entities-2.0.0.tgz",
+      "integrity": "sha512-kkywGpCcRYhqQIchaWqZ875wzpS/bMKhz5HnN3p7wveJTkTtyAB/AlnS0f8DFSqYW1T82t6yEAkEcB+A1I3MbQ==",
+      "license": "MIT",
+      "dependencies": {
+        "character-entities": "^1.0.0",
+        "character-entities-legacy": "^1.0.0",
+        "character-reference-invalid": "^1.0.0",
+        "is-alphanumerical": "^1.0.0",
+        "is-decimal": "^1.0.0",
+        "is-hexadecimal": "^1.0.0"
+      },
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
     "node_modules/refractor/node_modules/prismjs": {
       "version": "1.27.0",
+      "resolved": "https://registry.npmjs.org/prismjs/-/prismjs-1.27.0.tgz",
+      "integrity": "sha512-t13BGPUlFDR7wRB5kQDG4jjl7XeuH6jbJGt11JHPL96qwsEHNX2+68tFXqc1/k+/jALsbSWJKUOT/hcYAZ5LkA==",
       "license": "MIT",
       "engines": {
         "node": ">=6"
       }
     },
-    "node_modules/regenerator-runtime": {
-      "version": "0.14.0",
-      "license": "MIT"
-    },
     "node_modules/rehype-raw": {
       "version": "7.0.0",
       "resolved": "https://registry.npmjs.org/rehype-raw/-/rehype-raw-7.0.0.tgz",
@@ -5437,19 +5513,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/rehype-raw/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/remark-gfm": {
-      "version": "4.0.0",
-      "resolved": "https://registry.npmjs.org/remark-gfm/-/remark-gfm-4.0.0.tgz",
-      "integrity": "sha512-U92vJgBPkbw4Zfu/IiW2oTZLSL3Zpv+uI7My2eq8JxKgqraFdU8YUGicEJCEgSbeaG+QDFqIcwwfMTOEelPxuA==",
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/remark-gfm/-/remark-gfm-4.0.1.tgz",
+      "integrity": "sha512-1quofZ2RQ9EWdeN34S79+KExV1764+wCUGop5CPL1WGdD0ocPpu91lzPGbwWMECpEpd42kJGQwzRfyov9j4yNg==",
       "license": "MIT",
       "dependencies": {
         "@types/mdast": "^4.0.0",
@@ -5481,9 +5548,9 @@
       }
     },
     "node_modules/remark-rehype": {
-      "version": "11.1.0",
-      "resolved": "https://registry.npmjs.org/remark-rehype/-/remark-rehype-11.1.0.tgz",
-      "integrity": "sha512-z3tJrAs2kIs1AqIIy6pzHmAHlF1hWQ+OdY4/hv+Wxe35EhyLKcajL33iUEn3ScxtFox9nUvRufR/Zre8Q08H/g==",
+      "version": "11.1.2",
+      "resolved": "https://registry.npmjs.org/remark-rehype/-/remark-rehype-11.1.2.tgz",
+      "integrity": "sha512-Dh7l57ianaEoIpzbp0PC9UKAdCSVklD8E5Rpw7ETfbTl3FqcOOgq5q2LVDhgGCkaBv7p24JXikPdvhhmHvKMsw==",
       "license": "MIT",
       "dependencies": {
         "@types/hast": "^3.0.0",
@@ -5497,15 +5564,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/remark-rehype/node_modules/@types/hast": {
-      "version": "3.0.4",
-      "resolved": "https://registry.npmjs.org/@types/hast/-/hast-3.0.4.tgz",
-      "integrity": "sha512-WPs+bbQw5aCj+x6laNGWLH3wviHtoCv/P3+otBhbOhJgG8qtpdAMlTCxLtsTWA7LH1Oh/bFCHsBn0TPS5m30EQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "*"
-      }
-    },
     "node_modules/remark-stringify": {
       "version": "11.0.0",
       "resolved": "https://registry.npmjs.org/remark-stringify/-/remark-stringify-11.0.0.tgz",
@@ -5532,9 +5590,9 @@
       }
     },
     "node_modules/rollup": {
-      "version": "4.46.1",
-      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.46.1.tgz",
-      "integrity": "sha512-33xGNBsDJAkzt0PvninskHlWnTIPgDtTwhg0U38CUoNP/7H6wI2Cz6dUeoNPbjdTdsYTGuiFFASuUOWovH0SyQ==",
+      "version": "4.22.4",
+      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.22.4.tgz",
+      "integrity": "sha512-vD8HJ5raRcWOyymsR6Z3o6+RzfEPCnVLMFJ6vRslO1jt4LO6dUo5Qnpg7y4RkZFM2DMe3WUirkI5c16onjrc6A==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
@@ -5548,38 +5606,34 @@
         "npm": ">=8.0.0"
       },
       "optionalDependencies": {
-        "@rollup/rollup-android-arm-eabi": "4.46.1",
-        "@rollup/rollup-android-arm64": "4.46.1",
-        "@rollup/rollup-darwin-arm64": "4.46.1",
-        "@rollup/rollup-darwin-x64": "4.46.1",
-        "@rollup/rollup-freebsd-arm64": "4.46.1",
-        "@rollup/rollup-freebsd-x64": "4.46.1",
-        "@rollup/rollup-linux-arm-gnueabihf": "4.46.1",
-        "@rollup/rollup-linux-arm-musleabihf": "4.46.1",
-        "@rollup/rollup-linux-arm64-gnu": "4.46.1",
-        "@rollup/rollup-linux-arm64-musl": "4.46.1",
-        "@rollup/rollup-linux-loongarch64-gnu": "4.46.1",
-        "@rollup/rollup-linux-ppc64-gnu": "4.46.1",
-        "@rollup/rollup-linux-riscv64-gnu": "4.46.1",
-        "@rollup/rollup-linux-riscv64-musl": "4.46.1",
-        "@rollup/rollup-linux-s390x-gnu": "4.46.1",
-        "@rollup/rollup-linux-x64-gnu": "4.46.1",
-        "@rollup/rollup-linux-x64-musl": "4.46.1",
-        "@rollup/rollup-win32-arm64-msvc": "4.46.1",
-        "@rollup/rollup-win32-ia32-msvc": "4.46.1",
-        "@rollup/rollup-win32-x64-msvc": "4.46.1",
+        "@rollup/rollup-android-arm-eabi": "4.22.4",
+        "@rollup/rollup-android-arm64": "4.22.4",
+        "@rollup/rollup-darwin-arm64": "4.22.4",
+        "@rollup/rollup-darwin-x64": "4.22.4",
+        "@rollup/rollup-linux-arm-gnueabihf": "4.22.4",
+        "@rollup/rollup-linux-arm-musleabihf": "4.22.4",
+        "@rollup/rollup-linux-arm64-gnu": "4.22.4",
+        "@rollup/rollup-linux-arm64-musl": "4.22.4",
+        "@rollup/rollup-linux-powerpc64le-gnu": "4.22.4",
+        "@rollup/rollup-linux-riscv64-gnu": "4.22.4",
+        "@rollup/rollup-linux-s390x-gnu": "4.22.4",
+        "@rollup/rollup-linux-x64-gnu": "4.22.4",
+        "@rollup/rollup-linux-x64-musl": "4.22.4",
+        "@rollup/rollup-win32-arm64-msvc": "4.22.4",
+        "@rollup/rollup-win32-ia32-msvc": "4.22.4",
+        "@rollup/rollup-win32-x64-msvc": "4.22.4",
         "fsevents": "~2.3.2"
       }
     },
     "node_modules/rollup-plugin-visualizer": {
-      "version": "5.12.0",
-      "resolved": "https://registry.npmjs.org/rollup-plugin-visualizer/-/rollup-plugin-visualizer-5.12.0.tgz",
-      "integrity": "sha512-8/NU9jXcHRs7Nnj07PF2o4gjxmm9lXIrZ8r175bT9dK8qoLlvKTwRMArRCMgpMGlq8CTLugRvEmyMeMXIU2pNQ==",
+      "version": "5.14.0",
+      "resolved": "https://registry.npmjs.org/rollup-plugin-visualizer/-/rollup-plugin-visualizer-5.14.0.tgz",
+      "integrity": "sha512-VlDXneTDaKsHIw8yzJAFWtrzguoJ/LnQ+lMpoVfYJ3jJF4Ihe5oYLAqLklIK/35lgUY+1yEzCkHyZ1j4A5w5fA==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
         "open": "^8.4.0",
-        "picomatch": "^2.3.1",
+        "picomatch": "^4.0.2",
         "source-map": "^0.7.4",
         "yargs": "^17.5.1"
       },
@@ -5587,17 +5641,35 @@
         "rollup-plugin-visualizer": "dist/bin/cli.js"
       },
       "engines": {
-        "node": ">=14"
+        "node": ">=18"
       },
       "peerDependencies": {
+        "rolldown": "1.x",
         "rollup": "2.x || 3.x || 4.x"
       },
       "peerDependenciesMeta": {
+        "rolldown": {
+          "optional": true
+        },
         "rollup": {
           "optional": true
         }
       }
     },
+    "node_modules/rollup/node_modules/@rollup/rollup-linux-x64-gnu": {
+      "version": "4.46.2",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.46.2.tgz",
+      "integrity": "sha512-Jj5a9RUoe5ra+MEyERkDKLwTXVu6s3aACP51nkfnK9wJTraCC8IMe3snOfALkrjTYd2G1ViE1hICj0fZ7ALBPA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
     "node_modules/rtl-css-js": {
       "version": "1.16.1",
       "resolved": "https://registry.npmjs.org/rtl-css-js/-/rtl-css-js-1.16.1.tgz",
@@ -5609,6 +5681,8 @@
     },
     "node_modules/scheduler": {
       "version": "0.20.2",
+      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.20.2.tgz",
+      "integrity": "sha512-2eWfGgAqqWFGqtdMmcL5zCMK1U8KlXv8SQFGglL3CEtd0aDVDWgeF/YoCmvln55m5zSk3J/20hTaSBeSObsQDQ==",
       "license": "MIT",
       "dependencies": {
         "loose-envify": "^1.1.0",
@@ -5632,13 +5706,13 @@
       "license": "MIT"
     },
     "node_modules/source-map": {
-      "version": "0.7.4",
-      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.7.4.tgz",
-      "integrity": "sha512-l3BikUxvPOcn5E74dZiq5BGsTb5yEwhaTSzccU6t4sDOH8NWJCstKO5QT2CvtFoK6F0saL7p9xHAqHOlCPJygA==",
+      "version": "0.7.6",
+      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.7.6.tgz",
+      "integrity": "sha512-i5uvt8C3ikiWeNZSVZNWcfZPItFQOsYTUAOkcUPGd8DqDy1uOUikjt5dG+uRlwyvR108Fb9DOd4GvXfT0N2/uQ==",
       "dev": true,
       "license": "BSD-3-Clause",
       "engines": {
-        "node": ">= 8"
+        "node": ">= 12"
       }
     },
     "node_modules/source-map-js": {
@@ -5652,7 +5726,9 @@
       }
     },
     "node_modules/space-separated-tokens": {
-      "version": "1.1.5",
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/space-separated-tokens/-/space-separated-tokens-2.0.2.tgz",
+      "integrity": "sha512-PEGlAwrG8yXGXRjW32fGbg66JAlOAwbObuqVoJpv/mRgoWDQfgH1wDPvtzWyUSNAXBGSk8h755YDbbcEy3SH2Q==",
       "license": "MIT",
       "funding": {
         "type": "github",
@@ -5688,16 +5764,6 @@
         "url": "https://github.com/sponsors/wooorm"
       }
     },
-    "node_modules/stringify-entities/node_modules/character-entities-legacy": {
-      "version": "3.0.0",
-      "resolved": "https://registry.npmjs.org/character-entities-legacy/-/character-entities-legacy-3.0.0.tgz",
-      "integrity": "sha512-RpPp0asT/6ufRm//AJVwpViZbGM/MkjQFxJccQRHmISF/22NBtsHqAWmL+/pmkPWoIUJdWyeVleTl1wydHATVQ==",
-      "license": "MIT",
-      "funding": {
-        "type": "github",
-        "url": "https://github.com/sponsors/wooorm"
-      }
-    },
     "node_modules/strip-ansi": {
       "version": "6.0.1",
       "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
@@ -5711,30 +5777,49 @@
         "node": ">=8"
       }
     },
+    "node_modules/style-to-js": {
+      "version": "1.1.17",
+      "resolved": "https://registry.npmjs.org/style-to-js/-/style-to-js-1.1.17.tgz",
+      "integrity": "sha512-xQcBGDxJb6jjFCTzvQtfiPn6YvvP2O8U1MDIPNfJQlWMYfktPy+iGsHE7cssjs7y84d9fQaK4UF3RIJaAHSoYA==",
+      "license": "MIT",
+      "dependencies": {
+        "style-to-object": "1.0.9"
+      }
+    },
     "node_modules/style-to-object": {
-      "version": "1.0.6",
-      "resolved": "https://registry.npmjs.org/style-to-object/-/style-to-object-1.0.6.tgz",
-      "integrity": "sha512-khxq+Qm3xEyZfKd/y9L3oIWQimxuc4STrQKtQn8aSDRHb8mFgpukgX1hdzfrMEW6JCjyJ8p89x+IUMVnCBI1PA==",
+      "version": "1.0.9",
+      "resolved": "https://registry.npmjs.org/style-to-object/-/style-to-object-1.0.9.tgz",
+      "integrity": "sha512-G4qppLgKu/k6FwRpHiGiKPaPTFcG3g4wNVX/Qsfu+RqQM30E7Tyu/TEgxcL9PNLF5pdRLwQdE3YKKf+KF2Dzlw==",
       "license": "MIT",
       "dependencies": {
-        "inline-style-parser": "0.2.3"
+        "inline-style-parser": "0.2.4"
       }
     },
     "node_modules/stylis": {
-      "version": "4.3.2",
-      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.2.tgz",
-      "integrity": "sha512-bhtUjWd/z6ltJiQwg0dUfxEJ+W+jdqQd8TbWLWyeIJHlnsqmGLRFFd8e5mA0AZi/zx90smXRlN66YMTcaSFifg==",
+      "version": "4.3.6",
+      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.6.tgz",
+      "integrity": "sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==",
       "license": "MIT"
     },
     "node_modules/tabster": {
-      "version": "8.2.0",
-      "resolved": "https://registry.npmjs.org/tabster/-/tabster-8.2.0.tgz",
-      "integrity": "sha512-Gvplk/Yl/12aVFA6FPOqGcq31Qv8hbPfYO0N+6IxrRgRT6eSLsipT6gkZBYjyOwGsp6BD5XlZAuJgupfG/GHoA==",
+      "version": "8.5.6",
+      "resolved": "https://registry.npmjs.org/tabster/-/tabster-8.5.6.tgz",
+      "integrity": "sha512-2vfrRGrx8O9BjdrtSlVA5fvpmbq5HQBRN13XFRg6LAvZ1Fr3QdBnswgT4YgFS5Bhoo5nxwgjRaRueI2Us/dv7g==",
+      "license": "MIT",
       "dependencies": {
         "keyborg": "2.6.0",
         "tslib": "^2.3.1"
       }
     },
+    "node_modules/to-fast-properties": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/to-fast-properties/-/to-fast-properties-2.0.0.tgz",
+      "integrity": "sha512-/OaKK0xYrs3DmxRYqL/yDc+FxFUVYhDlXMhRmv3z915w2HF1tnN1omB354j8VUGO/hbRzyD6Y3sA7v7GS/ceog==",
+      "dev": true,
+      "engines": {
+        "node": ">=4"
+      }
+    },
     "node_modules/tr46": {
       "version": "0.0.3",
       "resolved": "https://registry.npmjs.org/tr46/-/tr46-0.0.3.tgz",
@@ -5762,14 +5847,17 @@
       }
     },
     "node_modules/tslib": {
-      "version": "2.5.0",
+      "version": "2.8.1",
+      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
+      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
       "license": "0BSD"
     },
     "node_modules/typescript": {
-      "version": "5.6.3",
-      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.6.3.tgz",
-      "integrity": "sha512-hjcS1mhfuyi4WW8IWtjP7brDrG2cuDZukyrYrSauoXGNgx0S7zceP07adYkJycEr56BOUTNPzbInooiN3fn1qw==",
+      "version": "5.9.2",
+      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.2.tgz",
+      "integrity": "sha512-CWBzXQrc/qOkhidw1OzBTQuYRbfyxDXJMVJ1XNwUHGROVmuaeiEm3OslpZ1RV96d7SKKjZKrSJu3+t/xlw3R9A==",
       "devOptional": true,
+      "license": "Apache-2.0",
       "bin": {
         "tsc": "bin/tsc",
         "tsserver": "bin/tsserver"
@@ -5797,12 +5885,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/unified/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/unist-util-is": {
       "version": "6.0.0",
       "resolved": "https://registry.npmjs.org/unist-util-is/-/unist-util-is-6.0.0.tgz",
@@ -5816,12 +5898,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/unist-util-is/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/unist-util-position": {
       "version": "5.0.0",
       "resolved": "https://registry.npmjs.org/unist-util-position/-/unist-util-position-5.0.0.tgz",
@@ -5835,32 +5911,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/unist-util-position/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/unist-util-remove-position": {
-      "version": "5.0.0",
-      "resolved": "https://registry.npmjs.org/unist-util-remove-position/-/unist-util-remove-position-5.0.0.tgz",
-      "integrity": "sha512-Hp5Kh3wLxv0PHj9m2yZhhLt58KzPtEYKQQ4yxfYFEO7EvHwzyDYnduhHnY1mDxoqr7VUwVuHXk9RXKIiYS1N8Q==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/unist": "^3.0.0",
-        "unist-util-visit": "^5.0.0"
-      },
-      "funding": {
-        "type": "opencollective",
-        "url": "https://opencollective.com/unified"
-      }
-    },
-    "node_modules/unist-util-remove-position/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/unist-util-stringify-position": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/unist-util-stringify-position/-/unist-util-stringify-position-4.0.0.tgz",
@@ -5874,12 +5924,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/unist-util-stringify-position/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/unist-util-visit": {
       "version": "5.0.0",
       "resolved": "https://registry.npmjs.org/unist-util-visit/-/unist-util-visit-5.0.0.tgz",
@@ -5909,18 +5953,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/unist-util-visit-parents/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/unist-util-visit/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/update-browserslist-db": {
       "version": "1.1.3",
       "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.1.3.tgz",
@@ -5952,33 +5984,22 @@
         "browserslist": ">= 4.21.0"
       }
     },
-    "node_modules/use-disposable": {
-      "version": "1.0.4",
-      "resolved": "https://registry.npmjs.org/use-disposable/-/use-disposable-1.0.4.tgz",
-      "integrity": "sha512-j83t6AMLWUyb5zwlTDqf6dP9LezM9R0yTbI/b6olmdaGtCKQUe9pgJWV6dRaaQLcozypjIEp4EmZr2DkZGKLSg==",
-      "peerDependencies": {
-        "@types/react": ">=16.8.0 <19.0.0",
-        "@types/react-dom": ">=16.8.0 <19.0.0",
-        "react": ">=16.8.0 <19.0.0",
-        "react-dom": ">=16.8.0 <19.0.0"
-      }
-    },
     "node_modules/use-sync-external-store": {
-      "version": "1.2.2",
-      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.2.2.tgz",
-      "integrity": "sha512-PElTlVMwpblvbNqQ82d2n6RjStvdSoNe9FG28kNfz3WiXilJm4DdNkEzRhCZuIDwY8U08WVihhGR5iRqAwfDiw==",
+      "version": "1.5.0",
+      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.5.0.tgz",
+      "integrity": "sha512-Rb46I4cGGVBmjamjphe8L/UnvJD+uPPtTkNvX5mZgqdbavhI4EbgIWJiIHXJ8bc/i9EQGPRh4DwEURJ552Do0A==",
+      "license": "MIT",
       "peerDependencies": {
-        "react": "^16.8.0 || ^17.0.0 || ^18.0.0"
+        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
       }
     },
     "node_modules/vfile": {
-      "version": "6.0.2",
-      "resolved": "https://registry.npmjs.org/vfile/-/vfile-6.0.2.tgz",
-      "integrity": "sha512-zND7NlS8rJYb/sPqkb13ZvbbUoExdbi4w3SfRrMq6R3FvnLQmmfpajJNITuuYm6AZ5uao9vy4BAos3EXBPf2rg==",
+      "version": "6.0.3",
+      "resolved": "https://registry.npmjs.org/vfile/-/vfile-6.0.3.tgz",
+      "integrity": "sha512-KzIbH/9tXat2u30jf+smMwFCsno4wHVdNmzFyL+T/L3UGqqk6JKfVqOFOZEpZSHADH1k40ab6NUIXZq422ov3Q==",
       "license": "MIT",
       "dependencies": {
         "@types/unist": "^3.0.0",
-        "unist-util-stringify-position": "^4.0.0",
         "vfile-message": "^4.0.0"
       },
       "funding": {
@@ -6000,16 +6021,10 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/vfile-location/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/vfile-message": {
-      "version": "4.0.2",
-      "resolved": "https://registry.npmjs.org/vfile-message/-/vfile-message-4.0.2.tgz",
-      "integrity": "sha512-jRDZ1IMLttGj41KcZvlrYAaI3CfqpLpfpf+Mfig13viT6NKvRzWZ+lXz0Y5D60w6uJIBAOGq9mSHf0gktF0duw==",
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/vfile-message/-/vfile-message-4.0.3.tgz",
+      "integrity": "sha512-QTHzsGd1EhbZs4AsQ20JX1rC3cOlt/IWJruk893DfLRr57lcnOeMaWG4K0JrRta4mIJZKth2Au3mM3u03/JWKw==",
       "license": "MIT",
       "dependencies": {
         "@types/unist": "^3.0.0",
@@ -6020,18 +6035,6 @@
         "url": "https://opencollective.com/unified"
       }
     },
-    "node_modules/vfile-message/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
-    "node_modules/vfile/node_modules/@types/unist": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-3.0.3.tgz",
-      "integrity": "sha512-ko/gIFJRv177XgZsZcBwnqJN5x/Gien8qNOn0D5bQU/zAzVf9Zt3BlcUiLqhV9y4ARk0GbT3tnUiPNgnTXzc/Q==",
-      "license": "MIT"
-    },
     "node_modules/vite": {
       "version": "5.4.19",
       "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.19.tgz",
@@ -6145,44 +6148,10 @@
         "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
       }
     },
-    "node_modules/wrap-ansi/node_modules/ansi-styles": {
-      "version": "4.3.0",
-      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
-      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "color-convert": "^2.0.1"
-      },
-      "engines": {
-        "node": ">=8"
-      },
-      "funding": {
-        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
-      }
-    },
-    "node_modules/wrap-ansi/node_modules/color-convert": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
-      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "color-name": "~1.1.4"
-      },
-      "engines": {
-        "node": ">=7.0.0"
-      }
-    },
-    "node_modules/wrap-ansi/node_modules/color-name": {
-      "version": "1.1.4",
-      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
-      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
-      "dev": true,
-      "license": "MIT"
-    },
     "node_modules/xtend": {
       "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/xtend/-/xtend-4.0.2.tgz",
+      "integrity": "sha512-LKYU1iAXJXUgAXn9URjiu+MWhyUXHsvfp7mcuYm9dSUKK0/CjtrUwFAxD82/mCWbtLsGjFIad0wIsod4zrTAEQ==",
       "license": "MIT",
       "engines": {
         "node": ">=0.4"
diff --git a/app/frontend/src/api/api.ts b/app/frontend/src/api/api.ts
index df95f80..5263751 100644
--- a/app/frontend/src/api/api.ts
+++ b/app/frontend/src/api/api.ts
@@ -79,7 +79,14 @@ export async function getSpeechApi(text: string): Promise<string | null> {
 }
 
 export function getCitationFilePath(citation: string): string {
-    return `${BACKEND_URI}/content/${citation}`;
+    // If citation is already a URL (storageUrl), return it directly
+    if (citation.startsWith("http://") || citation.startsWith("https://")) {
+        return citation;
+    }
+
+    // For traditional citations, pass through to backend content endpoint
+    // The backend will handle redirection to storageUrl if available
+    return `/content/${encodeURIComponent(citation)}`;
 }
 
 export async function uploadFileApi(request: FormData, idToken: string): Promise<SimpleAPIResponse> {
diff --git a/app/frontend/src/api/models.ts b/app/frontend/src/api/models.ts
index 63ff5c3..52fde8c 100644
--- a/app/frontend/src/api/models.ts
+++ b/app/frontend/src/api/models.ts
@@ -56,7 +56,7 @@ export type Thoughts = {
 };
 
 export type ResponseContext = {
-    data_points: string[];
+    data_points: string[] | any[]; // Can be array of strings or array of objects with storageUrl
     followup_questions: string[] | null;
     thoughts: Thoughts[];
 };
@@ -131,3 +131,16 @@ export type HistoryApiResponse = {
     entra_oid: string;
     answers: any;
 };
+
+export type Citation = {
+    content: string;
+    id: string;
+    title: string | null;
+    filepath: string | null;
+    url: string | null;
+    metadata: string | null;
+    chunk_id: string | null;
+    reindex_id: string | null;
+    sourcepage?: string;
+    source?: string;
+};
diff --git a/app/frontend/src/components/AnalysisPanel/AnalysisPanel.tsx b/app/frontend/src/components/AnalysisPanel/AnalysisPanel.tsx
index 2cee00c..2bb679d 100644
--- a/app/frontend/src/components/AnalysisPanel/AnalysisPanel.tsx
+++ b/app/frontend/src/components/AnalysisPanel/AnalysisPanel.tsx
@@ -19,14 +19,123 @@ interface Props {
     activeCitation: string | undefined;
     citationHeight: string;
     answer: ChatAppResponse;
+    activeCitationLabel?: string | undefined;
+    activeCitationContent?: string | undefined;
+    enableCitationTab?: boolean; // Add new prop
 }
 
 const pivotItemDisabledStyle = { disabled: true, style: { color: "grey" } };
 
-export const AnalysisPanel = ({ answer, activeTab, activeCitation, citationHeight, className, onActiveTabChanged }: Props) => {
+export const AnalysisPanel = ({
+    answer,
+    activeTab,
+    activeCitation,
+    citationHeight,
+    className,
+    onActiveTabChanged,
+    activeCitationLabel,
+    activeCitationContent,
+    enableCitationTab = false // Default to false
+}: Props) => {
+    // Add defensive handling for data_points structure first
+    const getDataPointsArray = (dataPoints: any): any[] => {
+        if (!dataPoints) {
+            return [];
+        }
+
+        if (Array.isArray(dataPoints)) {
+            return dataPoints;
+        }
+
+        if (dataPoints.text && Array.isArray(dataPoints.text)) {
+            return dataPoints.text.map((textItem: any, index: number) => {
+                // Add type checking before string operations
+                if (typeof textItem === "string" && textItem.length > 0) {
+                    const urlMatch = textItem.match(/^(https?:\/\/[^:]+):\s*/);
+                    if (urlMatch) {
+                        const content = textItem.substring(urlMatch[0].length);
+                        return {
+                            id: index,
+                            content: content,
+                            storageUrl: urlMatch[1],
+                            sourcepage: `Source ${index + 1}`,
+                            sourcefile: content.substring(0, 50) + "..."
+                        };
+                    }
+                    return {
+                        id: index,
+                        content: textItem,
+                        sourcepage: `Source ${index + 1}`,
+                        sourcefile: textItem.substring(0, 50) + "..."
+                    };
+                } else if (textItem && typeof textItem === "object") {
+                    // If it's already an object, return it as-is with defaults
+                    return {
+                        id: index,
+                        content: textItem.content || "",
+                        storageUrl: textItem.storageUrl || "",
+                        sourcepage: textItem.sourcepage || `Source ${index + 1}`,
+                        sourcefile: textItem.sourcefile || ""
+                    };
+                } else {
+                    // Fallback for any other type
+                    return {
+                        id: index,
+                        content: String(textItem || ""),
+                        sourcepage: `Source ${index + 1}`,
+                        sourcefile: ""
+                    };
+                }
+            });
+        }
+
+        return [];
+    };
+
+    const dataPointsArray = getDataPointsArray(answer.context.data_points);
+
+    // Helper to extract supporting content from context data_points or thoughts "Results" step
+    const getSupportingContent = (answer: ChatAppResponse): any[] => {
+        // 1. Prefer structured objects from context.data_points if available
+        const dataPoints = answer.context?.data_points;
+
+        console.log("Getting supporting content from:", {
+            hasDataPoints: !!dataPoints,
+            isArray: Array.isArray(dataPoints),
+            type: typeof dataPoints,
+            keys: dataPoints ? Object.keys(dataPoints) : []
+        });
+
+        if (Array.isArray(dataPoints) && dataPoints.length > 0) {
+            console.log("Using data_points array with", dataPoints.length, "items");
+            return dataPoints;
+        }
+
+        // 2. Handle data_points.text structure
+        if (dataPoints && !Array.isArray(dataPoints) && typeof dataPoints === "object" && "text" in dataPoints && Array.isArray((dataPoints as any).text)) {
+            console.log("Using data_points.text array with", (dataPoints as any).text.length, "items");
+            return (dataPoints as any).text;
+        }
+
+        // 3. Fallback to thoughts "Results" step if available
+        const thoughts = answer.context?.thoughts;
+        if (Array.isArray(thoughts)) {
+            const resultsStep = thoughts.find((t: any) => t.title === "Results" && Array.isArray(t.description));
+            if (resultsStep && Array.isArray(resultsStep.description)) {
+                console.log("Using thoughts Results step with", resultsStep.description.length, "items");
+                return resultsStep.description;
+            }
+        }
+
+        console.log("No supporting content found");
+        return [];
+    };
+
+    const supportingContentItems = getSupportingContent(answer);
+
     const isDisabledThoughtProcessTab: boolean = !answer.context.thoughts;
-    const isDisabledSupportingContentTab: boolean = !answer.context.data_points;
-    const isDisabledCitationTab: boolean = !activeCitation;
+    const isDisabledSupportingContentTab: boolean = supportingContentItems.length === 0;
+    const isDisabledCitationTab: boolean = !activeCitation || !enableCitationTab; // Modified condition
     const [citation, setCitation] = useState("");
 
     const client = useLogin ? useMsal().instance : undefined;
@@ -35,39 +144,140 @@ export const AnalysisPanel = ({ answer, activeTab, activeCitation, citationHeigh
     const fetchCitation = async () => {
         const token = client ? await getToken(client) : undefined;
         if (activeCitation) {
-            // Get hash from the URL as it may contain #page=N
-            // which helps browser PDF renderer jump to correct page N
-            const originalHash = activeCitation.indexOf("#") ? activeCitation.split("#")[1] : "";
-            const response = await fetch(activeCitation, {
-                method: "GET",
-                headers: await getHeaders(token)
-            });
-            const citationContent = await response.blob();
-            let citationObjectUrl = URL.createObjectURL(citationContent);
-            // Add hash back to the new blob URL
-            if (originalHash) {
-                citationObjectUrl += "#" + originalHash;
+            try {
+                // Get hash from the URL as it may contain #page=N
+                const originalHash = activeCitation.indexOf("#") > -1 ? activeCitation.split("#")[1] : "";
+
+                // Check if this is an external URL that should go through the browser directly
+                if (activeCitation.startsWith("http://") || activeCitation.startsWith("https://")) {
+                    setCitation(activeCitation);
+                    return;
+                }
+
+                // For internal citations in development, skip the backend fetch and just use the citation directly
+                // This prevents 404 errors when the backend content endpoint doesn't exist
+                if (import.meta.env.DEV) {
+                    setCitation(activeCitation);
+                    return;
+                }
+
+                // For production, use the backend content endpoint
+                const decodedCitation = decodeURIComponent(activeCitation);
+                let contentUrl = `/content/${encodeURIComponent(decodedCitation)}`;
+
+                const response = await fetch(contentUrl, {
+                    method: "GET",
+                    headers: await getHeaders(token)
+                });
+
+                if (response.ok) {
+                    const citationContent = await response.blob();
+                    let citationObjectUrl = URL.createObjectURL(citationContent);
+                    // Add hash back to the new blob URL
+                    if (originalHash) {
+                        citationObjectUrl += "#" + originalHash;
+                    }
+                    setCitation(citationObjectUrl);
+                } else {
+                    console.warn("Backend content endpoint not available, using direct citation");
+                    setCitation(activeCitation);
+                }
+            } catch (error) {
+                console.warn("Error fetching citation, using direct citation:", error);
+                setCitation(activeCitation);
+            }
+        }
+    };
+
+    // Extract citation reference from the activeCitation
+    const getActiveCitationReference = (): string | undefined => {
+        // Always use the citation label if provided - this is the clean citation text
+        if (activeCitationLabel) {
+            return activeCitationLabel;
+        }
+
+        if (!activeCitation) return undefined;
+
+        try {
+            // Parse three-part citation format
+            const citationParts = activeCitation.split(",").map(p => p.trim());
+            if (citationParts.length >= 3) {
+                // Return the full three-part citation for matching
+                return activeCitation;
+            }
+
+            // If it's a URL, extract filename and decode it
+            if (activeCitation.startsWith("http://") || activeCitation.startsWith("https://") || activeCitation.includes("/")) {
+                const parts = activeCitation.split("/");
+                const filename = parts[parts.length - 1];
+                const decoded = decodeURIComponent(filename.split(".")[0].split("?")[0].split("#")[0]);
+                return decoded;
             }
-            setCitation(citationObjectUrl);
+
+            // Otherwise assume it's already a citation label
+            return activeCitation;
+        } catch (error) {
+            console.error("Error parsing citation reference:", error);
+            return activeCitation; // Fallback to original citation
         }
     };
+
     useEffect(() => {
         fetchCitation();
-    }, []);
+    }, [activeCitation]);
 
     const renderFileViewer = () => {
         if (!activeCitation) {
             return null;
         }
 
-        const fileExtension = activeCitation.split(".").pop()?.toLowerCase();
-        switch (fileExtension) {
-            case "png":
-                return <img src={citation} className={styles.citationImg} alt="Citation Image" />;
-            case "md":
-                return <MarkdownViewer src={activeCitation} />;
-            default:
-                return <iframe title="Citation" src={citation} width="100%" height={citationHeight} />;
+        try {
+            const fileExtension = activeCitation.split(".").pop()?.toLowerCase();
+
+            // For external URLs, use iframe directly
+            if (activeCitation.startsWith("http://") || activeCitation.startsWith("https://")) {
+                return <iframe title="Citation" src={activeCitation} width="100%" height={citationHeight} />;
+            }
+
+            // For internal content, use the citation blob URL
+            switch (fileExtension) {
+                case "png":
+                    return <img src={citation} className={styles.citationImg} alt="Citation Image" />;
+                case "md":
+                    return <MarkdownViewer src={activeCitation} />;
+                default:
+                    return <iframe title="Citation" src={citation} width="100%" height={citationHeight} />;
+            }
+        } catch (error) {
+            console.error("Error rendering file viewer:", error);
+            return <div>Error loading citation content</div>;
+        }
+    };
+
+    // Handle viewing source document from supporting content
+    const handleViewSourceDocument = (citation: string) => {
+        try {
+            // Set the citation URL for viewing
+            if (citation.startsWith("http://") || citation.startsWith("https://")) {
+                setCitation(citation);
+            } else {
+                // For non-URL citations, try to find the corresponding URL from dataPoints
+                const dataPoint = dataPointsArray.find(
+                    dp => dp.sourcepage === citation || dp.sourcefile === citation || `${dp.sourcepage}, ${dp.sourcefile}` === citation
+                );
+
+                if (dataPoint?.storageUrl) {
+                    setCitation(dataPoint.storageUrl);
+                } else {
+                    setCitation(citation);
+                }
+            }
+            onActiveTabChanged(AnalysisPanelTabs.CitationTab);
+        } catch (error) {
+            console.error("Error handling view source document:", error);
+            // Fallback to just setting the citation
+            setCitation(citation);
+            onActiveTabChanged(AnalysisPanelTabs.CitationTab);
         }
     };
 
@@ -89,7 +299,12 @@ export const AnalysisPanel = ({ answer, activeTab, activeCitation, citationHeigh
                 headerText={t("headerTexts.supportingContent")}
                 headerButtonProps={isDisabledSupportingContentTab ? pivotItemDisabledStyle : undefined}
             >
-                <SupportingContent supportingContent={answer.context.data_points} />
+                <SupportingContent
+                    supportingContent={supportingContentItems}
+                    activeCitationReference={getActiveCitationReference()}
+                    activeCitationContent={activeCitationContent}
+                    onViewSourceDocument={handleViewSourceDocument}
+                />
             </PivotItem>
             <PivotItem
                 itemKey={AnalysisPanelTabs.CitationTab}
diff --git a/app/frontend/src/components/Answer/Answer.tsx b/app/frontend/src/components/Answer/Answer.tsx
index c9d73a8..5d72d95 100644
--- a/app/frontend/src/components/Answer/Answer.tsx
+++ b/app/frontend/src/components/Answer/Answer.tsx
@@ -1,4 +1,4 @@
-import { useMemo, useState } from "react";
+import { useEffect, useMemo, useState, useCallback } from "react";
 import { Stack, IconButton } from "@fluentui/react";
 import { useTranslation } from "react-i18next";
 import DOMPurify from "dompurify";
@@ -7,11 +7,15 @@ import remarkGfm from "remark-gfm";
 import rehypeRaw from "rehype-raw";
 
 import styles from "./Answer.module.css";
-import { ChatAppResponse, getCitationFilePath, SpeechConfig } from "../../api";
+import { ChatAppResponse, SpeechConfig } from "../../api";
 import { parseAnswerToHtml } from "./AnswerParser";
-import { AnswerIcon } from "./AnswerIcon";
-import { SpeechOutputBrowser } from "./SpeechOutputBrowser";
-import { SpeechOutputAzure } from "./SpeechOutputAzure";
+
+// Simple AnswerIcon component (replace with your actual icon as needed)
+const AnswerIcon = () => (
+    <span role="img" aria-label="Answer">
+        ðŸ’¡
+    </span>
+);
 
 interface Props {
     answer: ChatAppResponse;
@@ -19,7 +23,7 @@ interface Props {
     speechConfig: SpeechConfig;
     isSelected?: boolean;
     isStreaming: boolean;
-    onCitationClicked: (filePath: string) => void;
+    onCitationClicked: (filePath: string, citationContent?: string) => void;
     onThoughtProcessClicked: () => void;
     onSupportingContentClicked: () => void;
     onFollowupQuestionClicked?: (question: string) => void;
@@ -43,14 +47,185 @@ export const Answer = ({
     showSpeechOutputBrowser
 }: Props) => {
     const followupQuestions = answer.context?.followup_questions;
-    const parsedAnswer = useMemo(() => parseAnswerToHtml(answer, isStreaming, onCitationClicked), [answer]);
+    const parsedAnswer = useMemo(() => parseAnswerToHtml(answer, isStreaming), [answer, isStreaming]);
     const { t } = useTranslation();
-    const sanitizedAnswerHtml = DOMPurify.sanitize(parsedAnswer.answerHtml);
+
+    // Process the HTML to make citations clickable
+    const processedAnswerHtml = useMemo(() => {
+        let html = DOMPurify.sanitize(parsedAnswer.answerHtml);
+
+        // Add click handlers and proper styling to citation superscripts
+        html = html.replace(
+            /<sup class="citation-sup"([^>]*)>(\d+)<\/sup>/g,
+            '<sup class="citation-sup citation-clickable"$1 style="cursor: pointer; color: #0066cc; margin-left: 2px;">$2</sup>'
+        );
+
+        return html;
+    }, [parsedAnswer.answerHtml]);
+
     const [copied, setCopied] = useState(false);
 
+    // Add defensive handling for data_points before any .find() calls
+    const getDataPointsArray = (dataPoints: any): any[] => {
+        if (!dataPoints) {
+            return [];
+        }
+
+        if (Array.isArray(dataPoints)) {
+            return dataPoints;
+        }
+
+        if (dataPoints.text && Array.isArray(dataPoints.text)) {
+            // Convert text array to object format for backward compatibility
+            return dataPoints.text.map((textItem: any, index: number) => {
+                if (typeof textItem === "string" && textItem.length > 0) {
+                    const urlMatch = textItem.match(/^(https?:\/\/[^:]+):\s*/);
+                    if (urlMatch) {
+                        const content = textItem.substring(urlMatch[0].length);
+                        return {
+                            id: index,
+                            content,
+                            storageUrl: urlMatch[1],
+                            sourcepage: `Source ${index + 1}`,
+                            sourcefile: content.substring(0, 50) + "..."
+                        };
+                    }
+                    return {
+                        id: index,
+                        content: textItem,
+                        sourcepage: `Source ${index + 1}`,
+                        sourcefile: textItem.substring(0, 50) + "..."
+                    };
+                } else if (textItem && typeof textItem === "object") {
+                    // IMPORTANT: preserve all original fields (including subsection_id, subsection_index, original_doc_id, storageurl/url)
+                    return {
+                        id: index,
+                        ...textItem,
+                        content: textItem.content || "",
+                        storageUrl: textItem.storageUrl || textItem.storageurl || textItem.url || "",
+                        sourcepage: textItem.sourcepage || `Source ${index + 1}`,
+                        sourcefile: textItem.sourcefile || ""
+                    };
+                } else {
+                    return {
+                        id: index,
+                        content: String(textItem || ""),
+                        sourcepage: `Source ${index + 1}`,
+                        sourcefile: ""
+                    };
+                }
+            });
+        }
+
+        return [];
+    };
+
+    // Enhanced function to find matching content for a citation
+    const findMatchingSupportingContent = useCallback(
+        (citation: string) => {
+            if (!answer.context?.data_points) {
+                return undefined;
+            }
+
+            const dataPointsArray = getDataPointsArray(answer.context.data_points);
+            const citationParts = citation.split(",").map(p => p.trim());
+
+            console.log("Finding matching content for citation:", {
+                citation,
+                parts: citationParts,
+                dataPointsLength: dataPointsArray.length
+            });
+
+            // Three-part citations: subsection, sourcePage, sourceFile
+            if (citationParts.length >= 3) {
+                const subsection = citationParts[0];
+                const sourcePage = citationParts[citationParts.length - 2];
+                const sourceFile = citationParts[citationParts.length - 1];
+
+                // 0) Exact match on all three (subsection_id + sourcepage + sourcefile)
+                const exactAll = dataPointsArray.find(dp => {
+                    const dpSourcepage = String(dp.sourcepage || "").trim();
+                    const dpSourcefile = String(dp.sourcefile || "").trim();
+                    const dpSubsection = String(dp.subsection_id || "").trim();
+                    return dpSubsection === subsection && dpSourcepage === sourcePage && dpSourcefile === sourceFile;
+                });
+                if (exactAll) {
+                    console.log("Found exact match on subsection/sourcepage/sourcefile:", exactAll);
+                    return exactAll;
+                }
+
+                // 1) Match subsection in content start + exact page/file
+                const escaped = subsection.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
+                const startsWithPattern = new RegExp(`(^|\\n)\\s*${escaped}\\b`, "i");
+                const contentAndMetaMatch = dataPointsArray.find(dp => {
+                    const dpSourcepage = String(dp.sourcepage || "").trim();
+                    const dpSourcefile = String(dp.sourcefile || "").trim();
+                    const dpContent = String(dp.content || "");
+                    return startsWithPattern.test(dpContent) && dpSourcepage === sourcePage && dpSourcefile === sourceFile;
+                });
+                if (contentAndMetaMatch) {
+                    console.log("Found content+meta match:", contentAndMetaMatch);
+                    return contentAndMetaMatch;
+                }
+
+                // 2) Exact match on sourcepage + sourcefile as last resort
+                const exact = dataPointsArray.find(dp => {
+                    const dpSourcepage = String(dp.sourcepage || "").trim();
+                    const dpSourcefile = String(dp.sourcefile || "").trim();
+                    return dpSourcepage === sourcePage && dpSourcefile === sourceFile;
+                });
+                if (exact) {
+                    console.log("Found exact matching data point (page+file only):", exact);
+                    return exact;
+                }
+
+                // 3) Fuzzy includes
+                const fuzzy = dataPointsArray.find(dp => {
+                    const dpSourcepage = String(dp.sourcepage || "").trim();
+                    const dpSourcefile = String(dp.sourcefile || "").trim();
+                    return (
+                        dpSourcepage.includes(sourcePage) ||
+                        sourcePage.includes(dpSourcepage) ||
+                        dpSourcefile.includes(sourceFile) ||
+                        sourceFile.includes(dpSourcefile)
+                    );
+                });
+                if (fuzzy) {
+                    console.log("Found fuzzy matching data point:", fuzzy);
+                    return fuzzy;
+                }
+
+                console.log("No matching data point found for three-part citation");
+                return undefined;
+            }
+
+            // Two-part legacy citations
+            if (citationParts.length === 2) {
+                const [partA, partB] = citationParts;
+                const twoPartExact = dataPointsArray.find(dp => {
+                    const dpSourcepage = String(dp.sourcepage || "").trim();
+                    const dpSourcefile = String(dp.sourcefile || "").trim();
+                    return (dpSourcepage === partA && dpSourcefile === partB) || (dpSourcepage === partB && dpSourcefile === partA);
+                });
+                if (twoPartExact) return twoPartExact;
+            }
+
+            // Fallback
+            for (const dp of dataPointsArray) {
+                if (dp.sourcepage === citation || dp.sourcefile === citation) {
+                    return dp;
+                }
+            }
+
+            console.log("No matching content found for citation:", citation);
+            return undefined;
+        },
+        [answer.context?.data_points]
+    );
+
     const handleCopy = () => {
         // Single replace to remove all HTML tags to remove the citations
-        const textToCopy = sanitizedAnswerHtml.replace(/<a [^>]*><sup>\d+<\/sup><\/a>|<[^>]+>/g, "");
+        const textToCopy = processedAnswerHtml.replace(/<sup [^>]*>\d+<\/sup>|<[^>]+>/g, "");
 
         navigator.clipboard
             .writeText(textToCopy)
@@ -61,8 +236,85 @@ export const Answer = ({
             .catch(err => console.error("Failed to copy text: ", err));
     };
 
+    // Get data points as array for supporting content button
+    const dataPointsArray = getDataPointsArray(answer.context?.data_points);
+    const hasDataPoints = dataPointsArray.length > 0;
+
+    // Gate citation list visibility to avoid flicker during streaming
+    const [showCitations, setShowCitations] = useState(false);
+    useEffect(() => {
+        if (isStreaming) {
+            setShowCitations(false);
+            return;
+        }
+        // Small delay to allow final citations to stabilize post-stream
+        const timer = setTimeout(() => setShowCitations(true), 150);
+        return () => clearTimeout(timer);
+    }, [isStreaming]);
+
+    // Enhanced click handler for superscript citation links
+    useEffect(() => {
+        const handleCitationClick = (e: Event) => {
+            const target = e.target as HTMLElement;
+
+            if (target.classList.contains("citation-sup") || target.closest(".citation-sup")) {
+                e.preventDefault();
+                e.stopPropagation();
+
+                const citationElement = target.classList.contains("citation-sup") ? target : target.closest(".citation-sup");
+                const citationText = citationElement?.getAttribute("data-citation-text");
+                const citationContent = citationElement?.getAttribute("data-citation-content");
+
+                if (citationText) {
+                    console.log("Superscript citation clicked:", { citation: citationText });
+
+                    const matchingSupportingContent = findMatchingSupportingContent(citationText);
+                    let finalCitationContent = citationContent || matchingSupportingContent?.content || "";
+
+                    // Build normalized label strictly from citation parts + index fields
+                    let normalizedLabel = citationText;
+                    const parts = citationText.split(",").map(p => p.trim());
+                    if (parts.length >= 3) {
+                        const subsection = parts[0]; // keep original subsection like "D5.6"
+                        const sourcePage = parts[parts.length - 2];
+                        const sourceFile = parts[parts.length - 1];
+                        normalizedLabel = [subsection, sourcePage, sourceFile].filter(Boolean).join(", ");
+                    } else if (matchingSupportingContent) {
+                        const sourcePage = matchingSupportingContent.sourcepage || "";
+                        const sourceFile = matchingSupportingContent.sourcefile || "";
+                        normalizedLabel = [sourcePage, sourceFile].filter(Boolean).join(", ");
+                    }
+
+                    console.log("Citation click - content:", {
+                        citation: normalizedLabel,
+                        hasContent: !!finalCitationContent,
+                        contentLength: finalCitationContent?.length || 0
+                    });
+
+                    onCitationClicked(normalizedLabel, finalCitationContent || undefined);
+                }
+            }
+        };
+
+        // Add event listener to the answer container
+        const answerContainer = document.querySelector(`[data-answer-index="${index}"]`);
+        if (answerContainer) {
+            answerContainer.addEventListener("click", handleCitationClick);
+            return () => {
+                answerContainer.removeEventListener("click", handleCitationClick);
+            };
+        }
+    }, [onCitationClicked, index, findMatchingSupportingContent]);
+
+    const handleCitationLinkClick = useCallback(
+        (citationFilePath: string, citationContent?: string) => {
+            onCitationClicked(citationFilePath, citationContent);
+        },
+        [onCitationClicked]
+    );
+
     return (
-        <Stack className={`${styles.answerContainer} ${isSelected && styles.selected}`} verticalAlign="space-between">
+        <Stack className={`${styles.answerContainer} ${isSelected && styles.selected}`} verticalAlign="space-between" data-answer-index={index}>
             <Stack.Item>
                 <Stack horizontal horizontalAlign="space-between">
                     <AnswerIcon />
@@ -80,7 +332,7 @@ export const Answer = ({
                             title={t("tooltips.showThoughtProcess")}
                             ariaLabel={t("tooltips.showThoughtProcess")}
                             onClick={() => onThoughtProcessClicked()}
-                            disabled={!answer.context.thoughts?.length || isStreaming}
+                            disabled={!answer.context?.thoughts?.length || isStreaming}
                         />
                         <IconButton
                             style={{ color: "black" }}
@@ -88,31 +340,70 @@ export const Answer = ({
                             title={t("tooltips.showSupportingContent")}
                             ariaLabel={t("tooltips.showSupportingContent")}
                             onClick={() => onSupportingContentClicked()}
-                            disabled={!answer.context.data_points || isStreaming}
+                            disabled={!hasDataPoints || isStreaming}
                         />
-                        {showSpeechOutputAzure && (
-                            <SpeechOutputAzure answer={sanitizedAnswerHtml} index={index} speechConfig={speechConfig} isStreaming={isStreaming} />
-                        )}
-                        {showSpeechOutputBrowser && <SpeechOutputBrowser answer={sanitizedAnswerHtml} />}
                     </div>
                 </Stack>
             </Stack.Item>
 
             <Stack.Item grow>
                 <div className={styles.answerText}>
-                    <ReactMarkdown children={sanitizedAnswerHtml} rehypePlugins={[rehypeRaw]} remarkPlugins={[remarkGfm]} />
+                    <ReactMarkdown children={processedAnswerHtml} rehypePlugins={[rehypeRaw]} remarkPlugins={[remarkGfm]} />
                 </div>
             </Stack.Item>
 
-            {!!parsedAnswer.citations.length && (
+            {!!parsedAnswer.citations.length && showCitations && (
                 <Stack.Item>
                     <Stack horizontal wrap tokens={{ childrenGap: 5 }}>
                         <span className={styles.citationLearnMore}>{t("citationWithColon")}</span>
-                        {parsedAnswer.citations.map((x, i) => {
-                            const path = getCitationFilePath(x);
+                        {parsedAnswer.citations.map((citation, i) => {
+                            const matchingSupportingContent = findMatchingSupportingContent(citation);
+                            const citationContent = matchingSupportingContent?.content || "";
+                            const displayIndex = i + 1;
+
+                            // Build normalized label from the citation's own parts (preserve subsection like "D5.6")
+                            const parts = citation.split(",").map(p => p.trim());
+                            let subsection = parts.length >= 3 ? parts[0] : "";
+                            let sourcePage = parts.length >= 2 ? parts[parts.length - 2] : "";
+                            let sourceFile = parts.length >= 1 ? parts[parts.length - 1] : "";
+
+                            // If matching content exists, sync sourcepage/sourcefile from it (but keep subsection from citation)
+                            if (matchingSupportingContent) {
+                                sourcePage = matchingSupportingContent.sourcepage || sourcePage;
+                                sourceFile = matchingSupportingContent.sourcefile || sourceFile;
+                            }
+
+                            const normalizedLabelParts = [subsection, sourcePage, sourceFile].filter(Boolean);
+                            const normalizedLabel = normalizedLabelParts.join(", ");
+
+                            // Display concise text: subsection - sourcePage
+                            const displayText = subsection && sourcePage ? `${subsection} - ${sourcePage}` : normalizedLabel;
+
+                            console.log("Rendering citation link:", {
+                                citation,
+                                normalizedLabel,
+                                hasMatchingSupportingContent: !!matchingSupportingContent,
+                                citationContentLength: citationContent.length,
+                                displayText
+                            });
+
                             return (
-                                <a key={i} className={styles.citation} title={x} onClick={() => onCitationClicked(path)}>
-                                    {`${++i}. ${x}`}
+                                <a
+                                    key={i}
+                                    className={styles.citation}
+                                    title={normalizedLabel}
+                                    onClick={e => {
+                                        e.preventDefault();
+                                        console.log("Citation link clicked:", {
+                                            normalizedLabel,
+                                            matchingSupportingContent: !!matchingSupportingContent,
+                                            citationContentLength: citationContent.length
+                                        });
+                                        handleCitationLinkClick(normalizedLabel, citationContent);
+                                    }}
+                                    style={{ cursor: "pointer" }}
+                                >
+                                    {`${displayIndex}. ${displayText}`}
                                 </a>
                             );
                         })}
@@ -137,3 +428,36 @@ export const Answer = ({
         </Stack>
     );
 };
+
+// Helper function to extract subsection from content
+function extractSubsection(content: string): string {
+    if (!content) return "";
+
+    const lines = content.split("\n");
+    const firstLine = lines[0]?.trim();
+
+    // Check if first line looks like a heading or rule number
+    if (firstLine && firstLine.length < 100) {
+        const cleaned = firstLine.replace(/^#+\s*/, "").trim();
+
+        if (/^\d+\.\d+/.test(cleaned) || /^Rule \d+/.test(cleaned) || /^Part \d+/.test(cleaned)) {
+            return cleaned;
+        }
+
+        return cleaned;
+    }
+
+    // Look for rule patterns in the content
+    const ruleMatch = content.match(/(?:Rule\s+)?(\d+\.\d+(?:\(\d+\))?(?:\([a-z]\))?)/i);
+    if (ruleMatch) {
+        return ruleMatch[0];
+    }
+
+    // Look for part patterns
+    const partMatch = content.match(/(Part\s+\d+[^.]*)/i);
+    if (partMatch) {
+        return partMatch[1].substring(0, 50);
+    }
+
+    return content.substring(0, 50).trim() + (content.length > 50 ? "..." : "");
+}
diff --git a/app/frontend/src/components/Answer/AnswerParser.tsx b/app/frontend/src/components/Answer/AnswerParser.tsx
index 3807592..10af71b 100644
--- a/app/frontend/src/components/Answer/AnswerParser.tsx
+++ b/app/frontend/src/components/Answer/AnswerParser.tsx
@@ -1,41 +1,26 @@
-import { renderToStaticMarkup } from "react-dom/server";
-import { ChatAppResponse, getCitationFilePath } from "../../api";
+import { ChatAppResponse } from "../../api";
 
-type HtmlParsedAnswer = {
+export interface ParsedAnswer {
     answerHtml: string;
     citations: string[];
-};
+}
 
-// Function to validate citation format and check if dataPoint starts with possible citation
-function isCitationValid(contextDataPoints: any, citationCandidate: string): boolean {
-    const regex = /.+\.\w{1,}(?:#\S*)?$/;
-    if (!regex.test(citationCandidate)) {
-        return false;
-    }
+export function parseAnswerToHtml(answer: ChatAppResponse, isStreaming: boolean): ParsedAnswer {
+    const answerText = answer.message.content || "";
+    const context = answer.context as any; // Use 'any' to bypass strict type checking for custom context fields
+    const contextDataPoints = context?.data_points;
 
-    // Check if contextDataPoints is an object with a text property that is an array
-    let dataPointsArray: string[];
-    if (Array.isArray(contextDataPoints)) {
-        dataPointsArray = contextDataPoints;
-    } else if (contextDataPoints && Array.isArray(contextDataPoints.text)) {
-        dataPointsArray = contextDataPoints.text;
-    } else {
-        return false;
-    }
+    // Get enhanced citations and citation map from context
+    const enhancedCitations = context?.enhanced_citations || [];
+    const citationMap = context?.citation_map || {};
 
-    const isValidCitation = dataPointsArray.some(dataPoint => {
-        return dataPoint.startsWith(citationCandidate);
-    });
+    console.log("AnswerParser - Enhanced citations:", enhancedCitations);
+    console.log("AnswerParser - Citation map:", citationMap);
 
-    return isValidCitation;
-}
-
-export function parseAnswerToHtml(answer: ChatAppResponse, isStreaming: boolean, onCitationClicked: (citationFilePath: string) => void): HtmlParsedAnswer {
-    const contextDataPoints = answer.context.data_points;
     const citations: string[] = [];
 
-    // Trim any whitespace from the end of the answer after removing follow-up questions
-    let parsedAnswer = answer.message.content.trim();
+    // Preserve whitespace in the rendered answer; do not globally trim
+    let parsedAnswer = answerText;
 
     // Omit a citation that is still being typed during streaming
     if (isStreaming) {
@@ -48,41 +33,386 @@ export function parseAnswerToHtml(answer: ChatAppResponse, isStreaming: boolean,
                 break;
             }
         }
-        const truncatedAnswer = parsedAnswer.substring(0, lastIndex);
-        parsedAnswer = truncatedAnswer;
+        parsedAnswer = parsedAnswer.substring(0, lastIndex);
     }
 
-    const parts = parsedAnswer.split(/\[([^\]]+)\]/g);
+    // Check if we have enhanced citations but no numbered citations in content
+    const hasNumberedCitations = /\[\d+\]/.test(parsedAnswer);
+    console.log("Has numbered citations in content:", hasNumberedCitations);
 
-    const fragments: string[] = parts.map((part, index) => {
-        if (index % 2 === 0) {
-            return part;
-        } else {
-            let citationIndex: number;
+    if (!hasNumberedCitations && enhancedCitations.length > 0) {
+        // During streaming, suppress showing citations list based on enhanced_citations to avoid flicker
+        if (isStreaming) {
+            return {
+                answerHtml: parsedAnswer,
+                citations: []
+            };
+        }
 
-            if (!isCitationValid(contextDataPoints, part)) {
-                return `[${part}]`;
+        console.log("No numbered citations found in content, but enhanced citations available. Using enhanced citations directly.");
+        enhancedCitations.forEach((citation: string) => {
+            if (!citations.includes(citation)) {
+                citations.push(citation);
             }
+        });
+
+        return {
+            answerHtml: parsedAnswer,
+            citations
+        };
+    }
+
+    // Process numbered citations [1], [2], [3], etc.
+    const citationMatches = parsedAnswer.match(/\[(\d+)\]/g) || [];
+
+    citationMatches.forEach(match => {
+        const citationNumber = match.match(/\d+/)?.[0];
+        if (citationNumber) {
+            let enhancedCitation = citationMap[citationNumber] || enhancedCitations[parseInt(citationNumber) - 1];
 
-            if (citations.indexOf(part) !== -1) {
-                citationIndex = citations.indexOf(part) + 1;
-            } else {
-                citations.push(part);
-                citationIndex = citations.length;
+            // If no enhanced citation from backend, try to build from data_points
+            if (!enhancedCitation && contextDataPoints) {
+                const dataPoints = Array.isArray(contextDataPoints) ? contextDataPoints : contextDataPoints.text || [];
+                const dataPoint = dataPoints[parseInt(citationNumber, 10) - 1];
+
+                if (dataPoint && typeof dataPoint === "object") {
+                    const dpContent = dataPoint.content || "";
+                    const dpSubsection = dataPoint.subsection_id || extractSubsectionFromContent(dpContent);
+
+                    // STRICT: sourcepage/sourcefile must come from index
+                    const dpSourcepage = String(dataPoint.sourcepage || "").trim();
+                    const dpSourcefile = String(dataPoint.sourcefile || "").trim();
+
+                    if (dpSubsection && dpSourcepage && dpSourcefile) {
+                        enhancedCitation = `${dpSubsection}, ${dpSourcepage}, ${dpSourcefile}`;
+                    } else if (dpSourcepage && dpSourcefile) {
+                        enhancedCitation = `${dpSourcepage}, ${dpSourcefile}`;
+                    } else {
+                        enhancedCitation = `Source ${citationNumber}`;
+                    }
+                } else {
+                    enhancedCitation = `Source ${citationNumber}`;
+                }
+            }
+
+            if (!enhancedCitation) {
+                enhancedCitation = `Source ${citationNumber}`;
+            }
+
+            // NEW: Fix mixed or inconsistent citations using context.data_points
+            const fixedCitation = fixInconsistentCitation(enhancedCitation, contextDataPoints);
+
+            console.log(`Citation ${citationNumber} -> Enhanced: ${enhancedCitation} -> Fixed: ${fixedCitation}`);
+
+            // Add to citations array if not already present
+            if (!citations.includes(fixedCitation)) {
+                citations.push(fixedCitation);
             }
 
-            const path = getCitationFilePath(part);
+            // Get citation content for highlighting (preview-only)
+            const citationContent = getCitationContentFromContext(contextDataPoints, fixedCitation);
 
-            return renderToStaticMarkup(
-                <a className="supContainer" title={part} onClick={() => onCitationClicked(path)}>
-                    <sup>{citationIndex}</sup>
-                </a>
+            // Replace [n] with clickable superscript using the fixed label
+            const citationIndex = citations.indexOf(fixedCitation) + 1;
+            parsedAnswer = parsedAnswer.replace(
+                match,
+                `<sup class="citation-sup" data-citation-text="${encodeHtml(fixedCitation)}" data-citation-content="${encodeHtml(
+                    citationContent || ""
+                )}">${citationIndex}</sup>`
             );
         }
     });
 
+    console.log("AnswerParser - Final citations array:", citations);
+
     return {
-        answerHtml: fragments.join(""),
+        answerHtml: parsedAnswer,
         citations
     };
 }
+
+// Helper: classify subsection to validate compatibility
+function classifySubsection(sub?: string): { kind: "alpha" | "numeric" | "rule" | "para" | "unknown"; major?: string; prefix?: string } {
+    if (!sub) return { kind: "unknown" };
+    const s = sub.trim();
+    const mAlpha = s.match(/^([A-Z])(\d+)(?:\.(\d+))?/i); // D5.3, A1, B2.1
+    if (mAlpha) return { kind: "alpha", prefix: mAlpha[1].toUpperCase(), major: mAlpha[2] };
+    const mRule = s.match(/^Rule\s+(\d+)(?:\.(\d+))?/i);
+    if (mRule) return { kind: "rule", major: mRule[1] };
+    const mPara = s.match(/^Para(?:graph)?\s+(\d+)(?:\.(\d+))?/i);
+    if (mPara) return { kind: "para", major: mPara[1] };
+    const mNum = s.match(/^(\d+)(?:\.(\d+))?/);
+    if (mNum) return { kind: "numeric", major: mNum[1] };
+    return { kind: "unknown" };
+}
+
+// Helper: ensure array form for data_points
+function asDataPointsArray(contextDataPoints: any): any[] {
+    if (!contextDataPoints) return [];
+    if (Array.isArray(contextDataPoints)) return contextDataPoints;
+    if (contextDataPoints.text && Array.isArray(contextDataPoints.text)) return contextDataPoints.text;
+    return [];
+}
+
+// Helper: try to fix mixed/misaligned citation labels using index fields
+function fixInconsistentCitation(enhancedCitation: string, contextDataPoints: any): string {
+    const parts = (enhancedCitation || "").split(",").map(p => p.trim());
+    if (parts.length < 2) return enhancedCitation;
+
+    // Extract subsection, sourcePage, document (if present)
+    const subsection = parts.length >= 3 ? parts[0] : "";
+    const sourcePage = parts.length >= 2 ? parts[parts.length - 2] : "";
+    const document = parts.length >= 1 ? parts[parts.length - 1] : "";
+
+    // If we donâ€™t have a subsection, nothing to validate
+    if (!subsection) return enhancedCitation;
+
+    const cls = classifySubsection(subsection);
+    const dps = asDataPointsArray(contextDataPoints);
+
+    // Build quick checks
+    const isPartDoc = /^Part\s+\d+/i.test(document);
+    const isPDDoc = /^(PD|Practice\s*Direction)\s*\d+/i.test(document);
+
+    // Inconsistency 1: alpha subsection (e.g., D5.3) paired with "Part N"/"PD N" document
+    if (cls.kind === "alpha" && (isPartDoc || isPDDoc)) {
+        // Find a data point from a Guide (or any non-Part) that contains the subsection marker
+        const secTag = `${cls.prefix}.${cls.major}`; // e.g., D.5
+        const secAltTag = `${cls.prefix}${cls.major}`; // e.g., D5
+        const secRegex = new RegExp(`\\b${escapeHtmlRegex(secTag)}\\b`, "i");
+        const secAltRegex = new RegExp(`\\b${escapeHtmlRegex(secAltTag)}\\b`, "i");
+
+        const candidate = dps.find(dp => {
+            const dpSourcefile = String(dp.sourcefile || "");
+            const dpSourcepage = String(dp.sourcepage || "");
+            const content = String(dp.content || "");
+            // Avoid "Part"/"PD" documents; look for Guide or other non-Part docs
+            const isNonPart = !/^Part\s+\d+/i.test(dpSourcefile) && !/^(PD|Practice\s*Direction)\s*\d+/i.test(dpSourcefile);
+            const hasMarker = secRegex.test(dpSourcepage) || secAltRegex.test(dpSourcepage) || secRegex.test(content) || secAltRegex.test(content);
+            return isNonPart && hasMarker;
+        });
+
+        if (candidate) {
+            const sourcefile = String(candidate.sourcefile || "").trim();
+            const sourcepageFixed = String(candidate.sourcepage || "").trim();
+            // Keep the original subsection; rebind page/file from the correct dp
+            return [subsection, sourcepageFixed, sourcefile].filter(Boolean).join(", ");
+        }
+        // If no candidate found, keep original to avoid accidental corruption
+        return enhancedCitation;
+    }
+
+    // Inconsistency 2: numeric subsection (e.g., 59.4) but document not Part/PD matching the major number
+    if (cls.kind === "numeric" && !isPartDoc && !isPDDoc) {
+        const expectedPart = cls.major || "";
+        const candidate = dps.find(dp => {
+            const dpSourcefile = String(dp.sourcefile || "");
+            return (
+                new RegExp(`^Part\\s+${escapeHtmlRegex(expectedPart)}\\b`, "i").test(dpSourcefile) ||
+                new RegExp(`^(PD|Practice\\s*Direction)\\s*${escapeHtmlRegex(expectedPart)}\\b`, "i").test(dpSourcefile)
+            );
+        });
+        if (candidate) {
+            const sourcefile = String(candidate.sourcefile || "").trim();
+            const sourcepageFixed = String(candidate.sourcepage || "").trim();
+            return [subsection, sourcepageFixed, sourcefile].filter(Boolean).join(", ");
+        }
+        return enhancedCitation;
+    }
+
+    // Inconsistency 3: Rule/Para subsection must have marker in page/content
+    if (cls.kind === "rule" || cls.kind === "para") {
+        const marker = cls.kind === "rule" ? "Rule" : "Para";
+        const markerRegex = new RegExp(`\\b${escapeHtmlRegex(marker)}\\b`, "i");
+        // If marker not present in current sourcePage, try to rebind
+        if (!markerRegex.test(sourcePage)) {
+            const candidate = dps.find(dp => {
+                const dpSourcepage = String(dp.sourcepage || "");
+                const content = String(dp.content || "");
+                return markerRegex.test(dpSourcepage) || markerRegex.test(content);
+            });
+            if (candidate) {
+                const sourcefile = String(candidate.sourcefile || "").trim();
+                const sourcepageFixed = String(candidate.sourcepage || "").trim();
+                return [subsection, sourcepageFixed, sourcefile].filter(Boolean).join(", ");
+            }
+        }
+        return enhancedCitation;
+    }
+
+    return enhancedCitation;
+}
+
+// Reuse-safe escaping for building regex
+function escapeHtmlRegex(s: string): string {
+    return s.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
+}
+
+// Helper function to extract subsection from content
+function extractSubsectionFromContent(content: string): string {
+    if (!content) return "";
+
+    const lines = content.split("\n");
+    const firstLine = lines[0]?.trim();
+
+    // Check if first line looks like a heading or rule number
+    if (firstLine && firstLine.length < 100) {
+        const cleaned = firstLine.replace(/^#+\s*/, "").trim();
+
+        // Look for specific patterns first
+        if (/^PART\s+\d+/i.test(cleaned)) {
+            return cleaned;
+        }
+
+        if (/^\d+\.\d+/.test(cleaned) || /^Rule \d+/.test(cleaned)) {
+            return cleaned;
+        }
+
+        // Return first meaningful line if it's reasonably short
+        if (cleaned.length > 3 && cleaned.length < 80) {
+            return cleaned;
+        }
+    }
+
+    // Look for PART patterns anywhere in content
+    const partMatch = content.match(/PART\s+\d+[^.\n]*/i);
+    if (partMatch) {
+        return partMatch[0].trim();
+    }
+
+    // Look for rule patterns in the content
+    const ruleMatch = content.match(/(?:Rule\s+)?(\d+\.\d+(?:\(\d+\))?(?:\([a-z]\))?)/i);
+    if (ruleMatch) {
+        return ruleMatch[0];
+    }
+
+    // Fallback to content preview
+    return content.substring(0, 50).trim() + (content.length > 50 ? "..." : "");
+}
+
+// Helper function to get citation content from context (preview-only; does not mutate canonical content)
+function getCitationContentFromContext(contextDataPoints: any, citation: string): string | undefined {
+    if (!contextDataPoints) {
+        return undefined;
+    }
+
+    // Handle new DataPoints structure
+    let dataPointsArray: any[] = [];
+
+    if (Array.isArray(contextDataPoints)) {
+        dataPointsArray = contextDataPoints;
+    } else if (contextDataPoints.text && Array.isArray(contextDataPoints.text)) {
+        dataPointsArray = contextDataPoints.text;
+    } else {
+        return undefined;
+    }
+
+    console.log("Getting citation content for:", citation);
+    console.log("Available data points:", dataPointsArray.length);
+
+    // Handle simple "Source N" format
+    const simpleSourceMatch = citation.match(/^Source (\d+)$/);
+    if (simpleSourceMatch) {
+        const sourceIndex = parseInt(simpleSourceMatch[1], 10) - 1;
+        if (sourceIndex >= 0 && sourceIndex < dataPointsArray.length) {
+            const dataPoint = dataPointsArray[sourceIndex];
+            if (dataPoint && typeof dataPoint === "object" && dataPoint.content) {
+                return getCitationContentPreview(dataPoint.content, 150);
+            }
+        }
+    }
+
+    // Parse the citation format - handle both two-part and three-part citations
+    const citationParts = citation.split(",").map((p: string) => p.trim());
+
+    if (citationParts.length < 2) {
+        console.log("Citation has less than 2 parts, trying direct match");
+        // Try direct matching with sourcepage or sourcefile
+        for (let i = 0; i < dataPointsArray.length; i++) {
+            const dataPoint = dataPointsArray[i];
+            if (typeof dataPoint === "object" && dataPoint !== null) {
+                const dpSourcepage = dataPoint.sourcepage?.trim() || "";
+                const dpSourcefile = dataPoint.sourcefile?.trim() || "";
+
+                // Check if citation matches sourcepage or sourcefile directly
+                if (dpSourcepage === citation || dpSourcefile === citation) {
+                    console.log("Found direct match with sourcepage/sourcefile");
+                    return getCitationContentPreview(dataPoint.content || "", 150);
+                }
+            }
+        }
+        return undefined;
+    }
+
+    // For multi-part citations, extract the last two parts as source page and document
+    const sourcePage = citationParts[citationParts.length - 2];
+    const document = citationParts[citationParts.length - 1];
+
+    console.log("Looking for sourcePage:", sourcePage, "document:", document);
+
+    // Match based on sourcepage and sourcefile from search results
+    for (let i = 0; i < dataPointsArray.length; i++) {
+        const dataPoint = dataPointsArray[i];
+
+        if (typeof dataPoint === "object" && dataPoint !== null) {
+            const dpSourcepage = dataPoint.sourcepage?.trim() || "";
+            const dpSourcefile = dataPoint.sourcefile?.trim() || "";
+
+            console.log(`Checking data point ${i}: sourcepage='${dpSourcepage}', sourcefile='${dpSourcefile}'`);
+
+            // Check if this data point matches the citation
+            if (dpSourcepage === sourcePage && dpSourcefile === document) {
+                console.log("Found matching data point");
+                return getCitationContentPreview(dataPoint.content || "", 150);
+            }
+
+            // Also try partial matching for cases where citation uses simplified names
+            if (dpSourcepage.includes(sourcePage) || sourcePage.includes(dpSourcepage)) {
+                if (dpSourcefile === document || dpSourcefile.includes(document) || document.includes(dpSourcefile)) {
+                    console.log("Found partial matching data point");
+                    return getCitationContentPreview(dataPoint.content || "", 150);
+                }
+            }
+        }
+    }
+
+    console.log("No matching data point found for citation");
+    return undefined;
+}
+
+// Helper function to create preview content (preview-only normalization)
+function getCitationContentPreview(content: string, maxLength: number = 150): string {
+    if (!content) {
+        return "";
+    }
+
+    // Clean the content - remove extra whitespace and normalize (for preview only)
+    const cleaned = content.replace(/\s+/g, " ").trim();
+
+    // If content is short enough, return it as-is
+    if (cleaned.length <= maxLength) {
+        return cleaned;
+    }
+
+    // Find a good breaking point (end of sentence)
+    const truncated = cleaned.substring(0, maxLength);
+    const lastPeriod = truncated.lastIndexOf(". ");
+
+    if (lastPeriod > maxLength * 0.6) {
+        // Only if we're not cutting too much
+        return truncated.substring(0, lastPeriod + 1);
+    }
+
+    // Try to break at word boundary
+    const lastSpace = truncated.lastIndexOf(" ");
+    if (lastSpace > 0) {
+        return truncated.substring(0, lastSpace) + "...";
+    }
+
+    return truncated + "...";
+}
+
+// Helper function to encode HTML entities
+function encodeHtml(str: string): string {
+    return str.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#39;");
+}
diff --git a/app/frontend/src/components/Answer/SupportingContent/SupportingContent.tsx b/app/frontend/src/components/Answer/SupportingContent/SupportingContent.tsx
new file mode 100644
index 0000000..275dcfc
--- /dev/null
+++ b/app/frontend/src/components/Answer/SupportingContent/SupportingContent.tsx
@@ -0,0 +1,167 @@
+import React, { useEffect } from "react";
+
+interface SupportingContentItem {
+    title: string;
+    content: string;
+    page?: number;
+}
+
+interface Props {
+    supportingContent: SupportingContentItem[];
+    onInfo: (info: string) => void;
+    onSupportingContentChange: (content: SupportingContentItem[]) => void;
+}
+
+// Add this helper function after the imports
+const parseCitationReference = (reference: string): { section?: string; part?: string; title?: string; page?: number } => {
+    const result: { section?: string; part?: string; title?: string; page?: number } = {};
+
+    // Extract page number if present (e.g., "(p. 123)")
+    const pageMatch = reference.match(/\(p\.\s*(\d+)\)/i);
+    if (pageMatch) {
+        result.page = parseInt(pageMatch[1]);
+    }
+
+    // Extract section number (e.g., "1.1(1)" or "31.1")
+    const sectionMatch = reference.match(/^(\d+(?:\.\d+)?(?:\(\d+\))?)/);
+    if (sectionMatch) {
+        result.section = sectionMatch[1];
+    }
+
+    // Extract PART information
+    const partMatch = reference.match(/PART\s+(\d+)/i);
+    if (partMatch) {
+        result.part = partMatch[1];
+    }
+
+    // Extract title
+    const titleMatch = reference.match(/,\s*([^(]+)(?:\s*\(|$)/);
+    if (titleMatch) {
+        result.title = titleMatch[1].trim();
+    }
+
+    return result;
+};
+
+const SupportingContent: React.FC<Props> = ({ supportingContent, onInfo, onSupportingContentChange }) => {
+    const activeCitationReference = "1.1(1), PART 1 - OVERRIDING OBJECTIVE (p. 1)";
+    const activeCitationContent = "PRACTICE DIRECTION 31 A - DISCLOSURE AND INSPECTION";
+
+    useEffect(() => {
+        if (!activeCitationReference || !activeCitationContent || supportingContent.length === 0) {
+            return;
+        }
+
+        console.log("Auto-scroll effect triggered:", {
+            activeCitationReference,
+            activeCitationContent: activeCitationContent.substring(0, 200) + "..."
+        });
+
+        const scrollTimeout = setTimeout(() => {
+            // Parse the citation reference
+            const citationParts = parseCitationReference(activeCitationReference);
+            console.log("Parsed citation reference:", citationParts);
+
+            // Log all supporting content items for debugging
+            console.log("Supporting content items:");
+            supportingContent.forEach((item, index) => {
+                console.log(`[${index}] ${item.title.substring(0, 50)}...`);
+            });
+
+            // Find the best matching supporting content
+            let bestMatchIndex = -1;
+            let bestMatchScore = 0;
+
+            supportingContent.forEach((item, index) => {
+                let score = 0;
+                const contentLower = item.content.toLowerCase();
+                const titleLower = item.title.toLowerCase();
+
+                // Prepare sectionRegex if needed for use in both scoring and logging
+                let sectionRegex: RegExp | undefined = undefined;
+                if (citationParts.section) {
+                    sectionRegex = new RegExp(
+                        `(?:^|\\s|rule\\s*|section\\s*)${citationParts.section.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}(?:\\s|\\.|,|$)`,
+                        "i"
+                    );
+                    if (sectionRegex.test(item.content) || sectionRegex.test(item.title)) {
+                        // Make sure it's not a PRACTICE DIRECTION match when looking for section 1.1
+                        if (!citationParts.section.startsWith("1.") || !titleLower.includes("practice direction")) {
+                            score += 3;
+                        }
+                    }
+                }
+
+                // Check for part match - this should be weighted heavily
+                if (citationParts.part) {
+                    const partRegex = new RegExp(`\\bPART\\s+${citationParts.part}\\b(?!\\s*\\d)`, "i");
+                    if (partRegex.test(item.title)) {
+                        score += 10; // High weight for title match
+                    } else if (partRegex.test(item.content)) {
+                        score += 5;
+                    }
+                }
+
+                // Check for title match - exact matches should score higher
+                if (citationParts.title) {
+                    const citationTitleLower = citationParts.title.toLowerCase();
+                    if (titleLower.includes(citationTitleLower) || citationTitleLower.includes(titleLower)) {
+                        score += 8; // High score for title match
+                    } else {
+                        // Partial word matching
+                        const titleWords = citationParts.title.toLowerCase().split(/\s+/);
+                        const matchingWords = titleWords.filter(word => word.length > 3 && (contentLower.includes(word) || titleLower.includes(word)));
+                        score += matchingWords.length;
+                    }
+                }
+
+                // Check for page number proximity
+                if (citationParts.page && item.page) {
+                    const pageDiff = Math.abs(item.page - citationParts.page);
+                    if (pageDiff === 0) {
+                        score += 5;
+                    } else if (pageDiff <= 2) {
+                        score += 3;
+                    } else if (pageDiff <= 5) {
+                        score += 1;
+                    }
+                }
+
+                // Penalty for mismatched content type
+                if (citationParts.part === "1" && titleLower.includes("practice direction")) {
+                    score -= 5; // Penalty for practice direction when looking for Part 1
+                }
+                console.log(`Item ${index} "${item.title.substring(0, 50)}..." score:`, score, {
+                    hasSection: citationParts.section && sectionRegex ? sectionRegex.test(item.content) || sectionRegex.test(item.title) : false,
+                    hasPart: citationParts.part ? titleLower.includes(`part ${citationParts.part}`) : false,
+                    hasTitle: citationParts.title ? titleLower.includes(citationParts.title.toLowerCase()) : false
+                });
+
+                if (score > bestMatchScore) {
+                    bestMatchScore = score;
+                    bestMatchIndex = index;
+                }
+            });
+
+            if (bestMatchIndex >= 0 && bestMatchScore > 0) {
+                console.log(
+                    `Best match found at index ${bestMatchIndex} with score ${bestMatchScore}:`,
+                    supportingContent[bestMatchIndex].title.substring(0, 50)
+                );
+                const element = document.querySelector(`[data-content-index="${bestMatchIndex}"]`);
+                if (element) {
+                    console.log("Scrolling to element:", element);
+                    element.scrollIntoView({ behavior: "smooth", block: "center" });
+                }
+            } else {
+                console.log("No suitable match found for citation");
+            }
+        }, 100);
+
+        return () => clearTimeout(scrollTimeout);
+    }, [activeCitationReference, activeCitationContent, supportingContent]);
+
+    return <div>{/* Render supporting content here */}</div>;
+};
+
+export default SupportingContent;
diff --git a/app/frontend/src/components/SupportingContent/SupportingContent.module.css b/app/frontend/src/components/SupportingContent/SupportingContent.module.css
index 54bf03f..9839ac2 100644
--- a/app/frontend/src/components/SupportingContent/SupportingContent.module.css
+++ b/app/frontend/src/components/SupportingContent/SupportingContent.module.css
@@ -1,33 +1,277 @@
-.supportingContentNavList {
-    list-style: none;
-    padding-left: 0.3125em;
+.supportingContent {
+    padding: 16px;
+    overflow-y: auto;
+    max-height: 100%;
+}
+
+.supportingItem {
+    margin-bottom: 24px;
+    border: 1px solid #e1e5eb;
+    border-radius: 8px;
+    padding: 16px;
+    background: white;
+    transition: all 0.3s ease;
+    scroll-margin-top: 20px;
+}
+
+.supportingItem:last-child {
+    margin-bottom: 0;
+}
+
+/* Highlight styles for matched content */
+.supportingItem.highlighted {
+    background: #eff6ff;
+    border: 2px solid #3b82f6;
+    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
+}
+
+.itemHeader {
+    margin-bottom: 12px;
+}
+
+.itemTitle {
+    margin: 0 0 8px 0;
+    font-size: 16px;
+    font-weight: 600;
+    color: #323130;
+    line-height: 1.3;
+}
+
+.itemMeta {
     display: flex;
-    flex-direction: column;
-    gap: 0.625em;
-}
-
-.supportingContentItem {
-    word-break: break-word;
-    background: rgb(249, 249, 249);
-    border-radius: 0.5em;
-    box-shadow:
-        rgb(0 0 0 / 5%) 0px 0px 0px 0.0625em,
-        rgb(0 0 0 / 10%) 0px 0.125em 0.1875em 0px;
-    outline: transparent solid 0.0625em;
+    gap: 16px;
+    font-size: 12px;
+    color: #605e5c;
+    flex-wrap: wrap;
+}
+
+.itemDate {
+    background: #f3f2f1;
+    padding: 4px 8px;
+    border-radius: 4px;
+    white-space: nowrap;
     display: flex;
-    flex-direction: column;
-    padding: 1.25em;
+    align-items: center;
 }
 
-.supportingContentItemHeader {
+.itemDate strong {
+    margin-right: 4px;
+    color: #323130;
+    font-weight: 600;
+}
+
+.itemContent {
+    margin-bottom: 12px;
+    line-height: 1.4;
+}
+
+.itemContent pre {
+    white-space: pre-wrap;
+    word-wrap: break-word;
+    font-family: inherit;
     margin: 0;
+    line-height: 1.4;
+    font-size: 14px;
 }
 
-.supportingContentItemText {
+.textSection {
+    margin-bottom: 16px;
+}
+
+.sectionHeader {
+    font-weight: 600;
+    margin-bottom: 8px;
+    color: #323130;
+}
+
+.sectionContent {
+    color: #323130;
+}
+
+.sectionContent p {
+    margin: 0 0 8px 0;
+}
+
+.noteSection,
+.exampleSection {
+    background: #f8f9fa;
+    border-left: 4px solid #0078d4;
+    padding: 12px;
+    margin: 8px 0;
+}
+
+.noteTitle,
+.exampleTitle {
+    font-weight: 600;
+    margin-bottom: 8px;
+    color: #0078d4;
+}
+
+.noteContent,
+.exampleContent {
+    color: #323130;
+}
+
+.exampleContent p {
+    margin: 0 0 0.75rem 0;
+}
+
+.exampleContent p:last-child {
     margin-bottom: 0;
-    font-weight: 300;
 }
 
-.supportingContentItemImage {
-    object-fit: contain;
+.itemFooter {
+    border-top: 1px solid #e1e5eb;
+    padding-top: 12px;
+    display: flex;
+    gap: 12px;
+    align-items: center;
+    flex-wrap: wrap;
+}
+
+.itemLink {
+    color: #0078d4;
+    text-decoration: none;
+    font-size: 14px;
+    padding: 4px 8px;
+    border-radius: 4px;
+    transition: background-color 0.2s;
+}
+
+.itemLink:hover {
+    text-decoration: underline;
+    background-color: #f3f2f1;
+}
+
+.viewSourceButton {
+    background: #0078d4;
+    color: white;
+    border: none;
+    padding: 8px 12px;
+    border-radius: 4px;
+    cursor: pointer;
+    font-size: 13px;
+    font-weight: 500;
+    transition: background-color 0.2s;
+    white-space: nowrap;
+}
+
+.viewSourceButton:hover {
+    background: #106ebe;
+}
+
+.viewSourceButton:focus {
+    outline: 2px solid #0078d4;
+    outline-offset: 2px;
+}
+
+/* New styles for subsection highlighting */
+.subsectionHighlighted {
+    background-color: #f0f9ff;
+    border-radius: 6px;
+    padding: 12px;
+    border: 1px solid #e0f2fe;
+}
+
+.subsectionLabel {
+    background-color: #dbeafe;
+    border: 1px solid #3b82f6;
+    border-radius: 6px;
+    padding: 8px 16px;
+    margin-bottom: 12px;
+    font-size: 0.9em;
+    color: #1e40af;
+    font-weight: 500;
+}
+
+.subsectionIndicator {
+    display: flex;
+    align-items: center;
+    margin-left: 8px;
+}
+
+.subsectionBadge {
+    background-color: #1d4ed8;
+    color: white;
+    padding: 4px 12px;
+    border-radius: 16px;
+    font-size: 0.8em;
+    font-weight: 600;
+}
+
+.subsectionNote {
+    margin-top: 12px;
+    padding: 8px 16px;
+    background-color: #f8fafc;
+    border-radius: 6px;
+    font-size: 0.85em;
+    color: #475569;
+    border-left: 4px solid #60a5fa;
+}
+
+.highlighted {
+    border: 2px solid #3b82f6;
+    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
+}
+
+.highlightedSubsection {
+    background-color: #fff3cd;
+    padding: 8px;
+    border-left: 4px solid #ffc107;
+    margin: 8px 0;
+}
+
+.clickableHeader {
+    cursor: pointer;
+    transition: color 0.2s;
+}
+
+.clickableHeader:hover {
+    color: #0066cc;
+}
+
+.supportingContentText {
+    margin: 16px 0;
+    line-height: 1.6;
+}
+
+.supportingContentText p {
+    margin: 8px 0;
+}
+
+/* Responsive design */
+@media (max-width: 768px) {
+    .supportingItem {
+        padding: 12px;
+    }
+
+    .itemTitle {
+        font-size: 1.1rem;
+    }
+
+    .itemMeta {
+        gap: 8px;
+    }
+
+    .itemFooter {
+        flex-direction: column;
+        align-items: stretch;
+        gap: 8px;
+    }
+
+    .viewSourceButton {
+        text-align: center;
+    }
+}
+
+/* Print styles */
+@media print {
+    .textSection {
+        break-inside: avoid;
+        page-break-inside: avoid;
+    }
+
+    .itemFooter {
+        display: none;
+    }
 }
diff --git a/app/frontend/src/components/SupportingContent/SupportingContent.tsx b/app/frontend/src/components/SupportingContent/SupportingContent.tsx
index 94df0ec..8ff873c 100644
--- a/app/frontend/src/components/SupportingContent/SupportingContent.tsx
+++ b/app/frontend/src/components/SupportingContent/SupportingContent.tsx
@@ -1,32 +1,383 @@
-import { parseSupportingContentItem } from "./SupportingContentParser";
-
+import React, { useEffect, useRef, useState, useMemo } from "react";
+import { useTranslation } from "react-i18next";
+import { parseSupportingContentItem, extractSubsectionContent, parseSubsectionFromCitation } from "./SupportingContentParser";
 import styles from "./SupportingContent.module.css";
 
-interface Props {
-    supportingContent: string[] | { text: string[]; images?: string[] };
+interface SupportingContentProps {
+    supportingContent: any[];
+    activeCitationReference?: string;
+    activeCitationContent?: string;
+    onViewSourceDocument?: (citation: string) => void;
 }
 
-export const SupportingContent = ({ supportingContent }: Props) => {
-    const textItems = Array.isArray(supportingContent) ? supportingContent : supportingContent.text;
-    const imageItems = !Array.isArray(supportingContent) ? supportingContent?.images : [];
-    return (
-        <ul className={styles.supportingContentNavList}>
-            {textItems.map((c, ind) => {
-                const parsed = parseSupportingContentItem(c);
+export const SupportingContent = ({ supportingContent, activeCitationReference, activeCitationContent, onViewSourceDocument }: SupportingContentProps) => {
+    const { t } = useTranslation();
+    const containerRef = useRef<HTMLDivElement>(null);
+    const [activeCitation, setActiveCitation] = useState<string>();
+    const [expandedItems, setExpandedItems] = useState<Set<string>>(new Set());
+
+    // Helper: normalize URLs for stable dedup keys
+    const normalizeUrl = (u?: string) => {
+        if (!u) return "";
+        try {
+            const url = new URL(u);
+            // strip query/hash, keep origin+pathname, trim trailing slash
+            let normalized = `${url.origin}${url.pathname}`.replace(/\/+$/, "");
+            return normalized.toLowerCase();
+        } catch {
+            return (u || "")
+                .toLowerCase()
+                .replace(/[?#].*$/, "")
+                .replace(/\/+$/, "");
+        }
+    };
+
+    // Build a stable, deduplicated list by document and MERGE all subsection chunks into a single full_content
+    const displayedItems = useMemo(() => {
+        type Segment = { idx?: number | null; text: string };
+        type DocRecord = {
+            bestItem: any;
+            hasAnyFull: boolean;
+            bestFullText: string;
+            segments: Segment[];
+            seenTexts: Set<string>;
+        };
+        const byDoc = new Map<string, DocRecord>();
+
+        for (const it of supportingContent || []) {
+            const parsed = parseSupportingContentItem(it);
+            const docUrl = normalizeUrl(it.storageurl || it.url || parsed.storageurl || parsed.url || "");
+            const docKey = it.original_doc_id || docUrl || (parsed.sourcefile || "").toLowerCase();
+
+            let rec = byDoc.get(docKey);
+            if (!rec) {
+                rec = {
+                    bestItem: it,
+                    hasAnyFull: Boolean(it.full_content && it.full_content.length > 0),
+                    bestFullText: (it.full_content || "") as string,
+                    segments: [],
+                    seenTexts: new Set<string>()
+                };
+                byDoc.set(docKey, rec);
+            } else {
+                // Prefer the item that has storageurl/sourcefile/sourcepage populated; otherwise keep first
+                const existingParsed = parseSupportingContentItem(rec.bestItem);
+                const currentScore = (existingParsed.storageurl ? 1 : 0) + (existingParsed.sourcefile ? 1 : 0) + (existingParsed.sourcepage ? 1 : 0);
+                const candidateScore = (parsed.storageurl ? 1 : 0) + (parsed.sourcefile ? 1 : 0) + (parsed.sourcepage ? 1 : 0);
+                if (candidateScore > currentScore) {
+                    rec.bestItem = it;
+                }
+            }
+
+            // Track full_content if any item provides it; prefer the longest
+            if (it.full_content && it.full_content.length > 0) {
+                rec.hasAnyFull = true;
+                if (it.full_content.length > (rec.bestFullText?.length || 0)) {
+                    rec.bestFullText = it.full_content;
+                }
+            }
+
+            // Accumulate subsection content segments to reconstruct full content if backend didn't send it
+            const candidateText = (it.content || parsed.content || "").trim();
+            if (candidateText && !rec.seenTexts.has(candidateText)) {
+                rec.seenTexts.add(candidateText);
+                const idx: number | null = typeof it.subsection_index === "number" ? it.subsection_index : typeof it.index === "number" ? it.index : null;
+                rec.segments.push({ idx, text: candidateText });
+            }
+        }
+
+        // Finalize merged entries with injected full_content
+        return Array.from(byDoc.values()).map(rec => {
+            const merged = { ...rec.bestItem };
+            if (rec.hasAnyFull && rec.bestFullText && rec.bestFullText.length > 0) {
+                merged.full_content = rec.bestFullText;
+            } else {
+                // Sort by subsection_index when available, otherwise preserve insertion order
+                const sorted = [...rec.segments].sort((a, b) => {
+                    if (a.idx == null && b.idx == null) return 0;
+                    if (a.idx == null) return 1;
+                    if (b.idx == null) return -1;
+                    return a.idx - b.idx;
+                });
+                // Join unique segments with double newline to preserve paragraph breaks
+                merged.full_content = sorted.map(s => s.text).join("\n\n");
+            }
+            return merged;
+        });
+    }, [supportingContent]);
+
+    const formatDate = (dateString: string) => {
+        if (!dateString || dateString === "") return "";
+        try {
+            const date = new Date(dateString);
+            if (!isNaN(date.getTime())) {
+                return date.toLocaleDateString();
+            }
+        } catch (e) {
+            console.error("Error parsing date:", e);
+        }
+        return dateString;
+    }; // Fixed missing closing brace
+
+    // Add a tiny helper to remove only the optional leading "[n]: " prefix without touching other whitespace
+    const stripLeadingIndexPrefix = (s: string) => s.replace(/^\[\d+\]:\s?/, "");
+
+    // Enhanced content rendering with subsection highlighting
+    const renderContent = (content: string, isHighlighted: boolean = false, targetSubsection?: string) => {
+        if (!content) return null;
+
+        // NO CLEANING - Use the original content structure as created in the search index
+        const originalContent = stripLeadingIndexPrefix(content); // Only drop a leading "[n]: " if present
+
+        // If we have a target subsection and this item is highlighted, highlight that section within the full content
+        if (isHighlighted && targetSubsection) {
+            console.log(`Attempting to highlight subsection: ${targetSubsection} in content length: ${originalContent.length}`);
+
+            // Use the robust extractor to find the subsection block
+            const section = extractSubsectionContent(originalContent, targetSubsection);
+
+            if (section && section.content) {
+                const beforeSubsection = originalContent.substring(0, section.startIndex);
+                const subsectionContent = section.content;
+                const afterSubsection = originalContent.substring(section.endIndex);
+
+                // Reduce vertical padding to avoid overlapping the previous line
+                const highlightedSubsection =
+                    `<mark style="background-color:#3b82f6;color:#fff;padding:0 4px;border-radius:4px;display:inline;line-height:inherit;">` +
+                    subsectionContent +
+                    `</mark>`;
+                const highlightedContent = beforeSubsection + highlightedSubsection + afterSubsection;
+
                 return (
-                    <li className={styles.supportingContentItem} key={`supporting-content-text-${ind}`}>
-                        <h4 className={styles.supportingContentItemHeader}>{parsed.title}</h4>
-                        <p className={styles.supportingContentItemText} dangerouslySetInnerHTML={{ __html: parsed.content }} />
-                    </li>
+                    <div className={styles.itemContent}>
+                        <div
+                            style={{ whiteSpace: "pre-wrap", fontFamily: "inherit", margin: 0, lineHeight: "1.4" }}
+                            dangerouslySetInnerHTML={{ __html: highlightedContent }}
+                        />
+                    </div>
                 );
-            })}
-            {imageItems?.map((img, ind) => {
+            } else {
+                console.warn(`Could not find subsection ${targetSubsection} in content`);
+                console.log(`Content starts with: ${originalContent.substring(0, 200)}...`);
+            }
+        }
+
+        // Show original content without any cleaning to preserve index structure
+        return (
+            <div className={styles.itemContent}>
+                <pre style={{ whiteSpace: "pre-wrap", fontFamily: "inherit", margin: 0, lineHeight: "1.4" }}>{originalContent}</pre>
+            </div>
+        );
+    };
+
+    // Enhanced function to find matching content with subsection awareness over displayedItems
+    const findMatchingContentIndex = (citation: string): number => {
+        if (!citation) return -1;
+
+        console.log("Finding match for citation:", citation);
+
+        let bestMatchIndex = -1;
+        let bestMatchScore = 0;
+
+        for (let i = 0; i < displayedItems.length; i++) {
+            const parsedItem = parseSupportingContentItem(displayedItems[i]);
+            let score = 0;
+
+            console.log(`Checking displayed item ${i}:`, {
+                sourcepage: parsedItem.sourcepage,
+                sourcefile: parsedItem.sourcefile,
+                category: parsedItem.category
+            });
+
+            const citationParts = citation.split(",").map(p => p.trim());
+
+            if (citationParts.length >= 3) {
+                const subsection = citationParts[0];
+                const sourcePage = citationParts[1];
+                const document = citationParts[2];
+
+                console.log(`Citation parts:`, { subsection, sourcePage, document });
+
+                // Document must match
+                if (!(parsedItem.sourcefile === document || parsedItem.sourcefile?.includes(document))) {
+                    console.log(`Document mismatch for item ${i}: expected '${document}', got '${parsedItem.sourcefile}'`);
+                    continue;
+                }
+                score += 10;
+
+                // Sourcepage: prefer exact, otherwise light partial
+                if (parsedItem.sourcepage && sourcePage) {
+                    if (parsedItem.sourcepage === sourcePage) {
+                        score += 50;
+                    } else {
+                        const sourcePageLower = sourcePage.toLowerCase();
+                        const parsedSourcepageLower = parsedItem.sourcepage.toLowerCase();
+                        if (sourcePageLower.length > 3 && parsedSourcepageLower.includes(sourcePageLower)) {
+                            score += 10;
+                        } else if (parsedSourcepageLower.length > 3 && sourcePageLower.includes(parsedSourcepageLower)) {
+                            score += 10;
+                        }
+                    }
+                } else {
+                    // If we can't compare sourcepage, skip early for strictness
+                    console.log(`Missing sourcepage for strict match on item ${i}`);
+                    continue;
+                }
+
+                // STRICT: if we have a subsection, it MUST appear in the content to be a valid match
+                if (subsection && subsection.length > 1) {
+                    const content = parsedItem.content || "";
+                    if (!content) {
+                        console.log(`Item ${i} has no content to check subsection presence`);
+                        continue;
+                    }
+                    const escaped = subsection.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
+                    const patterns = [new RegExp(`(^|\\n)\\s*${escaped}\\b`, "i"), new RegExp(`\\b${escaped}\\b`, "i")];
+                    const found = patterns.some(p => p.test(content));
+                    if (!found) {
+                        console.log(`Subsection '${subsection}' not found in item ${i} content, skipping`);
+                        continue; // do not consider this item at all
+                    }
+                    // If present, add a high score
+                    score += 40;
+                }
+            } else {
+                // Legacy two-part citation
+                if (parsedItem.sourcepage && citation.includes(parsedItem.sourcepage)) {
+                    score += 15;
+                } else if (parsedItem.sourcefile && citation.includes(parsedItem.sourcefile)) {
+                    score += 10;
+                } else {
+                    continue;
+                }
+            }
+
+            if (score > bestMatchScore && score >= 15) {
+                bestMatchScore = score;
+                bestMatchIndex = i;
+            }
+        }
+
+        if (bestMatchIndex >= 0 && bestMatchScore >= 15) {
+            console.log(`Best match (displayedItems) found at index ${bestMatchIndex} with score ${bestMatchScore}`);
+            return bestMatchIndex;
+        }
+
+        console.log("No valid match found for citation (strict subsection check)");
+        return -1;
+    };
+
+    // Auto-scroll uses displayedItems
+    useEffect(() => {
+        if ((activeCitationReference || activeCitationContent) && containerRef.current) {
+            const matchIndex = findMatchingContentIndex(activeCitationReference || "");
+
+            console.log("Auto-scroll effect (displayedItems):", {
+                activeCitationReference,
+                activeCitationContent,
+                matchIndex,
+                displayedItemsLength: displayedItems.length
+            });
+
+            if (matchIndex >= 0) {
+                const targetElement = containerRef.current.children[matchIndex] as HTMLElement;
+                if (targetElement) {
+                    targetElement.scrollIntoView({ behavior: "smooth", block: "start" });
+                    targetElement.style.backgroundColor = "#dbeafe";
+                    setTimeout(() => {
+                        targetElement.style.backgroundColor = "";
+                    }, 5000);
+                }
+            }
+        }
+    }, [activeCitationReference, activeCitationContent, displayedItems]);
+
+    // Handle view source document
+    const handleViewSourceDocument = (parsedItem: any) => {
+        const documentUrl = parsedItem.storageurl || parsedItem.url;
+        if (documentUrl && onViewSourceDocument) {
+            onViewSourceDocument(documentUrl);
+        }
+    };
+
+    // Handle view source document in new tab
+    const handleViewSourceDocumentNewTab = (parsedItem: any) => {
+        const documentUrl = parsedItem.storageurl || parsedItem.url;
+        if (documentUrl) {
+            window.open(documentUrl, "_blank", "noopener,noreferrer");
+        }
+    };
+
+    if (!displayedItems || displayedItems.length === 0) {
+        return (
+            <div className={styles.supportingContent}>
+                <p>No supporting content available</p>
+            </div>
+        );
+    }
+
+    const targetSubsection = activeCitationReference ? parseSubsectionFromCitation(activeCitationReference) : null;
+
+    return (
+        <div className={styles.supportingContent} ref={containerRef}>
+            {displayedItems.map((item, index) => {
+                const parsedItem = parseSupportingContentItem(item);
+                const isActive = !!(activeCitationReference && findMatchingContentIndex(activeCitationReference) === index);
+
+                const getDisplayTitle = () => {
+                    const parts: string[] = [];
+                    if (parsedItem.sourcefile) parts.push(parsedItem.sourcefile);
+                    if (parsedItem.sourcepage) parts.push(parsedItem.sourcepage);
+                    if (parsedItem.category) parts.push(parsedItem.category);
+                    return parts.length > 0 ? parts.join(", ") : "Document Source";
+                };
+
+                const documentUrl = parsedItem.storageurl || parsedItem.url;
+                const hasDocumentUrl = Boolean(documentUrl);
+
+                // Create a stable key per document (match dedup logic)
+                const docUrl = normalizeUrl(item.storageurl || item.url || parsedItem.storageurl || parsedItem.url || "");
+                const docKey = (item.original_doc_id || docUrl || parsedItem.sourcefile || "") + `_${index}`;
+
                 return (
-                    <li className={styles.supportingContentItem} key={`supporting-content-image-${ind}`}>
-                        <img className={styles.supportingContentItemImage} src={img} />
-                    </li>
+                    <div key={docKey} className={`${styles.supportingItem} ${isActive ? styles.highlighted : ""}`}>
+                        <div className={styles.itemHeader}>
+                            <div className={styles.itemTitle}>{getDisplayTitle()}</div>
+                            {parsedItem.updated && (
+                                <div className={styles.itemMeta}>
+                                    <span className={styles.itemDate}>
+                                        <strong>Updated:</strong> {formatDate(parsedItem.updated)}
+                                    </span>
+                                </div>
+                            )}
+                        </div>
+
+                        {/* Always render full content; highlight specific subsection if active */}
+                        {renderContent(parsedItem.content, isActive, targetSubsection ?? undefined)}
+
+                        <div className={styles.supportingContentActions} style={{ display: "flex", gap: "8px", flexWrap: "wrap" }}>
+                            {hasDocumentUrl && (
+                                <>
+                                    <button
+                                        className={styles.viewSourceButton}
+                                        onClick={() => handleViewSourceDocument(parsedItem)}
+                                        title="View Source Document"
+                                    >
+                                        View Source
+                                    </button>
+                                    <button
+                                        className={styles.viewSourceButton}
+                                        onClick={() => handleViewSourceDocumentNewTab(parsedItem)}
+                                        title="View Source Document in New Tab"
+                                    >
+                                        View Source in New Tab
+                                    </button>
+                                </>
+                            )}
+                        </div>
+                    </div>
                 );
             })}
-        </ul>
+        </div>
     );
 };
diff --git a/app/frontend/src/components/SupportingContent/SupportingContentParser.ts b/app/frontend/src/components/SupportingContent/SupportingContentParser.ts
index 2a0cd6c..cec742e 100644
--- a/app/frontend/src/components/SupportingContent/SupportingContentParser.ts
+++ b/app/frontend/src/components/SupportingContent/SupportingContentParser.ts
@@ -1,19 +1,308 @@
 import DOMPurify from "dompurify";
+// import the correct member from "../../api"
+import type * as ApiTypes from "../../api";
 
-type ParsedSupportingContentItem = {
+// Define SupportingContent type based on usage in the code
+type SupportingContent = {
+    id?: string;
+    original_doc_id?: string;
+    sourcefile?: string;
+    sourcepage?: string;
+    category?: string;
+    updated?: string;
+    last_updated?: string;
+    date_updated?: string;
+    storageurl?: string;
+    storageUrl?: string;
+    storage_url?: string;
+    url?: string;
+    content?: string;
+    full_content?: string;
+    date?: string;
+};
+
+export type ParsedSupportingContentItem = {
     title: string;
     content: string;
+    date?: string;
+    updated?: string;
+    url?: string;
+    sourcefile?: string;
+    sourcepage?: string;
+    category?: string;
+    storageurl?: string;
+    id?: string;
 };
 
-export function parseSupportingContentItem(item: string): ParsedSupportingContentItem {
-    // Assumes the item starts with the file name followed by : and the content.
-    // Example: "sdp_corporate.pdf: this is the content that follows".
-    const parts = item.split(": ");
-    const title = parts[0];
-    const content = DOMPurify.sanitize(parts.slice(1).join(": "));
+export function parseSupportingContentItem(item: any): ParsedSupportingContentItem {
+    // Handle null/undefined cases
+    if (!item) {
+        return {
+            title: "Unknown source",
+            content: ""
+        };
+    }
+
+    console.log("Parsing item:", item);
+
+    // For structured object format (which should be the primary format)
+    if (typeof item === "object" && item !== null) {
+        const sourcepage = item.sourcepage || "";
+        const sourcefile = item.sourcefile || "";
+        const category = item.category || "";
+        const updated = item.updated || item.last_updated || item.date_updated || "";
+        const storageurl = item.storageurl || item.storageUrl || item.storage_url || item.url || "";
+        // Prefer full content if present
+        const content = item.full_content || item.content || "";
+
+        // Create title from available fields
+        const title = sourcefile || sourcepage || category || "Document Source";
+
+        console.log("Parsed from object:", {
+            sourcepage,
+            sourcefile,
+            category,
+            title,
+            hasContent: !!content,
+            updated,
+            storageurl
+        });
+
+        return {
+            title: title,
+            content: DOMPurify.sanitize(content),
+            date: item.date,
+            updated: updated,
+            url: storageurl,
+            sourcefile: sourcefile,
+            sourcepage: sourcepage,
+            category: category,
+            storageurl: storageurl,
+            id: item.id
+        };
+    }
+
+    // Fallback for string format (legacy support)
+    if (typeof item === "string") {
+        let sourcepage = "";
+        let sourcefile = "";
+        let category = "";
+        let content = item;
+
+        // Extract from citation pattern: [citation]: content
+        const citationMatch = item.match(/^\[([^\]]+)\]:\s*([\s\S]*)$/);
+        if (citationMatch) {
+            content = citationMatch[2];
+
+            // Parse citation parts: [subsection, category, document]
+            const citationParts = citationMatch[1].split(",").map(p => p.trim());
+
+            if (citationParts.length >= 2) {
+                sourcepage = citationParts[0]; // First part is sourcepage
+                sourcefile = citationParts[citationParts.length - 1]; // Last part is sourcefile
+
+                if (citationParts.length >= 3) {
+                    category = citationParts[1]; // Middle part is category
+                }
+            }
+        }
+
+        const title = sourcefile || sourcepage || "Document Source";
+
+        console.log("Parsed from string:", {
+            sourcepage,
+            sourcefile,
+            category,
+            title,
+            hasContent: !!content
+        });
+
+        return {
+            title: title,
+            content: DOMPurify.sanitize(content),
+            sourcefile: sourcefile,
+            sourcepage: sourcepage,
+            category: category
+        };
+    }
+
+    // Ultimate fallback
+    return {
+        title: "Unknown source",
+        content: DOMPurify.sanitize(String(item))
+    };
+}
+
+export function extractSubsectionContent(fullContent: string, targetSubsection: string): { content: string; startIndex: number; endIndex: number } | null {
+    if (!fullContent || !targetSubsection) {
+        return null;
+    }
+
+    console.log("Extracting subsection:", targetSubsection, "from content length:", fullContent.length);
+
+    // Enhanced patterns to find the target subsection with more flexibility
+    const escapedSubsection = escapeRegExp(targetSubsection);
+    const patterns = [
+        // Exact match at start of line or after newline
+        new RegExp(`(^|\\n)\\s*${escapedSubsection}\\s*(\\n|\\s|$)`, "i"),
+        // Match with optional formatting and punctuation
+        new RegExp(`(^|\\n)\\s*${escapedSubsection}\\s*[.:]?\\s*(\\n|\\s|$)`, "i"),
+        // Match as part of a larger heading (e.g., "B.7 London Circuit Commercial Court Triaging")
+        new RegExp(`(^|\\n)\\s*${escapedSubsection}\\s+[A-Za-z]`, "i"),
+        // Match with section markers and optional brackets
+        new RegExp(`(^|\\n)\\s*\\(?${escapedSubsection}\\)?\\s*[-\\s]`, "i"),
+        // Match anywhere in the content as a fallback
+        new RegExp(`\\b${escapedSubsection}\\b`, "i")
+    ];
+
+    let targetMatch = null;
+    let patternUsed = -1;
+
+    for (let i = 0; i < patterns.length; i++) {
+        targetMatch = fullContent.match(patterns[i]);
+        if (targetMatch) {
+            patternUsed = i;
+            console.log(`Found subsection using pattern ${i}:`, targetMatch[0]);
+            break;
+        }
+    }
+
+    if (!targetMatch) {
+        console.log("Target subsection not found with any pattern");
+        return null;
+    }
+
+    // Anchor the start at the actual subsection token, not at the preceding newline/whitespace
+    const tokenRegex = new RegExp(`\\b${escapedSubsection}\\b`, "i");
+    const localStartOffset = targetMatch[0].search(tokenRegex);
+    const startIndex = (targetMatch.index ?? 0) + (localStartOffset >= 0 ? localStartOffset : targetMatch[1] ? targetMatch[1].length : 0);
+
+    // Enhanced patterns for finding the next subsection/title/divider boundary
+    const nextSubsectionPatterns = [
+        // Standard patterns for various numbering systems
+        /\n\s*([A-Z]?\d+\.\d+(?:\.\d+)?)\s/i,
+        /\n\s*([A-Z]\d*\.?\d+\.?\d*)\s/i,
+        /\n\s*([A-Z]\.\d+)\s/i,
+        /\n\s*(Rule\s+\d+\.\d+|Para\s+\d+\.\d+)\s/i,
+        // Section dividers
+        /\n\s*---/i,
+        // Chapter/Part markers
+        /\n\s*(Chapter\s+\d+|Part\s+[A-Z\d]+|Section\s+[A-Z\d]+)\s/i,
+        // Double newlines as section breaks (likely titles)
+        /\n\s*\n\s*[A-Z]/
+    ];
+
+    // Search for the earliest boundary across all patterns (not the first that happens to match)
+    const remainingContent = fullContent.substring(startIndex + targetSubsection.length);
+    let bestBoundaryIndex = Infinity;
+    let bestMatch: RegExpMatchArray | null = null;
+    let boundaryPatternUsed = -1;
+
+    for (let i = 0; i < nextSubsectionPatterns.length; i++) {
+        const m = remainingContent.match(nextSubsectionPatterns[i]);
+        if (m && m.index !== undefined && m.index < bestBoundaryIndex) {
+            bestBoundaryIndex = m.index;
+            bestMatch = m;
+            boundaryPatternUsed = i;
+        }
+    }
+
+    let endIndex: number;
+    if (bestMatch) {
+        // End at the earliest boundary (e.g., just before '---' or the next title/subsection)
+        endIndex = startIndex + targetSubsection.length + bestBoundaryIndex;
+        console.log(`Found next subsection boundary at index ${endIndex}, pattern: ${boundaryPatternUsed}`);
+    } else {
+        endIndex = fullContent.length;
+        console.log("No next subsection found, taking to end of content");
+    }
+
+    const extractedContent = fullContent.substring(startIndex, endIndex).trim();
+
+    console.log("Found subsection:", {
+        subsection: targetSubsection,
+        startIndex,
+        endIndex,
+        contentLength: extractedContent.length,
+        contentPreview: extractedContent.substring(0, 200) + "...",
+        patternUsed: boundaryPatternUsed
+    });
 
     return {
-        title,
-        content
+        content: extractedContent,
+        startIndex,
+        endIndex
     };
 }
+
+function escapeRegExp(string: string): string {
+    return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
+}
+
+export function parseSubsectionFromCitation(citation: string): string | null {
+    if (!citation) return null;
+
+    // Parse three-part citation format: [subsection, source, document]
+    const citationParts = citation.split(",").map(p => p.trim());
+
+    if (citationParts.length >= 3) {
+        const subsection = citationParts[0].trim();
+
+        // Enhanced validation for different subsection formats
+        const subsectionPatterns = [
+            /^(\d+\.\d+(\.\d+)?)$/i, // 1.1, 1.2.3
+            /^([A-Z]\d*\.?\d+\.?\d*)$/i, // A1.1, B2, D5.6
+            /^([A-Z]\.\d+)$/i, // D.5, E.3
+            /^(Rule\s+\d+\.\d+)$/i, // Rule 1.2
+            /^(Para\s+\d+\.\d+)$/i, // Para 1.2
+            /^([A-Z]\d+)$/i // D5, E3
+        ];
+
+        for (const pattern of subsectionPatterns) {
+            if (pattern.test(subsection)) {
+                return subsection;
+            }
+        }
+
+        console.log("Subsection format not recognized:", subsection);
+    }
+
+    return null;
+}
+
+export function parseSupportingContent(supportingContent: SupportingContent[]): ParsedSupportingContent[] {
+    const parsedContent: ParsedSupportingContent[] = [];
+
+    for (const item of supportingContent) {
+        console.log("Parsing item:", item);
+
+        // Do NOT group/concatenate subsections. Return each item as a standalone entry
+        const content = item.full_content || item.content || "";
+        parsedContent.push({
+            title: item.sourcefile || "Unknown Source",
+            sourcefile: item.sourcefile,
+            sourcepage: item.sourcepage,
+            storageurl: item.storageurl || item.storageUrl || item.url,
+            category: item.category,
+            updated: item.updated,
+            hasContent: !!content,
+            fullContent: content,
+            id: item.id || item.original_doc_id
+        });
+    }
+
+    console.log("Parsed supporting content (no grouping):", parsedContent);
+    return parsedContent;
+}
+
+export interface ParsedSupportingContent {
+    title: string;
+    sourcefile?: string;
+    sourcepage?: string;
+    storageurl?: string;
+    category?: string;
+    updated?: string;
+    hasContent: boolean;
+    fullContent?: string;
+    id?: string;
+}
diff --git a/app/frontend/src/components/SupportingContent/index.ts b/app/frontend/src/components/SupportingContent/index.ts
index db55f83..4cc5188 100644
--- a/app/frontend/src/components/SupportingContent/index.ts
+++ b/app/frontend/src/components/SupportingContent/index.ts
@@ -1 +1,2 @@
 export * from "./SupportingContent";
+
diff --git a/app/frontend/src/components/SupportingContent/index.tsx b/app/frontend/src/components/SupportingContent/index.tsx
new file mode 100644
index 0000000..db55f83
--- /dev/null
+++ b/app/frontend/src/components/SupportingContent/index.tsx
@@ -0,0 +1 @@
+export * from "./SupportingContent";
diff --git a/app/frontend/src/locales/en/translation.json b/app/frontend/src/locales/en/translation.json
index 8445407..8dca812 100644
--- a/app/frontend/src/locales/en/translation.json
+++ b/app/frontend/src/locales/en/translation.json
@@ -1,6 +1,6 @@
 {
-    "pageTitle": "Azure OpenAI + AI Search",
-    "headerTitle": "Azure OpenAI + AI Search",
+    "pageTitle": "ADALEX AI",
+    "headerTitle": "ADALEX AI",
     "chat": "Chat",
     "qa": "Ask a question",
     "login": "Login",
@@ -34,20 +34,20 @@
     },
     "developerSettings": "Developer settings",
 
-    "chatEmptyStateTitle": "Chat with your data",
-    "chatEmptyStateSubtitle": "Ask anything or try an example",
+    "chatEmptyStateTitle": "CPR Chatbot",
+    "chatEmptyStateSubtitle": "Research tool for Civil Procedure Rules, Practice Directions, and Court Guides",
     "defaultExamples": {
-        "1": "What is included in my Northwind Health Plus plan that is not in standard?",
-        "2": "What happens in a performance review?",
-        "3": "What does a Product Manager do?",
-        "placeholder": "Type a new question (e.g. does my plan cover annual eye exams?)"
+        "1": "What documents are required in a CMC in the Circuit Commercial Court?",
+        "2": "What are the deadlines for filing in the Circuit Commercial Court?",
+        "3": "In one sentence what is the overriding objective?",
+        "placeholder": "Type a new question (e.g. what is the overriding objective?)"
     },
-    "askTitle": "Ask your data",
+    "askTitle": "CPR Chatbot",
     "gpt4vExamples": {
-        "1": "Compare the impact of interest rates and GDP in financial markets.",
-        "2": "What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance",
-        "3": "Can you identify any correlation between oil prices and stock market trends?",
-        "placeholder": "Example: Does my plan cover annual eye exams?"
+        "1": "What documents are required in a CMC in the Circuit Commercial Court?",
+        "2": "What are the deadlines for filing in the Circuit Commercial Court?",
+        "3": "What are the rules of service?",
+        "placeholder": "Type a new question (e.g. what is the overriding objective?)"
     },
     "generatingAnswer": "Generating answer",
     "citationWithColon": "Citation:",
diff --git a/app/frontend/src/pages/ask/Ask.tsx b/app/frontend/src/pages/ask/Ask.tsx
index 2f3a058..9dfd7cd 100644
--- a/app/frontend/src/pages/ask/Ask.tsx
+++ b/app/frontend/src/pages/ask/Ask.tsx
@@ -76,7 +76,9 @@ export function Component(): JSX.Element {
     };
 
     const [activeCitation, setActiveCitation] = useState<string>();
+    const [activeCitationContent, setActiveCitationContent] = useState<string>(); // New state
     const [activeAnalysisPanelTab, setActiveAnalysisPanelTab] = useState<AnalysisPanelTabs | undefined>(undefined);
+    const [enableCitationTab, setEnableCitationTab] = useState(false);
 
     const client = useLogin ? useMsal().instance : undefined;
     const { loggedIn } = useContext(LoginContext);
@@ -166,6 +168,7 @@ export function Component(): JSX.Element {
             setAnswer(result);
             setSpeechUrls([null]);
         } catch (e) {
+            console.error("API request failed:", e);
             setError(e);
         } finally {
             setIsLoading(false);
@@ -250,19 +253,26 @@ export function Component(): JSX.Element {
         setQuestion(example);
     };
 
-    const onShowCitation = (citation: string) => {
-        if (activeCitation === citation && activeAnalysisPanelTab === AnalysisPanelTabs.CitationTab) {
-            setActiveAnalysisPanelTab(undefined);
-        } else {
-            setActiveCitation(citation);
-            setActiveAnalysisPanelTab(AnalysisPanelTabs.CitationTab);
-        }
+    const onShowCitation = (citation: string, citationContent?: string) => {
+        console.log("onShowCitation called with:", { citation, citationContent: citationContent ? "content provided" : "no content" });
+
+        // Always show supporting content tab when citation is clicked
+        setActiveCitation(citation);
+
+        // Store the full citation content, not just a preview
+        setActiveCitationContent(citationContent || "");
+        setActiveAnalysisPanelTab(AnalysisPanelTabs.SupportingContentTab);
+        setEnableCitationTab(false); // Disable citation tab by default
     };
 
     const onToggleTab = (tab: AnalysisPanelTabs) => {
         if (activeAnalysisPanelTab === tab) {
             setActiveAnalysisPanelTab(undefined);
         } else {
+            // Enable citation tab when explicitly requested
+            if (tab === AnalysisPanelTabs.CitationTab) {
+                setEnableCitationTab(true);
+            }
             setActiveAnalysisPanelTab(tab);
         }
     };
@@ -314,7 +324,7 @@ export function Component(): JSX.Element {
                             index={0}
                             speechConfig={speechConfig}
                             isStreaming={false}
-                            onCitationClicked={x => onShowCitation(x)}
+                            onCitationClicked={onShowCitation}
                             onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab)}
                             onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab)}
                             showSpeechOutputAzure={showSpeechOutputAzure}
@@ -335,6 +345,8 @@ export function Component(): JSX.Element {
                         citationHeight="600px"
                         answer={answer}
                         activeTab={activeAnalysisPanelTab}
+                        activeCitationContent={activeCitationContent}
+                        enableCitationTab={enableCitationTab}
                     />
                 )}
             </div>
diff --git a/app/frontend/src/pages/chat/Chat.tsx b/app/frontend/src/pages/chat/Chat.tsx
index 579ad05..29d6918 100644
--- a/app/frontend/src/pages/chat/Chat.tsx
+++ b/app/frontend/src/pages/chat/Chat.tsx
@@ -72,8 +72,12 @@ const Chat = () => {
     const [error, setError] = useState<unknown>();
 
     const [activeCitation, setActiveCitation] = useState<string>();
+    const [activeCitationContent, setActiveCitationContent] = useState<string>();
     const [activeAnalysisPanelTab, setActiveAnalysisPanelTab] = useState<AnalysisPanelTabs | undefined>(undefined);
 
+    // Add this new state for the citation label
+    const [activeCitationLabel, setActiveCitationLabel] = useState<string>();
+
     const [selectedAnswer, setSelectedAnswer] = useState<number>(0);
     const [answers, setAnswers] = useState<[user: string, response: ChatAppResponse][]>([]);
     const [streamedAnswers, setStreamedAnswers] = useState<[user: string, response: ChatAppResponse][]>([]);
@@ -372,14 +376,22 @@ const Chat = () => {
         makeApiRequest(example);
     };
 
-    const onShowCitation = (citation: string, index: number) => {
-        if (activeCitation === citation && activeAnalysisPanelTab === AnalysisPanelTabs.CitationTab && selectedAnswer === index) {
-            setActiveAnalysisPanelTab(undefined);
-        } else {
-            setActiveCitation(citation);
-            setActiveAnalysisPanelTab(AnalysisPanelTabs.CitationTab);
-        }
+    const [enableCitationTab, setEnableCitationTab] = useState(false);
 
+    const onShowCitation = (citation: string, index: number, citationContent?: string) => {
+        // Prevent rapid clicking by adding a small debounce
+        if (isLoading || isStreaming) return;
+
+        console.log("onShowCitation called with:", { citation, citationContent: citationContent ? "content provided" : "no content" });
+
+        // Use the citation directly as received
+        setActiveCitation(citation);
+
+        // If citationContent is provided, use it; otherwise it will be found in SupportingContent
+        setActiveCitationContent(citationContent || "");
+        setActiveCitationLabel(citation); // Use the citation directly
+        setActiveAnalysisPanelTab(AnalysisPanelTabs.SupportingContentTab);
+        setEnableCitationTab(false);
         setSelectedAnswer(index);
     };
 
@@ -387,6 +399,10 @@ const Chat = () => {
         if (activeAnalysisPanelTab === tab && selectedAnswer === index) {
             setActiveAnalysisPanelTab(undefined);
         } else {
+            // Enable citation tab when explicitly requested
+            if (tab === AnalysisPanelTabs.CitationTab) {
+                setEnableCitationTab(true);
+            }
             setActiveAnalysisPanelTab(tab);
         }
 
@@ -439,7 +455,7 @@ const Chat = () => {
                                                 index={index}
                                                 speechConfig={speechConfig}
                                                 isSelected={false}
-                                                onCitationClicked={c => onShowCitation(c, index)}
+                                                onCitationClicked={(c, citationContent) => onShowCitation(c, index, citationContent)}
                                                 onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab, index)}
                                                 onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab, index)}
                                                 onFollowupQuestionClicked={q => makeApiRequest(q)}
@@ -462,7 +478,7 @@ const Chat = () => {
                                                 index={index}
                                                 speechConfig={speechConfig}
                                                 isSelected={selectedAnswer === index && activeAnalysisPanelTab !== undefined}
-                                                onCitationClicked={c => onShowCitation(c, index)}
+                                                onCitationClicked={(c, citationContent) => onShowCitation(c, index, citationContent)}
                                                 onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab, index)}
                                                 onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab, index)}
                                                 onFollowupQuestionClicked={q => makeApiRequest(q)}
@@ -509,9 +525,12 @@ const Chat = () => {
                         className={styles.chatAnalysisPanel}
                         activeCitation={activeCitation}
                         onActiveTabChanged={x => onToggleTab(x, selectedAnswer)}
-                        citationHeight="810px"
+                        citationHeight="600px"
                         answer={answers[selectedAnswer][1]}
                         activeTab={activeAnalysisPanelTab}
+                        activeCitationLabel={activeCitationLabel}
+                        activeCitationContent={activeCitationContent}
+                        enableCitationTab={enableCitationTab}
                     />
                 )}
 
diff --git a/docs/appservice.md b/docs/appservice.md
index 4d1701e..ce4d15d 100644
--- a/docs/appservice.md
+++ b/docs/appservice.md
@@ -1,5 +1,13 @@
 # RAG chat: Debugging the app on App Service
 
+**If you see a 500 error after deployment:**
+- Wait 10 minutes after deployment.
+- Check deployment logs in "Deployment Center" > "Logs".
+- Check application logs in "Advanced Tools" (Kudu) > Download Docker logs.
+- Check Azure Monitor/Application Insights for exceptions.
+- Redeploy with `azd deploy` if needed.
+- See details below for each step.
+
 When you run `azd up` or `azd deploy`, it deploys your application to App Service,
 and displays the deployed endpoint in the console.
 
@@ -112,7 +120,7 @@ Running pip install...
 [19:21:36+0000]   Downloading azure_common-1.1.28-py2.py3-none-any.whl (14 kB)
 [19:21:36+0000] Collecting azure-core==1.29.7 (from -r requirements.txt (line 27))
 [19:21:36+0000]   Obtaining dependency information for azure-core==1.29.7 from https://files.pythonhosted.org/packages/ff/29/dbc7182bc207530c7b5858d59f429158465f878845d64a038afc1aa61e35/azure_core-1.29.7-py3-none-any.whl.metadata
-[19:21:36+0000]   Downloading azure_core-1.29.7-py3-none-any.whl.metadata (36 kB)
+[19:21:36+0000]   Downloading azure_core-1.29.7-py-none-any.whl.metadata (36 kB)
 [19:21:36+0000] Collecting azure-core-tracing-opentelemetry==1.0.0b11 (from -r requirements.txt (line 37))
 [19:21:36+0000]   Obtaining dependency information for azure-core-tracing-opentelemetry==1.0.0b11 from https://files.pythonhosted.org/packages/e6/6e/3ef6dfba8e0faa4692caa6d103c721ccba6ac37a24744848a3a10bb3fe89/azure_core_tracing_opentelemetry-1.0.0b11-py3-none-any.whl.metadata
 [19:21:36+0000]   Downloading azure_core_tracing_opentelemetry-1.0.0b11-py3-none-any.whl.metadata (8.5 kB)
diff --git a/docs/customization.md b/docs/customization.md
index d8a293c..03cd7f3 100644
--- a/docs/customization.md
+++ b/docs/customization.md
@@ -42,7 +42,9 @@ The chat tab uses the approach programmed in [chatreadretrieveread.py](https://g
 2. It queries Azure AI Search for search results for that query (optionally using the vector embeddings for that query).
 3. It then calls the OpenAI ChatCompletion API to answer the question based on the sources, using the prompt from [chat_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/chat_answer_question.prompty). That call includes the past message history as well (or as many messages fit inside the model's token limit).
 
-The prompts are currently tailored to the sample data since they start with "Assistant helps the company employees with their healthcare plan questions, and questions about the employee handbook." Modify the [chat_query_rewrite.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/chat_query_rewrite.prompty) and [chat_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/chat_answer_question.prompty) prompts to match your data.
+The prompts are currently tailored to the sample data since they start with "Assistant helps lawyers and legal professionals in England and Wales find relevant information from Civil Procedure Rules (CPR), Practice Directions, and Court Guides." Modify the [chat_query_rewrite.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/chat_query_rewrite.prompty) and [chat_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/chat_answer_question.prompty) prompts to match your data.
+
+**Note**: The prompts are configured with strict citation requirements to ensure all responses include proper citations and use exact wording from source documents. This helps maintain accuracy and allows responses to be validated against search results.
 
 ##### Chat with vision
 
@@ -61,7 +63,7 @@ The ask tab uses the approach programmed in [retrievethenread.py](https://github
 1. It queries Azure AI Search for search results for the user question (optionally using the vector embeddings for that question).
 2. It then combines the search results and user question, and calls the OpenAI ChatCompletion API to answer the question based on the sources, using the prompt from [ask_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/ask_answer_question.prompty).
 
-The prompt for step 2 is currently tailored to the sample data since it starts with "You are an intelligent assistant helping Contoso Inc employees with their healthcare plan questions and employee handbook questions." Modify [ask_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/ask_answer_question.prompty) to match your data.
+The prompt for step 2 is currently tailored to the sample data since it starts with "You are an expert legal assistant helping lawyers and legal professionals in England and Wales with questions about the Civil Procedure Rules (CPR), Practice Directions, and Court Guides.". Modify [ask_answer_question.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/ask_answer_question.prompty) to match your data.
 
 #### Ask with vision
 
@@ -70,7 +72,7 @@ If you followed the instructions in [the GPT vision guide](gpt4v.md) to enable t
 1. For this step, it also calculates a vector embedding for the user question using [the Computer Vision vectorize text API](https://learn.microsoft.com/azure/ai-services/computer-vision/how-to/image-retrieval#call-the-vectorize-text-api), and passes that to the Azure AI Search to compare against the `imageEmbeddings` fields in the indexed documents. For each matching document, it downloads the image blob and converts it to a base 64 encoding.
 2. When it combines the search results and user question, it includes the base 64 encoded images, and sends along both the text and images to the GPT4 Vision model (similar to this [documentation example](https://platform.openai.com/docs/guides/vision/quick-start)). The model generates a response that includes citations to the images, and the UI renders the base64 encoded images when a citation is clicked.
 
-The prompt for step 2 is currently tailored to the sample data since it starts with "You are an intelligent assistant helping analyze the Annual Financial Report of Contoso Ltd". Modify the [ask_answer_question_vision.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/ask_answer_question_vision.prompty) prompt to match your data.
+The prompt for step 2 is currently tailored to the sample data since it starts with "You are an expert legal assistant helping lawyers and legal professionals in England and Wales with questions about the Civil Procedure Rules (CPR), Practice Directions, and Court Guides". Modify the [ask_answer_question_vision.prompty](https://github.com/Azure-Samples/azure-search-openai-demo/blob/main/app/backend/approaches/prompts/ask_answer_question_vision.prompty) prompt to match your data.
 
 #### Making settings overrides permanent
 
diff --git a/docs/deploy_troubleshooting.md b/docs/deploy_troubleshooting.md
index 782f48f..c3b4a2b 100644
--- a/docs/deploy_troubleshooting.md
+++ b/docs/deploy_troubleshooting.md
@@ -11,3 +11,22 @@ If you are experiencing an error when deploying the RAG chat solution using the
 1. You see `CERTIFICATE_VERIFY_FAILED` when the `prepdocs.py` script runs. That's typically due to incorrect SSL certificates setup on your machine. Try the suggestions in this [StackOverflow answer](https://stackoverflow.com/a/43855394).
 
 1. After running `azd up` and visiting the website, you see a '404 Not Found' in the browser. Wait 10 minutes and try again, as it might be still starting up. Then try running `azd deploy` and wait again. If you still encounter errors with the deployed app and are deploying to App Service, consult the [guide on debugging App Service deployments](/docs/appservice.md). Please file an issue if the logs don't help you resolve the error.
+
+## Troubleshooting HTTP 500 errors after deployment
+
+If you see a **500 Internal Server Error** after deploying with `azd deploy`:
+
+1. **Wait 10 minutes** after deployment, as the app may take time to start.
+2. **Check deployment logs** in the Azure Portal under your App Service's "Deployment Center" > "Logs". Look for failed deployments or errors during the build.
+3. **Check application logs** using "Advanced Tools" (Kudu) in the App Service. Download the latest Docker logs and look for Python errors or missing dependencies.
+4. **Check Azure Monitor/Application Insights** for exceptions and server errors.
+5. **Redeploy** with `azd deploy` if you suspect a transient issue.
+6. For detailed steps, see [Debugging the app on App Service](appservice.md).
+
+Common causes include:
+- Missing or incorrect Python dependencies.
+- Syntax or runtime errors in your code.
+- Incorrect startup command or misconfiguration.
+- Environment variables not set correctly.
+
+Review the logs for specific error messages to help diagnose the problem.
diff --git a/docs/http_protocol.md b/docs/http_protocol.md
index 9739543..a24c82c 100644
--- a/docs/http_protocol.md
+++ b/docs/http_protocol.md
@@ -311,25 +311,12 @@ Here's an example of the first three JSON objects in a streaming response:
                     "{'role': 'assistant', 'content': 'There is no specific information provided about what is included in the Northwind Health Plus plan that is not in the standard plan. It is recommended to read the plan details carefully and ask questions to understand the specific benefits of the Northwind Health Plus plan [Northwind_Standard_Benefits_Details.pdf#page=91].'}",
                     "{'role': 'user', 'content': \"What is included in my Northwind Health Plus plan that is not in standard?\\n\\nSources:\\nBenefit_Options.pdf#page=3:  The plans also cover preventive care services such as mammograms, colonoscopies, and  other cancer screenings...(truncated)\\nBenefit_Options.pdf#page=3:   Both plans offer coverage for medical services. Northwind Health Plus offers coverage for hospital stays,  doctor visits,...(truncated)\\nBenefit_Options.pdf#page=3:  With Northwind Health Plus, you can choose  from a variety of in -network providers, including primary care physicians,...(truncated)\"}"
                 ],
-                "props": null
+                "props": null,
+                "title": "Prompt"
             }
         ]
     },
-    "session_state": null,
-}{
-    "delta": {
-        "content": null,
-        "function_call": null,
-        "role": "assistant",
-        "tool_calls": null
-    }
-}{
-    "delta": {
-        "content": "The",
-        "function_call": null,
-        "role": null,
-        "tool_calls": null
-    }
+    "session_state": null
 }
 ```
 
@@ -347,12 +334,12 @@ Here's an example of an error chunk:
 
 ### Answer formatting
 
-To support the display of citations, the answer from the LLM should contain source information in square brackets, such as `[info1.txt]`.
+To support the display of citations, the answer from the LLM should contain source information in square brackets using a three-part format: [subsection, source (page), document].
 
 Here's a full example of an answer with citation:
 
 ```text
-There is no specific information provided about what is included in the Northwind Health Plus plan that is not in the standard plan. It is recommended to read the plan details carefully and ask questions to understand the specific benefits of the Northwind Health Plus plan [Northwind_Standard_Benefits_Details.pdf#page=91].
+The court will make a costs capping order only in exceptional circumstances [1.1, Costs Capping (p. 1), Practice Direction 3E]. An application for a costs capping order must be made as soon as possible, preferably before or at the first case management hearing [1.2, Costs Capping (p. 1), Practice Direction 3E].
 ```
 
 ### Response context properties
@@ -469,6 +456,19 @@ The response context object can contain the following properties:
             "props": null
         },
         {
+            "title": "Prompt",
+            "description": [
+                "{'role': 'system', 'content': 'Assistant helps the company employees with their healthcare plan questions, and questions about the employee handbook. Be brief in your answers.\\n        Answer ONLY with the facts listed in the list of sources below. If there isn't enough information below, say you don't know. Do not generate answers that don't use the sources below. If asking a clarifying question to the user would help, ask the question.\\n        For tabular information return it as an html table. Do not return markdown format. If the question is not in English, answer in the language used in the question.\\n        Each source has a name followed by colon and the actual information, always include the source name for each fact you use in the response. Use square brackets to reference the source, for example [info1.txt]. Don\\'t combine sources, list each source separately, for example [info1.txt][info2.pdf].\\n        Generate 3 very brief follow-up questions that the user would likely ask next.\\n    Enclose the follow-up questions in double angle brackets. Example:\\n    <<Are there exclusions for prescriptions?>>\\n    <<Which pharmacies can be ordered from?>>\\n    <<What is the limit for over-the-counter medication?>>\\n    Do no repeat questions that have already been asked.\\n    Make sure the last question ends with \">>\".\\n    \\n        \\n        '}",
+                "{'role': 'user', 'content': 'What is included in my Northwind Health Plus plan that is not in standard?'}",
+                "{'role': 'assistant', 'content': 'The Northwind Health Plus plan includes coverage for prescription drugs, but it is important to read the plan details to determine which prescription drugs are covered and what the associated costs are [Northwind_Standard_Benefits_Details.pdf#page=91]. Additionally, employees should select in-network providers to maximize coverage and avoid unexpected costs, submit claims as soon as possible after a service is rendered, and track claims and follow up with Northwind Health if a claim is not processed in a timely manner [Northwind_Standard_Benefits_Details.pdf#page=17].\\n\\n'}",
+                "{'role': 'user', 'content': 'What is included in my Northwind Health Plus plan that is not in standard?\\n\\nSources:\\nNorthwind_Health_Plus_Benefits_Details.pdf#page=100:    \u2022 Understand your coverage limits, and know what services are  covered and what services  are not covered...(truncated)\\nNorthwind_Standard_Benefits_Details.pdf#page=17:  Employees should keep track of their claims and follow up with  Northwind Health if a claim is not processed in a timely manner...(truncated)\\nNorthwind_Health_Plus_Benefits_Details.pdf#page=24:  It is important to talk to your doctor or  health care provider..(truncated)'}"
+            ],
+            "props": null
+        }
+    ]
+    ```
+
+    The app displays these thoughts in the "Thought process" tab, available by selecting the lightbulb icon on each answer. [See image](./images/thoughts.png)
             "title": "Prompt",
             "description": [
                 "{'role': 'system', 'content': 'Assistant helps the company employees with their healthcare plan questions, and questions about the employee handbook. Be brief in your answers.\\n        Answer ONLY with the facts listed in the list of sources below. If there isn\\'t enough information below, say you don\\'t know. Do not generate answers that don\\'t use the sources below. If asking a clarifying question to the user would help, ask the question.\\n        For tabular information return it as an html table. Do not return markdown format. If the question is not in English, answer in the language used in the question.\\n        Each source has a name followed by colon and the actual information, always include the source name for each fact you use in the response. Use square brackets to reference the source, for example [info1.txt]. Don\\'t combine sources, list each source separately, for example [info1.txt][info2.pdf].\\n        Generate 3 very brief follow-up questions that the user would likely ask next.\\n    Enclose the follow-up questions in double angle brackets. Example:\\n    <<Are there exclusions for prescriptions?>>\\n    <<Which pharmacies can be ordered from?>>\\n    <<What is the limit for over-the-counter medication?>>\\n    Do no repeat questions that have already been asked.\\n    Make sure the last question ends with \">>\".\\n    \\n        \\n        '}",
diff --git a/docs/token_usage_guide.md b/docs/token_usage_guide.md
new file mode 100644
index 0000000..219e152
--- /dev/null
+++ b/docs/token_usage_guide.md
@@ -0,0 +1,67 @@
+# Understanding Token Usage in RAG Chat
+
+## How Prompts Are Created
+
+The prompt generation process follows these steps:
+
+1. **Search Query Generation**: The system first uses GPT to convert the user's question into an optimized search query
+2. **Document Retrieval**: Azure AI Search retrieves relevant documents based on the query
+3. **Prompt Assembly**: The retrieved documents are formatted and combined with the chat history and user question
+
+## Token Usage Components
+
+### 1. Input Tokens
+- **Chat History**: Previous messages in the conversation
+- **System Prompt**: Instructions for the AI model
+- **Retrieved Documents**: Full content from search results
+- **User Question**: The current query
+
+### 2. Output Tokens
+- **Generated Answer**: The AI's response
+- **Citations**: References to source documents
+- **Follow-up Questions**: Optional suggested questions
+
+## Controlling Content Size
+
+### Retrieve Count
+The `retrieveCount` parameter (default: 10) controls how many documents are retrieved from the search index. Each document can contain:
+- Full section content
+- Metadata (sourcepage, sourcefile, category, etc.)
+- Timestamps and URLs
+
+### Token Limits by Model
+- **GPT-3.5-turbo**: 4,096 tokens
+- **GPT-3.5-turbo-16k**: 16,384 tokens
+- **GPT-4**: 8,192 tokens
+- **GPT-4-32k**: 32,768 tokens
+- **GPT-4-turbo**: 16,384 tokens
+- **GPT-4o/GPT-4o-mini**: 16,384 tokens
+
+### Dynamic Token Allocation
+The system now:
+1. Calculates the total size of retrieved content
+2. Estimates required tokens (â‰ˆ4 characters per token)
+3. Dynamically adjusts the response token limit
+4. Ensures sufficient tokens for comprehensive answers
+
+## Best Practices
+
+1. **Increase Retrieve Count**: Set to 10-20 for comprehensive coverage
+2. **Use Semantic Ranking**: Ensures most relevant content appears first
+3. **Monitor Token Usage**: Check the "Thought Process" tab to see token allocation
+4. **Adjust for Your Content**: 
+   - Short documents: Higher retrieve count (15-20)
+   - Long documents: Lower retrieve count (5-10)
+
+## Viewing Token Usage
+
+In the web interface:
+1. Click the lightbulb icon on any answer
+2. Select "Thought Process" tab
+3. Look for "Token Usage Information" section
+
+This shows:
+- Total content size in characters
+- Number of sources included
+- Estimated prompt tokens
+- Response token limit used
diff --git a/requirements-dev.txt b/requirements-dev.txt
index c035649..d28d4f9 100644
--- a/requirements-dev.txt
+++ b/requirements-dev.txt
@@ -12,3 +12,4 @@ pytest-snapshot
 pre-commit
 pip-tools
 mypy==1.14.1
+PyYAML>=6.0
diff --git a/scripts/auth_init.ps1 b/scripts/auth_init.ps1
old mode 100755
new mode 100644
diff --git a/scripts/auth_init.sh b/scripts/auth_init.sh
old mode 100755
new mode 100644
diff --git a/scripts/auth_update.py b/scripts/auth_update.py
old mode 100755
new mode 100644
diff --git a/scripts/auth_update.sh b/scripts/auth_update.sh
old mode 100755
new mode 100644
diff --git a/scripts/load-balance-aca-setup.sh b/scripts/load-balance-aca-setup.sh
old mode 100755
new mode 100644
diff --git a/scripts/load_python_env.sh b/scripts/load_python_env.sh
old mode 100755
new mode 100644
diff --git a/scripts/prepdocs.ps1 b/scripts/prepdocs.ps1
old mode 100755
new mode 100644
diff --git a/scripts/prepdocs.sh b/scripts/prepdocs.sh
old mode 100755
new mode 100644
diff --git a/scripts/roles.sh b/scripts/roles.sh
old mode 100755
new mode 100644
diff --git a/tests/snapshots/test_authenticationhelper/test_auth_setup_required_access_control_and_unauthenticated_access/result.json b/tests/snapshots/test_authenticationhelper/test_auth_setup_required_access_control_and_unauth/result.json
similarity index 100%
rename from tests/snapshots/test_authenticationhelper/test_auth_setup_required_access_control_and_unauthenticated_access/result.json
rename to tests/snapshots/test_authenticationhelper/test_auth_setup_required_access_control_and_unauth/result.json
diff --git a/tests/test-data/Financial Market Analysis Report 2023_page2_figure.png b/tests/test-data/Financial Market Analysis Report 2023_page2_fig.png
similarity index 100%
rename from tests/test-data/Financial Market Analysis Report 2023_page2_figure.png
rename to tests/test-data/Financial Market Analysis Report 2023_page2_fig.png
